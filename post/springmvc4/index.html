<!DOCTYPE html>
<html  dir="ltr" lang="en" data-theme=""><head>
    <title> Riley Shen | SpringMVC learning code 4 </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description"
        content="springMVC learning code">
    <meta name="google-site-verification" content="Nac1UrFTdr1E1F48JLe7XQhIbKn2_WtF4VnJI8KOtew" />
    

    
    
    
    <link rel="stylesheet" href="/css/main.min.a7c9793b97840076bef76d2743ee1c90b13bd21c18674076a0cccd5dd54c723b.css" integrity="sha256-p8l5O5eEAHa&#43;920nQ&#43;4ckLE70hwYZ0B2oMzNXdVMcjs="
        crossorigin="anonymous" type="text/css">
    
    
    <link rel="stylesheet" href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4=" crossorigin="anonymous" type="text/css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />

    
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">

    <link rel="canonical" href="/post/springmvc4/">

    <link rel="preconnect" href="https://fonts.gstatic.com">



    
    
    
    
    <script type="text/javascript" src="/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js"
        integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin="anonymous"></script>


    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rileyshen.github.io/images/site-feature-image.png"/>

<meta name="twitter:title" content="SpringMVC learning code 4"/>
<meta name="twitter:description" content="springMVC learning code"/>


    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,500;1,600;1,700&display=swap"
        rel="stylesheet">

</head><body><div class="sidebar animated fadeInDown ">
    <div class="logo-title">
        <div class="title">
            <img src="/images/profileS.jpg" alt="profile picture">
            <h3 title=""><a href="/">I&#39;m Riley Shen</a></h3>
            <div class="description">
                <p><br>Riley likes to push her limits <br>and always keep learning new things. <br>She shares her weekly learnings <br>because "if you can't explain it simply,<br>it means you didn't understand it well enough".<br></p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="mailto:ripple.shen31@gmail.com" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/rileyshen" rel="me" aria-label="GitHub">
                    <i class="fab fa-github fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy;  Riley Shen 2022 </div>
    </div>
</div>
<div class="main">
    <div class="page-top  animated fadeInDown ">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/post/"
                        
                   title="">Posts</a></li>
        
            
            <li><a 
                   href="/about/"
                        
                   title="">About Me</a></li>
        
            
            <li><a 
                   href="/contact/"
                        
                   title="">Contact</a></li>
        
        
        
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
<div class="post  animated fadeInDown ">
    <div class="post-content">
        
        <div class="post-title">
            <h2>SpringMVC learning code 4</h2>
            
            <div class="info">
                <em class="fas fa-calendar-day"></em>
                <span class="date">
                    Tue, Mar 16, 2021
                    </span>
                <em class="fas fa-stopwatch"></em>
                <span class="reading-time">3-minute read</span>
            </div>
            
        </div>

        <p>This is my learning note about SpringMVC with Code Examples .</p>
<!-- TOC -->
<ul>
<li><a href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD" >文件上传和下载</a>
<ul>
<li><a href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD" >、文件下载</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0" >、文件上传</a>
<ul>
<li><a href="#%E4%B8%8A%E4%BC%A0%E6%AD%A5%E9%AA%A4" >上传步骤</a></li>
<li><a href="#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96" >添加依赖</a></li>
<li><a href="#%E5%9C%A8-springmvc-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE" >在 SpringMVC 的配置文件中添加配置</a></li>
<li><a href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E6%96%B9%E6%B3%95" >控制器方法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%8B%A6%E6%88%AA%E5%99%A8" >拦截器</a>
<ul>
<li><a href="#%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE" >、拦截器的配置</a></li>
<li><a href="#%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E4%B8%89%E4%B8%AA%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95" >、拦截器的三个抽象方法</a></li>
<li><a href="#%E5%A4%9A%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F" >、多个拦截器的执行顺序</a>
<ul>
<li><a href="#%E8%8B%A5%E6%AF%8F%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84-prehandle%E9%83%BD%E8%BF%94%E5%9B%9E-true" >若每个拦截器的 preHandle都返回 true</a></li>
<li><a href="#prehandle%E4%BC%9A%E6%8C%89%E7%85%A7%E9%85%8D%E7%BD%AE%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C%E8%80%8C-posthandle-%E5%92%8C-aftercomplation%E4%BC%9A%E6%8C%89%E7%85%A7%E9%85%8D%E7%BD%AE%E7%9A%84%E5%8F%8D%E5%BA%8F%E6%89%A7%E8%A1%8C" >preHandle会按照配置的顺序执行，而 postHandle 和 afterComplation会按照配置的反序执行</a></li>
<li><a href="#%E8%8B%A5%E6%9F%90%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84-prehandle%E8%BF%94%E5%9B%9E%E4%BA%86-false" >若某个拦截器的 preHandle返回了 false</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8" >异常处理器</a>
<ul>
<li><a href="#%E5%9F%BA%E4%BA%8E%E9%85%8D%E7%BD%AE%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86" >、基于配置的异常处理</a></li>
<li><a href="#%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86" >、基于注解的异常处理</a></li>
</ul>
</li>
<li><a href="#%E6%B3%A8%E8%A7%A3%E9%85%8D%E7%BD%AE-springmvc" >注解配置 SpringMVC</a>
<ul>
<li><a href="#%E5%88%9B%E5%BB%BA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B1%BB%E4%BB%A3%E6%9B%BF-webxml" >、创建初始化类，代替 web.xml</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA-springconfig-%E9%85%8D%E7%BD%AE%E7%B1%BB%E4%BB%A3%E6%9B%BF-spring-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" >、创建 SpringConfig 配置类，代替 spring 的配置文件</a></li>
<li><a href="#%E5%88%9B%E5%BB%BA-webconfig-%E9%85%8D%E7%BD%AE%E7%B1%BB%E4%BB%A3%E6%9B%BF-springmvc-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1-%E6%89%AB%E6%8F%8F%E7%BB%84%E4%BB%B6-2%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8-3view-comtroller-4-default-servlet-handler-5mvc-%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8-6%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90%E5%99%A8-7%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86-8-%E6%8B%A6%E6%88%AA%E5%99%A8" >、创建 WebConfig 配置类，代替 SpringMVC 的配置文件 1. 扫描组件 2.视图解析器 3.view-comtroller 4. default-servlet-handler 5.mvc 注解驱动 6.文件上传解析器 7.异常处理 8. 拦截器</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="文件上传和下载">文件上传和下载</h2>
<p><a id="markdown-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD" name="%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD"></a></p>
<h3 id="文件下载">、文件下载</h3>
<p><a id="markdown-%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD" name="%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"></a></p>
<p>使用 ResponseEntity 实现下载文件的功能</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/testDown&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span> <span class="nf">testResponseEntity</span><span class="o">(</span><span class="n">HttpSession</span> <span class="n">session</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="c1">//获取ServletContext对象
</span><span class="c1"></span>    <span class="n">ServletContext</span> <span class="n">servletContext</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
    <span class="c1">//获取服务器中文件的真实路径
</span><span class="c1"></span>    <span class="n">String</span> <span class="n">realPath</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">&#34;/static/img/1.jpg&#34;</span><span class="o">);</span>
    <span class="c1">//创建输入流
</span><span class="c1"></span>    <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="n">realPath</span><span class="o">);</span>
    <span class="c1">//创建字节数组
</span><span class="c1"></span>    <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">is</span><span class="o">.</span><span class="na">available</span><span class="o">()];</span>
    <span class="c1">//将流读到字节数组中
</span><span class="c1"></span>    <span class="n">is</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>
    <span class="c1">//创建HttpHeaders对象设置响应头信息
</span><span class="c1"></span>    <span class="n">MultiValueMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="o">();</span>
    <span class="c1">//设置要下载方式以及下载文件的名字
</span><span class="c1"></span>    <span class="n">headers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;Content-Disposition&#34;</span><span class="o">,</span> <span class="s">&#34;attachment;filename=1.jpg&#34;</span><span class="o">);</span>
    <span class="c1">//设置响应状态码
</span><span class="c1"></span>    <span class="n">HttpStatus</span> <span class="n">statusCode</span> <span class="o">=</span> <span class="n">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">;</span>
    <span class="c1">//创建ResponseEntity对象
</span><span class="c1"></span>    <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span> <span class="n">responseEntity</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="n">bytes</span><span class="o">,</span> <span class="n">headers</span><span class="o">,</span> <span class="n">statusCode</span><span class="o">);</span>
    <span class="c1">//关闭输入流
</span><span class="c1"></span>    <span class="n">is</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">responseEntity</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><h3 id="文件上传">、文件上传</h3>
<p><a id="markdown-%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0" name="%E3%80%81%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"></a></p>
<p>文件上传要求 <strong>form</strong> 表单的请求方式必须为 <strong>post</strong>，并且添加属性 <strong>enctype=&ldquo;multipart/form-data&rdquo;</strong></p>
<p>SpringMVC 中将上传的文件封装到 MultipartFile 对象中，通过此对象可以获取文件相关信息</p>
<h4 id="上传步骤">上传步骤</h4>
<p><a id="markdown-%E4%B8%8A%E4%BC%A0%E6%AD%A5%E9%AA%A4" name="%E4%B8%8A%E4%BC%A0%E6%AD%A5%E9%AA%A4"></a></p>
<h4 id="添加依赖">添加依赖</h4>
<p><a id="markdown-%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96" name="%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>commons-fileupload<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>commons-fileupload<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.3.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div><h4 id="在-springmvc-的配置文件中添加配置">在 SpringMVC 的配置文件中添加配置</h4>
<p><a id="markdown-%E5%9C%A8-springmvc-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE" name="%E5%9C%A8-springmvc-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--必须通过文件解析器的解析才能将文件转换为MultipartFile对象--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;multipartResolver&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.web.multipart.commons.CommonsMultipartResolver&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!--如果没有id默认multipartResolver， 会变成http 500--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;org.springframework.web.multipart.commons.CommonsMultipartResolver&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</code></pre></div><h4 id="控制器方法">控制器方法</h4>
<p><a id="markdown-%E6%8E%A7%E5%88%B6%E5%99%A8%E6%96%B9%E6%B3%95" name="%E6%8E%A7%E5%88%B6%E5%99%A8%E6%96%B9%E6%B3%95"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/testUp&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">testUp</span><span class="o">(</span><span class="n">MultipartFile</span> <span class="n">photo</span><span class="o">,</span> <span class="n">HttpSession</span> <span class="n">session</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="c1">//获取上传的文件的文件名
</span><span class="c1"></span>    <span class="n">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="n">photo</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>
    <span class="c1">//处理文件重名问题
</span><span class="c1"></span>    <span class="n">String</span> <span class="n">hzName</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">fileName</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">&#34;.&#34;</span><span class="o">));</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="n">hzName</span><span class="o">;</span>
    <span class="c1">//获取服务器中photo目录的路径
</span><span class="c1"></span>    <span class="n">ServletContext</span> <span class="n">servletContext</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
    <span class="n">String</span> <span class="n">photoPath</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">&#34;photo&#34;</span><span class="o">);</span>
    <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">photoPath</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">()){</span>
        <span class="n">file</span><span class="o">.</span><span class="na">mkdir</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="n">String</span> <span class="n">finalPath</span> <span class="o">=</span> <span class="n">photoPath</span> <span class="o">+</span> <span class="n">File</span><span class="o">.</span><span class="na">separator</span> <span class="o">+</span> <span class="n">fileName</span><span class="o">;</span>
    <span class="c1">//实现上传功能
</span><span class="c1"></span>    <span class="n">photo</span><span class="o">.</span><span class="na">transferTo</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">finalPath</span><span class="o">));</span>
    <span class="k">return</span> <span class="s">&#34;success&#34;</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><h2 id="拦截器">拦截器</h2>
<p><a id="markdown-%E6%8B%A6%E6%88%AA%E5%99%A8" name="%E6%8B%A6%E6%88%AA%E5%99%A8"></a></p>
<h3 id="拦截器的配置">、拦截器的配置</h3>
<p><a id="markdown-%E3%80%81%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE" name="%E3%80%81%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE"></a></p>
<p>SpringMVC 中的拦截器用于拦截控制器方法的执行</p>
<p>SpringMVC 中的拦截器需要实现 HandlerInterceptor</p>
<p>SpringMVC 的拦截器必须在 SpringMVC 的配置文件中进行配置：</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.learn.mav.interceptors.FirstInterceptor&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
<span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">&#34;firstInterceptor&#34;</span><span class="nt">&gt;&lt;/ref&gt;</span>
<span class="c">&lt;!-- 以上两种配置方式都是对DispatcherServlet所处理的所有的请求进行拦截 --&gt;</span>
<span class="nt">&lt;mvc:interceptor&gt;</span>
    <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">&#34;/**&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;mvc:exclude-mapping</span> <span class="na">path=</span><span class="s">&#34;/testRequestEntity&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">&#34;firstInterceptor&#34;</span><span class="nt">&gt;&lt;/ref&gt;</span>
<span class="nt">&lt;/mvc:interceptor&gt;</span>
<span class="c">&lt;!-- 
</span><span class="c">	以上配置方式可以通过ref或bean标签设置拦截器，通过mvc:mapping设置需要拦截的请求，通过mvc:exclude-mapping设置需要排除的请求，即不需要拦截的请求
</span><span class="c">--&gt;</span>
</code></pre></div><h3 id="拦截器的三个抽象方法">、拦截器的三个抽象方法</h3>
<p><a id="markdown-%E3%80%81%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E4%B8%89%E4%B8%AA%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95" name="%E3%80%81%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E4%B8%89%E4%B8%AA%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95"></a></p>
<p>SpringMVC 中的拦截器有三个抽象方法：</p>
<p>preHandle：控制器方法执行之前执行 preHandle()，其 boolean 类型的返回值表示是否拦截或放行，返回 true 为放行，即调用控制器方法；返回 false 表示拦截，即不调用控制器方法</p>
<p>postHandle：控制器方法执行之后执行 postHandle()</p>
<p>afterComplation：处理完视图和模型数据，渲染视图完毕之后执行afterComplation()</p>
<h3 id="多个拦截器的执行顺序">、多个拦截器的执行顺序</h3>
<p><a id="markdown-%E3%80%81%E5%A4%9A%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F" name="%E3%80%81%E5%A4%9A%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"></a></p>
<h4 id="若每个拦截器的-prehandle都返回-true">若每个拦截器的 preHandle()都返回 true</h4>
<p><a id="markdown-%E8%8B%A5%E6%AF%8F%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84-prehandle%E9%83%BD%E8%BF%94%E5%9B%9E-true" name="%E8%8B%A5%E6%AF%8F%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84-prehandle%E9%83%BD%E8%BF%94%E5%9B%9E-true"></a></p>
<p>此时多个拦截器的执行顺序和拦截器在 SpringMVC 的配置文件的配置顺序有关：</p>
<h4 id="prehandle会按照配置的顺序执行而-posthandle-和-aftercomplation会按照配置的反序执行">preHandle()会按照配置的顺序执行，而 postHandle() 和 afterComplation()会按照配置的反序执行</h4>
<p><a id="markdown-prehandle%E4%BC%9A%E6%8C%89%E7%85%A7%E9%85%8D%E7%BD%AE%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C%EF%BC%8C%E8%80%8C-posthandle-%E5%92%8C-aftercomplation%E4%BC%9A%E6%8C%89%E7%85%A7%E9%85%8D%E7%BD%AE%E7%9A%84%E5%8F%8D%E5%BA%8F%E6%89%A7%E8%A1%8C" name="prehandle%E4%BC%9A%E6%8C%89%E7%85%A7%E9%85%8D%E7%BD%AE%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C%EF%BC%8C%E8%80%8C-posthandle-%E5%92%8C-aftercomplation%E4%BC%9A%E6%8C%89%E7%85%A7%E9%85%8D%E7%BD%AE%E7%9A%84%E5%8F%8D%E5%BA%8F%E6%89%A7%E8%A1%8C"></a></p>
<h4 id="若某个拦截器的-prehandle返回了-false">若某个拦截器的 preHandle()返回了 false</h4>
<p><a id="markdown-%E8%8B%A5%E6%9F%90%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84-prehandle%E8%BF%94%E5%9B%9E%E4%BA%86-false" name="%E8%8B%A5%E6%9F%90%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8%E7%9A%84-prehandle%E8%BF%94%E5%9B%9E%E4%BA%86-false"></a></p>
<p>preHandle()返回 false 和它之前的拦截器的 preHandle()都会执行，postHandle()都不执行，返回 false 的拦截器之前的拦截器的 afterComplation()会执行</p>
<h2 id="异常处理器">异常处理器</h2>
<p><a id="markdown-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8" name="%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8"></a></p>
<h3 id="基于配置的异常处理">、基于配置的异常处理</h3>
<p><a id="markdown-%E3%80%81%E5%9F%BA%E4%BA%8E%E9%85%8D%E7%BD%AE%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86" name="%E3%80%81%E5%9F%BA%E4%BA%8E%E9%85%8D%E7%BD%AE%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"></a></p>
<p>SpringMVC 提供了一个处理控制器方法执行过程中所出现的异常的接口：HandlerExceptionResolver</p>
<p>HandlerExceptionResolver 接口的实现类有：DefaultHandlerExceptionResolver 和 SimpleMappingExceptionResolver</p>
<p>SpringMVC 提供了自定义的异常处理器 SimpleMappingExceptionResolver，使用方式：</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;exceptionMappings&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;props&gt;</span>
        	<span class="c">&lt;!--
</span><span class="c">        		properties的键表示处理器方法执行过程中出现的异常
</span><span class="c">        		properties的值表示若出现指定异常时，设置一个新的视图名称，跳转到指定页面
</span><span class="c">        	--&gt;</span>
            <span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">&#34;java.lang.ArithmeticException&#34;</span><span class="nt">&gt;</span>error<span class="nt">&lt;/prop&gt;</span>
        <span class="nt">&lt;/props&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="c">&lt;!--
</span><span class="c">    	exceptionAttribute属性设置一个属性名，将出现的异常信息在请求域中进行共享
</span><span class="c">    --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;exceptionAttribute&#34;</span> <span class="na">value=</span><span class="s">&#34;ex&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div><p><strong>要新建一个 ex.html 的页面，error.html 页面 &ldquo;<p th:text="${ex.execInfo}"></p>&quot;</strong></p>
<p><strong>错误页面就显示错误信息</strong></p>
<h3 id="基于注解的异常处理">、基于注解的异常处理</h3>
<p><a id="markdown-%E3%80%81%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86" name="%E3%80%81%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//@ControllerAdvice将当前类标识为异常处理的组件
</span><span class="c1"></span><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExceptionController</span> <span class="o">{</span>

    <span class="c1">//@ExceptionHandler用于设置所标识方法处理的异常
</span><span class="c1"></span>    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="c1">//ex表示当前请求处理中出现的异常对象
</span><span class="c1"></span>    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleArithmeticException</span><span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;ex&#34;</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">&#34;error&#34;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div><h2 id="注解配置-springmvc">注解配置 SpringMVC</h2>
<p><a id="markdown-%E6%B3%A8%E8%A7%A3%E9%85%8D%E7%BD%AE-springmvc" name="%E6%B3%A8%E8%A7%A3%E9%85%8D%E7%BD%AE-springmvc"></a></p>
<p><strong>使用配置类和注解代替 web.xml 和 SpringMVC 配置文件的功能</strong></p>
<h3 id="创建初始化类代替-webxml">、创建初始化类，代替 web.xml</h3>
<p><a id="markdown-%E3%80%81%E5%88%9B%E5%BB%BA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B1%BB%EF%BC%8C%E4%BB%A3%E6%9B%BF-web.xml" name="%E3%80%81%E5%88%9B%E5%BB%BA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B1%BB%EF%BC%8C%E4%BB%A3%E6%9B%BF-web.xml"></a></p>
<p>在 Servlet3.0 环境中，容器会在类路径中查找实现 javax.servlet.ServletContainerInitializer
接口的类，如果找到的话就用它来配置 Servlet 容器 
Spring提供了这个接口的实现，名为SpringServletContainerInitializer，这个类反过来又会查找实现WebApplicationInitializer的类并将配置的任务交给它们来完成。Spring3.2引入了一个便利的WebApplicationInitializer基础实现，名为AbstractAnnotationConfigDispatcherServletInitializer，当我们的类扩展了AbstractAnnotationConfigDispatcherServletInitializer并将其部署到Servlet3.0容器的时候，容器会自动发现它，并用它来配置Servlet上下文。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebInit</span> <span class="kd">extends</span> <span class="n">AbstractAnnotationConfigDispatcherServletInitializer</span> <span class="o">{</span>

    <span class="cm">/**
</span><span class="cm">     * 指定spring的配置类
</span><span class="cm">     * @return
</span><span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">getRootConfigClasses</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Class</span><span class="o">[]{</span><span class="n">SpringConfig</span><span class="o">.</span><span class="na">class</span><span class="o">};</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * 指定SpringMVC的配置类
</span><span class="cm">     * @return
</span><span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">getServletConfigClasses</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Class</span><span class="o">[]{</span><span class="n">WebConfig</span><span class="o">.</span><span class="na">class</span><span class="o">};</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * 指定DispatcherServlet的映射规则，即url-pattern
</span><span class="cm">     * @return
</span><span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">getServletMappings</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="s">&#34;/&#34;</span><span class="o">};</span>
    <span class="o">}</span>

    <span class="cm">/**
</span><span class="cm">     * 添加过滤器
</span><span class="cm">     * @return
</span><span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Filter</span><span class="o">[]</span> <span class="nf">getServletFilters</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">CharacterEncodingFilter</span> <span class="n">encodingFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CharacterEncodingFilter</span><span class="o">();</span>
        <span class="n">encodingFilter</span><span class="o">.</span><span class="na">setEncoding</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>
        <span class="n">encodingFilter</span><span class="o">.</span><span class="na">setForceRequestEncoding</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">HiddenHttpMethodFilter</span> <span class="n">hiddenHttpMethodFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HiddenHttpMethodFilter</span><span class="o">();</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Filter</span><span class="o">[]{</span><span class="n">encodingFilter</span><span class="o">,</span> <span class="n">hiddenHttpMethodFilter</span><span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><h3 id="创建-springconfig-配置类代替-spring-的配置文件">、创建 SpringConfig 配置类，代替 spring 的配置文件</h3>
<p><a id="markdown-%E3%80%81%E5%88%9B%E5%BB%BA-springconfig-%E9%85%8D%E7%BD%AE%E7%B1%BB%EF%BC%8C%E4%BB%A3%E6%9B%BF-spring-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" name="%E3%80%81%E5%88%9B%E5%BB%BA-springconfig-%E9%85%8D%E7%BD%AE%E7%B1%BB%EF%BC%8C%E4%BB%A3%E6%9B%BF-spring-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringConfig</span> <span class="o">{</span>
	<span class="c1">//ssm整合之后，spring的配置信息写在此类中
</span><span class="c1"></span><span class="o">}</span>
</code></pre></div><h3 id="创建-webconfig-配置类代替-springmvc-的配置文件-1-扫描组件-2视图解析器-3view-comtroller-4-default-servlet-handler-5mvc-注解驱动-6文件上传解析器-7异常处理-8-拦截器">、创建 WebConfig 配置类，代替 SpringMVC 的配置文件 1. 扫描组件 2.视图解析器 3.view-comtroller 4. default-servlet-handler 5.mvc 注解驱动 6.文件上传解析器 7.异常处理 8. 拦截器</h3>
<p><a id="markdown-%E3%80%81%E5%88%9B%E5%BB%BA-webconfig-%E9%85%8D%E7%BD%AE%E7%B1%BB%EF%BC%8C%E4%BB%A3%E6%9B%BF-springmvc-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1.-%E6%89%AB%E6%8F%8F%E7%BB%84%E4%BB%B6-2.%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8-3.view-comtroller-4.-default-servlet-handler-5.mvc-%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8-6.%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90%E5%99%A8-7.%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86-8.-%E6%8B%A6%E6%88%AA%E5%99%A8" name="%E3%80%81%E5%88%9B%E5%BB%BA-webconfig-%E9%85%8D%E7%BD%AE%E7%B1%BB%EF%BC%8C%E4%BB%A3%E6%9B%BF-springmvc-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1.-%E6%89%AB%E6%8F%8F%E7%BB%84%E4%BB%B6-2.%E8%A7%86%E5%9B%BE%E8%A7%A3%E6%9E%90%E5%99%A8-3.view-comtroller-4.-default-servlet-handler-5.mvc-%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8-6.%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90%E5%99%A8-7.%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86-8.-%E6%8B%A6%E6%88%AA%E5%99%A8"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="c1">//1. 扫描组件
</span><span class="c1"></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="s">&#34;com.learn.mvc.controller&#34;</span><span class="o">)</span>
<span class="c1">//5.开启MVC注解驱动
</span><span class="c1"></span><span class="nd">@EnableWebMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebConfig</span> <span class="kd">implements</span> <span class="n">WebMvcConfigurer</span> <span class="o">{</span>

    <span class="c1">//使用默认的servlet处理静态资源
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureDefaultServletHandling</span><span class="o">(</span><span class="n">DefaultServletHandlerConfigurer</span> <span class="n">configurer</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">configurer</span><span class="o">.</span><span class="na">enable</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">//配置文件上传解析器
</span><span class="c1"></span>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">CommonsMultipartResolver</span> <span class="nf">multipartResolver</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">CommonsMultipartResolver</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">//配置拦截器
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addInterceptors</span><span class="o">(</span><span class="n">InterceptorRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FirstInterceptor</span> <span class="n">firstInterceptor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FirstInterceptor</span><span class="o">();</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">addInterceptor</span><span class="o">(</span><span class="n">firstInterceptor</span><span class="o">).</span><span class="na">addPathPatterns</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="c1">//配置视图控制
</span><span class="c1"></span>    
    <span class="cm">/*@Override
</span><span class="cm">    public void addViewControllers(ViewControllerRegistry registry) {
</span><span class="cm">        registry.addViewController(&#34;/&#34;).setViewName(&#34;index&#34;);
</span><span class="cm">    }*/</span>
    
    <span class="c1">//配置异常映射
</span><span class="c1"></span>    <span class="cm">/*@Override
</span><span class="cm">    public void configureHandlerExceptionResolvers(List&lt;HandlerExceptionResolver&gt; resolvers) {
</span><span class="cm">        SimpleMappingExceptionResolver exceptionResolver = new SimpleMappingExceptionResolver();
</span><span class="cm">        Properties prop = new Properties();
</span><span class="cm">        prop.setProperty(&#34;java.lang.ArithmeticException&#34;, &#34;error&#34;);
</span><span class="cm">        //设置异常映射
</span><span class="cm">        exceptionResolver.setExceptionMappings(prop);
</span><span class="cm">        //设置共享异常信息的键
</span><span class="cm">        exceptionResolver.setExceptionAttribute(&#34;ex&#34;);
</span><span class="cm">        resolvers.add(exceptionResolver);
</span><span class="cm">    }*/</span>

    <span class="c1">//配置生成模板解析器
</span><span class="c1"></span>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">ITemplateResolver</span> <span class="nf">templateResolver</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">WebApplicationContext</span> <span class="n">webApplicationContext</span> <span class="o">=</span> <span class="n">ContextLoader</span><span class="o">.</span><span class="na">getCurrentWebApplicationContext</span><span class="o">();</span>
        <span class="c1">// ServletContextTemplateResolver需要一个ServletContext作为构造参数，可通过WebApplicationContext 的方法获得
</span><span class="c1"></span>        <span class="n">ServletContextTemplateResolver</span> <span class="n">templateResolver</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServletContextTemplateResolver</span><span class="o">(</span>
                <span class="n">webApplicationContext</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">());</span>
        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setPrefix</span><span class="o">(</span><span class="s">&#34;/WEB-INF/templates/&#34;</span><span class="o">);</span>
        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setSuffix</span><span class="o">(</span><span class="s">&#34;.html&#34;</span><span class="o">);</span>
        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>
        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setTemplateMode</span><span class="o">(</span><span class="n">TemplateMode</span><span class="o">.</span><span class="na">HTML</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">templateResolver</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//生成模板引擎并为模板引擎注入模板解析器
</span><span class="c1"></span>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">SpringTemplateEngine</span> <span class="nf">templateEngine</span><span class="o">(</span><span class="n">ITemplateResolver</span> <span class="n">templateResolver</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SpringTemplateEngine</span> <span class="n">templateEngine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SpringTemplateEngine</span><span class="o">();</span>
        <span class="n">templateEngine</span><span class="o">.</span><span class="na">setTemplateResolver</span><span class="o">(</span><span class="n">templateResolver</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">templateEngine</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//生成视图解析器并未解析器注入模板引擎
</span><span class="c1"></span>    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">ViewResolver</span> <span class="nf">viewResolver</span><span class="o">(</span><span class="n">SpringTemplateEngine</span> <span class="n">templateEngine</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ThymeleafViewResolver</span> <span class="n">viewResolver</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThymeleafViewResolver</span><span class="o">();</span>
        <span class="n">viewResolver</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>
        <span class="n">viewResolver</span><span class="o">.</span><span class="na">setTemplateEngine</span><span class="o">(</span><span class="n">templateEngine</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">viewResolver</span><span class="o">;</span>
    <span class="o">}</span>


<span class="o">}</span>
</code></pre></div><hr>
<p><strong>感谢尚硅谷</strong>
<a href="https://rileyshen.github.io/post/springmvc/" >springmvc1</a></p>
<p><a href="https://rileyshen.github.io/post/springmvc2/" >springmvc2</a></p>
<p><a href="https://rileyshen.github.io/post/springmvc3/" >springmvc3</a></p>
<p><a href="https://rileyshen.github.io/post/springmvc5/" >springmvc5</a></p>
<p><a href="https://rileyshen.github.io/post/spring1/" >spring</a></p>
<p><a href="https://rileyshen.github.io/tags/javaweb/" >javaweb</a></p></div>
    <div class="post-footer">
        <div class="info">
            
            <span class="separator"><a class="tag" href="/tags/crud/">CRUD</a><a class="tag" href="/tags/ioc/">IOC</a><a class="tag" href="/tags/aop/">AOP</a><a class="tag" href="/tags/spring5/">Spring5</a></span>
        </div>
    </div>

    
</div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script>
<script async defer src="//latest.js"></script>
<noscript><img src="//noscript.gif" alt=""/></noscript>

</body>

</html>
