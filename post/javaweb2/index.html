<!DOCTYPE html>
<html  dir="ltr" lang="en" data-theme=""><head>
    <title> Riley Shen | java web project--learning through building 2 </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description"
        content="a full-stack web application for users to understand java web system">
    <meta name="google-site-verification" content="Nac1UrFTdr1E1F48JLe7XQhIbKn2_WtF4VnJI8KOtew" />
    

    
    
    
    <link rel="stylesheet" href="/css/main.min.a7c9793b97840076bef76d2743ee1c90b13bd21c18674076a0cccd5dd54c723b.css" integrity="sha256-p8l5O5eEAHa&#43;920nQ&#43;4ckLE70hwYZ0B2oMzNXdVMcjs="
        crossorigin="anonymous" type="text/css">
    
    
    <link rel="stylesheet" href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4=" crossorigin="anonymous" type="text/css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />

    
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">

    <link rel="canonical" href="/post/javaweb2/">

    <link rel="preconnect" href="https://fonts.gstatic.com">



    
    
    
    
    <script type="text/javascript" src="/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js"
        integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin="anonymous"></script>


    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rileyshen.github.io/images/site-feature-image.png"/>

<meta name="twitter:title" content="java web project--learning through building 2"/>
<meta name="twitter:description" content="a full-stack web application for users to understand java web system"/>


    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,500;1,600;1,700&display=swap"
        rel="stylesheet">

</head><body><div class="sidebar animated fadeInDown ">
    <div class="logo-title">
        <div class="title">
            <img src="/images/profileS.jpg" alt="profile picture">
            <h3 title=""><a href="/">I&#39;m Riley Shen</a></h3>
            <div class="description">
                <p><br>Riley likes to push her limits <br>and always keep learning new things. <br>She shares her weekly learnings <br>because "if you can't explain it simply,<br>it means you didn't understand it well enough".<br></p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="mailto:ripple.shen31@gmail.com" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/rileyshen" rel="me" aria-label="GitHub">
                    <i class="fab fa-github fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy;  Riley Shen 2022 </div>
    </div>
</div>
<div class="main">
    <div class="page-top  animated fadeInDown ">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/post/"
                        
                   title="">Posts</a></li>
        
            
            <li><a 
                   href="/about/"
                        
                   title="">About Me</a></li>
        
            
            <li><a 
                   href="/contact/"
                        
                   title="">Contact</a></li>
        
        
        
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
<div class="post  animated fadeInDown ">
    <div class="post-content">
        
        <div class="post-title">
            <h2>java web project--learning through building 2</h2>
            
            <div class="info">
                <em class="fas fa-calendar-day"></em>
                <span class="date">
                    Tue, Jan 12, 2021
                    </span>
                <em class="fas fa-stopwatch"></em>
                <span class="reading-time">5-minute read</span>
            </div>
            
        </div>

        <p>a full-stack web application for users to understand java web system</p>
<!-- TOC -->
<ul>
<li><a href="#jquery" >jQuery</a>
<ul>
<li><a href="#attr" >attr</a></li>
<li><a href="#prop-checked-readonly-selected-disabled" >prop checked, readOnly, selected, disabled</a></li>
<li><a href="#xml" >xml</a></li>
</ul>
</li>
<li><a href="#servlet" >Servlet</a>
<ul>
<li><a href="#httpservlet" >HttpServlet</a></li>
<li><a href="#" >/</a></li>
<li><a href="#garbled-languagee" >garbled languagee</a></li>
</ul>
</li>
<li><a href="#javaee-three-tier-system-decouple" >JavaEE three-tier system, decouple</a></li>
<li><a href="#servlet-thymeleaf" >servlet thymeleaf</a>
<ul>
<li><a href="#index" >index</a></li>
<li><a href="#thymeleaf-%E8%A7%86%E5%9B%BE%E6%A8%A1%E6%9D%BF%E6%8A%80%E6%9C%AF" >Thymeleaf 视图模板技术</a></li>
<li><a href="#viewbaseservlet" >ViewBaseServlet</a></li>
<li><a href="#templateengine-%E7%94%A8%E6%B3%95" >TemplateEngine 用法</a></li>
<li><a href="#index-thif--thless-%E7%94%A8%E6%B3%95" >index th:if &amp;amp;&amp;amp; th:less 用法</a></li>
<li><a href="#webservleteditdo-putget-%E9%97%AE%E9%A2%98" >@WebServlet&amp;quot;/edit.do&amp;quot; put/get 问题</a></li>
</ul>
</li>
<li><a href="#%E5%BC%95%E8%BF%9B-dispatchservlet-%E5%90%8E%E4%BB%A3%E7%A0%81%E6%94%B9%E5%8F%98" >引进 dispatchServlet 后代码改变</a>
<ul>
<li><a href="#servlets-%E5%90%88%E5%B9%B6" >servlets 合并</a></li>
<li><a href="#%E5%8F%8D%E5%B0%84%E6%96%B9%E6%B3%95%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E5%A2%9E%E5%8A%A0%E6%9B%B4%E5%A4%9A%E7%9A%84-method%E8%80%8C%E4%B8%8D%E7%94%A8-switch-%E6%9D%A5%E5%A2%9E%E5%8A%A0%E4%BB%A3%E7%A0%81" >反射方法，这样可以增加更多的 method，而不用 switch 来增加代码</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h3 id="jquery">jQuery</h3>
<p><a id="markdown-jquery" name="jquery"></a></p>
<h4 id="attr">attr()</h4>
<p><a id="markdown-attr" name="attr"></a></p>
<h4 id="prop-checked-readonly-selected-disabled">prop() (checked, readOnly, selected, disabled)</h4>
<p><a id="markdown-prop-checked%2C-readonly%2C-selected%2C-disabled" name="prop-checked%2C-readonly%2C-selected%2C-disabled"></a></p>
<h4 id="xml">xml</h4>
<p><a id="markdown-xml" name="xml"></a></p>
<h3 id="servlet">Servlet</h3>
<p><a id="markdown-servlet" name="servlet"></a></p>
<h4 id="httpservlet">HttpServlet</h4>
<p><a id="markdown-httpservlet" name="httpservlet"></a></p>
<p>in real life always use HttpServlet instead of the GenericServlet. HttpServlet is easier to work with, and has more methods to work with than GenericServlet.</p>
<h4 id="heading">/</h4>
<p>/ decode by web</p>
<blockquote>
<p><a href="/">/ </a> /  is a absolute path: http:ip:port/</p>
</blockquote>
<p>/ decode by service</p>
<blockquote>
<p><url-pattern>/servlet </url-pattern>/  is a absolute path: http:ip:port/project</p>
</blockquote>
<blockquote>
<p>servletContext.getRealPath(&quot;/&quot;)</p>
</blockquote>
<blockquote>
<p>request.getRequestDispatcher(&quot;/&quot;)</p>
</blockquote>
<blockquote>
<p>reponse.sendRediect(&quot;/&quot;) // send / to web get http:ip:port/</p>
</blockquote>
<h4 id="garbled-languagee">garbled languagee</h4>
<p><a id="markdown-garbled-languagee" name="garbled-languagee"></a></p>
<blockquote>
<p>resp.setContentType(&ldquo;text/html; charset=UTF-8&rdquo;);</p>
</blockquote>
<h3 id="javaee-three-tier-system-decouple">JavaEE three-tier system, decouple</h3>
<p><a id="markdown-javaee-three-tier-system%2C-decouple" name="javaee-three-tier-system%2C-decouple"></a></p>
<p>client(Web Browser)</p>
<p>⬇️</p>
<p>JaveEE three-tier system</p>
<p>⬇️</p>
<p>1️⃣ web/view</p>
<ul>
<li>
<ol>
<li>get request parameter, encapsulate into a single standardized Bean object;</li>
</ol>
</li>
<li>
<ol start="2">
<li>invoke Service layer to deal with business;</li>
</ol>
</li>
<li>
<ol start="3">
<li>response to client, sendRediect, getRequestDispatcher;</li>
</ol>
</li>
</ul>
<p>⬇️ ⬇️</p>
<p>2️⃣ Serveice</p>
<ul>
<li>
<ol>
<li>deal with business layer</li>
</ol>
</li>
<li>
<ol start="2">
<li>invoke Dao save date</li>
</ol>
</li>
</ul>
<p>⬇️ ⬇️</p>
<p>3️⃣ Dao persistence layer</p>
<ul>
<li>only interact with Sql
<ul>
<li>CRUD</li>
<li>Create</li>
<li>Read</li>
<li>Update</li>
<li>Delete</li>
</ul>
</li>
</ul>
<p>⤵️</p>
<p>MySQL, Oracle, SqlServer</p>
<p>↩️</p>
<ul>
<li>Dao
<ul>
<li>Jdbc</li>
<li>DbUtile</li>
<li>JdbcTemplate</li>
<li>Mybatis</li>
<li>Hiberante</li>
<li>JPA</li>
</ul>
</li>
</ul>
<p>↩️</p>
<ul>
<li>Serveice
<ul>
<li>Spring frame</li>
</ul>
</li>
</ul>
<p>↩️</p>
<ul>
<li>Web
<ul>
<li>Service</li>
<li>Webwork</li>
<li>Strtus1.x/2.x</li>
<li>SpringMVC</li>
</ul>
</li>
</ul>
<h3 id="servlet-thymeleaf">servlet thymeleaf</h3>
<p><a id="markdown-servlet-thymeleaf" name="servlet-thymeleaf"></a></p>
<h4 id="index">index</h4>
<p><a id="markdown-index" name="index"></a></p>
<blockquote>
<p>index -》 IndexServlet （service（） -》 doGet（） ） -》《- xxDAOImpl -》 《- BaseDAO -》 《- 向数据库发起请求  -》 IndexServlet （service（） -》 doGet（） ） -》《- xxDAOImpl -》 《- BaseDAO -》 《- 向数据库发起请求</p>
</blockquote>
<h4 id="thymeleaf-视图模板技术">Thymeleaf 视图模板技术</h4>
<p><a id="markdown-thymeleaf-%E8%A7%86%E5%9B%BE%E6%A8%A1%E6%9D%BF%E6%8A%80%E6%9C%AF" name="thymeleaf-%E8%A7%86%E5%9B%BE%E6%A8%A1%E6%9D%BF%E6%8A%80%E6%9C%AF"></a></p>
<ul>
<li>添加 Thymeleaf jar 包</li>
<li>web.xml 添加配置</li>
<li>新建一个 ViewBaseServlet
<ul>
<li>配置前缀 prefix</li>
<li>配置后缀 suffix</li>
</ul>
</li>
<li>servlet 继承 ViewBaseServlet</li>
</ul>
<h4 id="viewbaseservlet">ViewBaseServlet</h4>
<p><a id="markdown-viewbaseservlet" name="viewbaseservlet"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ViewBaseServlet</span> <span class="kd">extends</span> <span class="n">HttpServlet</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">TemplateEngine</span> <span class="n">templateEngine</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">ServletException</span> <span class="o">{</span>

        <span class="c1">// 1.获取ServletContext对象
</span><span class="c1"></span>        <span class="n">ServletContext</span> <span class="n">servletContext</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>

        <span class="c1">// 2.创建Thymeleaf解析器对象
</span><span class="c1"></span>        <span class="n">ServletContextTemplateResolver</span> <span class="n">templateResolver</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServletContextTemplateResolver</span><span class="o">(</span><span class="n">servletContext</span><span class="o">);</span>

        <span class="c1">// 3.给解析器对象设置参数
</span><span class="c1"></span>        <span class="c1">// ①HTML是默认模式，明确设置是为了代码更容易理解
</span><span class="c1"></span>        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setTemplateMode</span><span class="o">(</span><span class="n">TemplateMode</span><span class="o">.</span><span class="na">HTML</span><span class="o">);</span>

        <span class="c1">// ②设置前缀
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">viewPrefix</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">&#34;view-prefix&#34;</span><span class="o">);</span>

        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setPrefix</span><span class="o">(</span><span class="n">viewPrefix</span><span class="o">);</span>

        <span class="c1">// ③设置后缀
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">viewSuffix</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">getInitParameter</span><span class="o">(</span><span class="s">&#34;view-suffix&#34;</span><span class="o">);</span>

        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setSuffix</span><span class="o">(</span><span class="n">viewSuffix</span><span class="o">);</span>

        <span class="c1">// ④设置缓存过期时间（毫秒）
</span><span class="c1"></span>        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setCacheTTLMs</span><span class="o">(</span><span class="n">60000L</span><span class="o">);</span>

        <span class="c1">// ⑤设置是否缓存
</span><span class="c1"></span>        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setCacheable</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="c1">// ⑥设置服务器端编码方式
</span><span class="c1"></span>        <span class="n">templateResolver</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;utf-8&#34;</span><span class="o">);</span>

        <span class="c1">// 4.创建模板引擎对象
</span><span class="c1"></span>        <span class="n">templateEngine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TemplateEngine</span><span class="o">();</span>

        <span class="c1">// 5.给模板引擎对象设置模板解析器
</span><span class="c1"></span>        <span class="n">templateEngine</span><span class="o">.</span><span class="na">setTemplateResolver</span><span class="o">(</span><span class="n">templateResolver</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">processTemplate</span><span class="o">(</span><span class="n">String</span> <span class="n">templateName</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="c1">// 1.设置响应体内容类型和字符集
</span><span class="c1"></span>        <span class="n">resp</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">&#34;text/html;charset=UTF-8&#34;</span><span class="o">);</span>

        <span class="c1">// 2.创建WebContext对象
</span><span class="c1"></span>        <span class="n">WebContext</span> <span class="n">webContext</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WebContext</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">resp</span><span class="o">,</span> <span class="n">getServletContext</span><span class="o">());</span>

        <span class="c1">// 3.处理模板数据
</span><span class="c1"></span>        <span class="n">templateEngine</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">templateName</span><span class="o">,</span> <span class="n">webContext</span><span class="o">,</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><h4 id="templateengine-用法">TemplateEngine 用法</h4>
<p><a id="markdown-templateengine-%E7%94%A8%E6%B3%95" name="templateengine-%E7%94%A8%E6%B3%95"></a></p>
<h4 id="index-thif--thless-用法">index th:if &amp;&amp; th:less 用法</h4>
<p><a id="markdown-index-th%3Aif-%26%26-th%3Aless-%E7%94%A8%E6%B3%95" name="index-th%3Aif-%26%26-th%3Aless-%E7%94%A8%E6%B3%95"></a></p>
<p>th:if 是条件为 true</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="o">&lt;</span><span class="n">tr</span> <span class="n">th</span><span class="o">:</span><span class="k">if</span><span class="o">=</span><span class="s">&#34;${#lists.isEmpty(session.bookList)}&#34;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">td</span> <span class="n">colspan</span><span class="o">=</span><span class="s">&#34;4&#34;</span><span class="o">&gt;</span><span class="n">库存为空</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</code></pre></div><p>th:unless 是条件为 false</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="o">&lt;</span><span class="n">tr</span> <span class="n">th</span><span class="o">:</span><span class="n">unless</span><span class="o">=</span><span class="s">&#34;${#lists.isEmpty(session.bookList)}&#34;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">book1</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
    <span class="n">td</span><span class="o">&gt;</span><span class="n">200</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
    <span class="n">td</span><span class="o">&gt;</span><span class="n">30</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</code></pre></div><h4 id="webservleteditdo-putget-问题">@WebServlet(&quot;/edit.do&quot;) put/get 问题</h4>
<p><a id="markdown-%40webservlet%22%2Fedit.do%22-put%2Fget-%E9%97%AE%E9%A2%98" name="%40webservlet%22%2Fedit.do%22-put%2Fget-%E9%97%AE%E9%A2%98"></a></p>
<p>先理解只要不是 form 表单，修改也是 get</p>
<p>游览器只能发送 get 和 post</p>
<h3 id="引进-dispatchservlet-后代码改变">引进 dispatchServlet 后代码改变</h3>
<p><a id="markdown-%E5%BC%95%E8%BF%9B-dispatchservlet-%E5%90%8E%E4%BB%A3%E7%A0%81%E6%94%B9%E5%8F%98" name="%E5%BC%95%E8%BF%9B-dispatchservlet-%E5%90%8E%E4%BB%A3%E7%A0%81%E6%94%B9%E5%8F%98"></a></p>
<figure><img src="/images/jwb1.png"
         alt="image"/><figcaption>
            <h4>springmvc</h4>
        </figcaption>
</figure>

<h4 id="servlets-合并">servlets 合并</h4>
<p><a id="markdown-servlets-%E5%90%88%E5%B9%B6" name="servlets-%E5%90%88%E5%B9%B6"></a></p>
<ul>
<li>AddServlet.java</li>
</ul>
<figure><img src="/images/jwb2.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">&#34;/add.do&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddServlet</span> <span class="kd">extends</span> <span class="n">ViewBaseServlet</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">FruitDAO</span> <span class="n">fruitDAO</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FruitDAOImpl</span><span class="o">();</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fname&#34;</span><span class="o">);</span>
        <span class="n">Integer</span> <span class="n">price</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;price&#34;</span><span class="o">))</span> <span class="o">;</span>
        <span class="n">Integer</span> <span class="n">fcount</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fcount&#34;</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">remark</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;remark&#34;</span><span class="o">);</span>

        <span class="n">Fruit</span> <span class="n">fruit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Fruit</span><span class="o">(</span><span class="n">0</span><span class="o">,</span><span class="n">fname</span> <span class="o">,</span> <span class="n">price</span> <span class="o">,</span> <span class="n">fcount</span> <span class="o">,</span> <span class="n">remark</span> <span class="o">)</span> <span class="o">;</span>

        <span class="n">fruitDAO</span><span class="o">.</span><span class="na">addFruit</span><span class="o">(</span><span class="n">fruit</span><span class="o">);</span>

        <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">&#34;index&#34;</span><span class="o">);</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><ul>
<li>Servelt 过多</li>
</ul>
<figure><img src="/images/jwb3.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<p>在方法中用</p>
<p>switch{
case &ldquo;index&rdquo; 
}</p>
<figure><img src="/images/jwb4.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">&#34;/fruit.do&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FruitServlet</span> <span class="kd">extends</span> <span class="n">ViewBaseServlet</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">FruitDAO</span> <span class="n">fruitDAO</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FruitDAOImpl</span><span class="o">();</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">service</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="c1">//设置编码
</span><span class="c1"></span>        <span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">operate</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;operate&#34;</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">operate</span><span class="o">)){</span>
            <span class="n">operate</span> <span class="o">=</span> <span class="s">&#34;index&#34;</span> <span class="o">;</span>
        <span class="o">}</span>

        <span class="k">switch</span><span class="o">(</span><span class="n">operate</span><span class="o">){</span>
            <span class="k">case</span> <span class="s">&#34;index&#34;</span><span class="o">:</span>
                <span class="n">index</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">&#34;add&#34;</span><span class="o">:</span>
                <span class="n">add</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">&#34;del&#34;</span><span class="o">:</span>
                <span class="n">del</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">&#34;edit&#34;</span><span class="o">:</span>
                <span class="n">edit</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">&#34;update&#34;</span><span class="o">:</span>
                <span class="n">update</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;operate值非法!&#34;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="c1">//1.设置编码
</span><span class="c1"></span>        <span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;utf-8&#34;</span><span class="o">);</span>

        <span class="c1">//2.获取参数
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">fidStr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fid&#34;</span><span class="o">);</span>
        <span class="n">Integer</span> <span class="n">fid</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">fidStr</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fname&#34;</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">priceStr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;price&#34;</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">price</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">priceStr</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">fcountStr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fcount&#34;</span><span class="o">);</span>
        <span class="n">Integer</span> <span class="n">fcount</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">fcountStr</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">remark</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;remark&#34;</span><span class="o">);</span>

        <span class="c1">//3.执行更新
</span><span class="c1"></span>        <span class="n">fruitDAO</span><span class="o">.</span><span class="na">updateFruit</span><span class="o">(</span><span class="k">new</span> <span class="n">Fruit</span><span class="o">(</span><span class="n">fid</span><span class="o">,</span><span class="n">fname</span><span class="o">,</span> <span class="n">price</span> <span class="o">,</span><span class="n">fcount</span> <span class="o">,</span><span class="n">remark</span> <span class="o">));</span>

        <span class="c1">//4.资源跳转
</span><span class="c1"></span>        <span class="c1">//super.processTemplate(&#34;index&#34;,request,response);
</span><span class="c1"></span>        <span class="c1">//request.getRequestDispatcher(&#34;index.html&#34;).forward(request,response);
</span><span class="c1"></span>        <span class="c1">//此处需要重定向，目的是重新给IndexServlet发请求，重新获取furitList，然后覆盖到session中，这样index.html页面上显示的session中的数据才是最新的
</span><span class="c1"></span>        <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">&#34;fruit.do&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">edit</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span> <span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span><span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ServletException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">fidStr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fid&#34;</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isNotEmpty</span><span class="o">(</span><span class="n">fidStr</span><span class="o">)){</span>
            <span class="kt">int</span> <span class="n">fid</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">fidStr</span><span class="o">);</span>
            <span class="n">Fruit</span> <span class="n">fruit</span> <span class="o">=</span> <span class="n">fruitDAO</span><span class="o">.</span><span class="na">getFruitByFid</span><span class="o">(</span><span class="n">fid</span><span class="o">);</span>
            <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;fruit&#34;</span><span class="o">,</span><span class="n">fruit</span><span class="o">);</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">processTemplate</span><span class="o">(</span><span class="s">&#34;edit&#34;</span><span class="o">,</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">del</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span> <span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span><span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ServletException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">fidStr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fid&#34;</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isNotEmpty</span><span class="o">(</span><span class="n">fidStr</span><span class="o">)){</span>
            <span class="kt">int</span> <span class="n">fid</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">fidStr</span><span class="o">);</span>
            <span class="n">fruitDAO</span><span class="o">.</span><span class="na">delFruit</span><span class="o">(</span><span class="n">fid</span><span class="o">);</span>

            <span class="c1">//super.processTemplate(&#34;index&#34;,request,response);
</span><span class="c1"></span>            <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">&#34;fruit.do&#34;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fname&#34;</span><span class="o">);</span>
        <span class="n">Integer</span> <span class="n">price</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;price&#34;</span><span class="o">))</span> <span class="o">;</span>
        <span class="n">Integer</span> <span class="n">fcount</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;fcount&#34;</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">remark</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;remark&#34;</span><span class="o">);</span>

        <span class="n">Fruit</span> <span class="n">fruit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Fruit</span><span class="o">(</span><span class="n">0</span><span class="o">,</span><span class="n">fname</span> <span class="o">,</span> <span class="n">price</span> <span class="o">,</span> <span class="n">fcount</span> <span class="o">,</span> <span class="n">remark</span> <span class="o">)</span> <span class="o">;</span>

        <span class="n">fruitDAO</span><span class="o">.</span><span class="na">addFruit</span><span class="o">(</span><span class="n">fruit</span><span class="o">);</span>

        <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">&#34;fruit.do&#34;</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">index</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span> <span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span><span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ServletException</span> <span class="o">{</span>
        <span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">()</span> <span class="o">;</span>

        <span class="c1">// 设置当前页，默认值1
</span><span class="c1"></span>        <span class="n">Integer</span> <span class="n">pageNo</span> <span class="o">=</span> <span class="n">1</span> <span class="o">;</span>

        <span class="n">String</span> <span class="n">oper</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;oper&#34;</span><span class="o">);</span>

        <span class="c1">//如果oper!=null 说明 通过表单的查询按钮点击过来的
</span><span class="c1"></span>        <span class="c1">//如果oper是空的，说明 不是通过表单的查询按钮点击过来的
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">keyword</span> <span class="o">=</span> <span class="kc">null</span> <span class="o">;</span>
        <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isNotEmpty</span><span class="o">(</span><span class="n">oper</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="s">&#34;search&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">oper</span><span class="o">)){</span>
            <span class="c1">//说明是点击表单查询发送过来的请求
</span><span class="c1"></span>            <span class="c1">//此时，pageNo应该还原为1 ， keyword应该从请求参数中获取
</span><span class="c1"></span>            <span class="n">pageNo</span> <span class="o">=</span> <span class="n">1</span> <span class="o">;</span>
            <span class="n">keyword</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;keyword&#34;</span><span class="o">);</span>
            <span class="c1">//如果keyword为null，需要设置为空字符串&#34;&#34;，否则查询时会拼接成 %null% , 我们期望的是 %%
</span><span class="c1"></span>            <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">keyword</span><span class="o">)){</span>
                <span class="n">keyword</span> <span class="o">=</span> <span class="s">&#34;&#34;</span> <span class="o">;</span>
            <span class="o">}</span>
            <span class="c1">//将keyword保存（覆盖）到session中
</span><span class="c1"></span>            <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;keyword&#34;</span><span class="o">,</span><span class="n">keyword</span><span class="o">);</span>
        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
            <span class="c1">//说明此处不是点击表单查询发送过来的请求（比如点击下面的上一页下一页或者直接在地址栏输入网址）
</span><span class="c1"></span>            <span class="c1">//此时keyword应该从session作用域获取
</span><span class="c1"></span>            <span class="n">String</span> <span class="n">pageNoStr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;pageNo&#34;</span><span class="o">);</span>
            <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isNotEmpty</span><span class="o">(</span><span class="n">pageNoStr</span><span class="o">)){</span>
                <span class="n">pageNo</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">pageNoStr</span><span class="o">);</span>   <span class="c1">//如果从请求中读取到pageNo，则类型转换。否则，pageNo默认就是1
</span><span class="c1"></span>            <span class="o">}</span>
            <span class="c1">//如果不是点击的查询按钮，那么查询是基于session中保存的现有keyword进行查询
</span><span class="c1"></span>            <span class="n">Object</span> <span class="n">keywordObj</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;keyword&#34;</span><span class="o">);</span>
            <span class="k">if</span><span class="o">(</span><span class="n">keywordObj</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
                <span class="n">keyword</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span><span class="n">keywordObj</span> <span class="o">;</span>
            <span class="o">}</span><span class="k">else</span><span class="o">{</span>
                <span class="n">keyword</span> <span class="o">=</span> <span class="s">&#34;&#34;</span> <span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="c1">// 重新更新当前页的值
</span><span class="c1"></span>        <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;pageNo&#34;</span><span class="o">,</span><span class="n">pageNo</span><span class="o">);</span>

        <span class="n">FruitDAO</span> <span class="n">fruitDAO</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FruitDAOImpl</span><span class="o">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Fruit</span><span class="o">&gt;</span> <span class="n">fruitList</span> <span class="o">=</span> <span class="n">fruitDAO</span><span class="o">.</span><span class="na">getFruitList</span><span class="o">(</span><span class="n">keyword</span> <span class="o">,</span> <span class="n">pageNo</span><span class="o">);</span>
        <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;fruitList&#34;</span><span class="o">,</span><span class="n">fruitList</span><span class="o">);</span>

        <span class="c1">//总记录条数
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">fruitCount</span> <span class="o">=</span> <span class="n">fruitDAO</span><span class="o">.</span><span class="na">getFruitCount</span><span class="o">(</span><span class="n">keyword</span><span class="o">);</span>
        <span class="c1">//总页数
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">pageCount</span> <span class="o">=</span> <span class="o">(</span><span class="n">fruitCount</span><span class="o">+</span><span class="n">5</span><span class="o">-</span><span class="n">1</span><span class="o">)/</span><span class="n">5</span> <span class="o">;</span>
        <span class="cm">/*
</span><span class="cm">        总记录条数       总页数
</span><span class="cm">        1               1
</span><span class="cm">        5               1
</span><span class="cm">        6               2
</span><span class="cm">        10              2
</span><span class="cm">        11              3
</span><span class="cm">        fruitCount      (fruitCount+5-1)/5
</span><span class="cm">         */</span>
        <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;pageCount&#34;</span><span class="o">,</span><span class="n">pageCount</span><span class="o">);</span>

        <span class="c1">//此处的视图名称是 index
</span><span class="c1"></span>        <span class="c1">//那么thymeleaf会将这个 逻辑视图名称 对应到 物理视图 名称上去
</span><span class="c1"></span>        <span class="c1">//逻辑视图名称 ：   index
</span><span class="c1"></span>        <span class="c1">//物理视图名称 ：   view-prefix + 逻辑视图名称 + view-suffix
</span><span class="c1"></span>        <span class="c1">//所以真实的视图名称是：      /       index       .html
</span><span class="c1"></span>        <span class="kd">super</span><span class="o">.</span><span class="na">processTemplate</span><span class="o">(</span><span class="s">&#34;index&#34;</span><span class="o">,</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>


</code></pre></div><h4 id="反射方法这样可以增加更多的-method而不用-switch-来增加代码">反射方法，这样可以增加更多的 method，而不用 switch 来增加代码</h4>
<p><a id="markdown-%E5%8F%8D%E5%B0%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E5%A2%9E%E5%8A%A0%E6%9B%B4%E5%A4%9A%E7%9A%84-method%EF%BC%8C%E8%80%8C%E4%B8%8D%E7%94%A8-switch-%E6%9D%A5%E5%A2%9E%E5%8A%A0%E4%BB%A3%E7%A0%81" name="%E5%8F%8D%E5%B0%84%E6%96%B9%E6%B3%95%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%8F%AF%E4%BB%A5%E5%A2%9E%E5%8A%A0%E6%9B%B4%E5%A4%9A%E7%9A%84-method%EF%BC%8C%E8%80%8C%E4%B8%8D%E7%94%A8-switch-%E6%9D%A5%E5%A2%9E%E5%8A%A0%E4%BB%A3%E7%A0%81"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">&#34;/fruit.do&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FruitServlet</span> <span class="kd">extends</span> <span class="n">ViewBaseServlet</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">FruitDAO</span> <span class="n">fruitDAO</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FruitDAOImpl</span><span class="o">();</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">service</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="c1">//设置编码
</span><span class="c1"></span>        <span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">&#34;UTF-8&#34;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">operate</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&#34;operate&#34;</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">StringUtil</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">operate</span><span class="o">)){</span>
            <span class="n">operate</span> <span class="o">=</span> <span class="s">&#34;index&#34;</span> <span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// 获取当前类中所有方法
</span><span class="c1"></span>        <span class="n">Method</span><span class="o">[]</span> <span class="n">methods</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getDeclareMethods</span><span class="o">();</span>

        <span class="k">for</span> <span class="o">(</span><span class="n">Method</span> <span class="n">m</span> <span class="o">:</span> <span class="n">methods</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">methodName</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">operate</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">methodName</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="c1">// 找到和 operate 同名的方法， 那么通过反射技术调用它
</span><span class="c1"></span>                    <span class="n">m</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
                    <span class="k">return</span><span class="o">;</span>
                <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IllegalAcc</span><span class="o">....)</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printS</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;operate值非法!&#34;</span><span class="o">);</span>
    <span class="o">}</span>

        <span class="c1">// switch(operate){
</span><span class="c1"></span>        <span class="c1">//     case &#34;index&#34;:
</span><span class="c1"></span>        <span class="c1">//         index(request,response);
</span><span class="c1"></span>        <span class="c1">//         break;
</span><span class="c1"></span>        <span class="c1">//     case &#34;add&#34;:
</span><span class="c1"></span>        <span class="c1">//         add(request,response);
</span><span class="c1"></span>        <span class="c1">//         break;
</span><span class="c1"></span>        <span class="c1">//     case &#34;del&#34;:
</span><span class="c1"></span>        <span class="c1">//         del(request,response);
</span><span class="c1"></span>        <span class="c1">//         break;
</span><span class="c1"></span>        <span class="c1">//     case &#34;edit&#34;:
</span><span class="c1"></span>        <span class="c1">//         edit(request,response);
</span><span class="c1"></span>        <span class="c1">//         break;
</span><span class="c1"></span>        <span class="c1">//     case &#34;update&#34;:
</span><span class="c1"></span>        <span class="c1">//         update(request,response);
</span><span class="c1"></span>        <span class="c1">//         break;
</span><span class="c1"></span>        <span class="c1">//     default:
</span><span class="c1"></span>                <span class="c1">//  throw new RuntimeException(&#34;operate值非法!&#34;);
</span><span class="c1"></span>        <span class="c1">// }
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> 

</code></pre></div><hr>
<p><a href="https://rileyshen.github.io/post/javaweb1/" >javaweb1</a>
<a href="https://rileyshen.github.io/post/javaweb3/" >javaweb3</a>
<a href="https://rileyshen.github.io/post/javaweb4/" >javaweb4</a>
<a href="https://rileyshen.github.io/post/javaweb5/" >javaweb5</a>
<a href="https://rileyshen.github.io/tags/spring/" >spring</a>
<a href="https://rileyshen.github.io/post/springmvc/" >springmvc</a></p></div>
    <div class="post-footer">
        <div class="info">
            
            <span class="separator"><a class="tag" href="/tags/javaee-project/">javaEE project</a><a class="tag" href="/tags/javaee-web/">javaEE web</a><a class="tag" href="/tags/three-tier-system/">Three-tier system</a><a class="tag" href="/tags/thymeleaf/">Thymeleaf</a><a class="tag" href="/tags/templateengine%2eprocess/">TemplateEngine.process</a></span>
        </div>
    </div>

    
</div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script>
<script async defer src="//latest.js"></script>
<noscript><img src="//noscript.gif" alt=""/></noscript>

</body>

</html>
