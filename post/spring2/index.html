<!DOCTYPE html>
<html  dir="ltr" lang="en" data-theme=""><head>
    <title> Riley Shen | spring learning code 2 </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description"
        content="spring learning code">
    <meta name="google-site-verification" content="Nac1UrFTdr1E1F48JLe7XQhIbKn2_WtF4VnJI8KOtew" />
    

    
    
    
    <link rel="stylesheet" href="/css/main.min.a7c9793b97840076bef76d2743ee1c90b13bd21c18674076a0cccd5dd54c723b.css" integrity="sha256-p8l5O5eEAHa&#43;920nQ&#43;4ckLE70hwYZ0B2oMzNXdVMcjs="
        crossorigin="anonymous" type="text/css">
    
    
    <link rel="stylesheet" href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4=" crossorigin="anonymous" type="text/css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />

    
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">

    <link rel="canonical" href="/post/spring2/">

    <link rel="preconnect" href="https://fonts.gstatic.com">



    
    
    
    
    <script type="text/javascript" src="/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js"
        integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin="anonymous"></script>


    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rileyshen.github.io/images/site-feature-image.png"/>

<meta name="twitter:title" content="spring learning code 2"/>
<meta name="twitter:description" content="spring learning code"/>


    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,500;1,600;1,700&display=swap"
        rel="stylesheet">

</head><body><div class="sidebar animated fadeInDown ">
    <div class="logo-title">
        <div class="title">
            <img src="/images/profileS.jpg" alt="profile picture">
            <h3 title=""><a href="/">I&#39;m Riley Shen</a></h3>
            <div class="description">
                <p><br>Riley likes to push her limits <br>and always keep learning new things. <br>She shares her weekly learnings <br>because "if you can't explain it simply,<br>it means you didn't understand it well enough".<br></p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="mailto:ripple.shen31@gmail.com" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/rileyshen" rel="me" aria-label="GitHub">
                    <i class="fab fa-github fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy;  Riley Shen 2023 </div>
    </div>
</div>
<div class="main">
    <div class="page-top  animated fadeInDown ">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/post/"
                        
                   title="">Posts</a></li>
        
            
            <li><a 
                   href="/about/"
                        
                   title="">About Me</a></li>
        
            
            <li><a 
                   href="/contact/"
                        
                   title="">Contact</a></li>
        
        
        
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
<div class="post  animated fadeInDown ">
    <div class="post-content">
        
        <div class="post-title">
            <h2>spring learning code 2</h2>
            
            <div class="info">
                <em class="fas fa-calendar-day"></em>
                <span class="date">
                    Thu, Apr 16, 2020
                    </span>
                <em class="fas fa-stopwatch"></em>
                <span class="reading-time">7-minute read</span>
            </div>
            
        </div>

        <p>This is my learning note about how Spring core features like IoC, AOP works, with Code Examples .</p>
<!-- TOC -->
<ul>
<li><a href="#spring-ioc-annotation" >spring IOC annotation</a>
<ul>
<li><a href="#dependency" >dependency</a></li>
<li><a href="#start-component-scan" >start component scan</a></li>
<li><a href="#set-properties-annotation" >set properties annotation</a></li>
<li><a href="#steps-annotation" >steps annotation</a></li>
<li><a href="#%E5%AE%8C%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91" >完全注解开发</a></li>
</ul>
</li>
<li><a href="#spring-aop" >spring AOP</a>
<ul>
<li><a href="#spring-aop" >spring AOP</a></li>
<li><a href="#aop-%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E5%BA%95%E5%B1%82%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86" >AOP 底层原理：底层使用动态代理</a></li>
<li><a href="#20-%E6%9C%89%E6%8E%A5%E5%8F%A3%E4%BD%BF%E7%94%A8-jdk-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86" >&lt;strong&gt;2.0 有接口，使用 JDK 动态代理&lt;/strong&gt;</a></li>
<li><a href="#30-aop-%E6%93%8D%E4%BD%9C" >&lt;strong&gt;3.0 AOP 操作&lt;/strong&gt;</a></li>
<li><a href="#40-aop-aspectj-%E6%B3%A8%E8%A7%A3" >&lt;strong&gt;4.0 AOP AspectJ 注解&lt;/strong&gt;</a></li>
<li><a href="#50-aop-aspectj-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" >&lt;strong&gt;5.0 AOP AspectJ 配置文件&lt;/strong&gt;</a></li>
</ul>
</li>
<li><a href="#spring-data-access-jdbc" >spring data access: JDBC</a>
<ul>
<li><a href="#jdbctemplate" >JdbcTemplate</a></li>
<li><a href="#10-dependency-jar" >&lt;strong&gt;1.0 dependency jar&lt;/strong&gt;</a></li>
<li><a href="#20-%E5%9C%A8-spring-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0" >&lt;strong&gt;2.0 在 spring 配置文件配置数据库连接池&lt;/strong&gt;</a></li>
<li><a href="#30-%E9%85%8D%E7%BD%AE-jdbctemplate-%E5%AF%B9%E8%B1%A1-%E6%B3%A8%E5%85%A5-datasource" >&lt;strong&gt;3.0 配置 JdbcTemplate 对象， 注入 DataSource&lt;/strong&gt;</a></li>
<li><a href="#40-%E5%88%9B%E5%BB%BA-service-%E7%B1%BB%E5%88%9B%E5%BB%BA-dao-%E7%B1%BB%E5%9C%A8-dao-%E6%B3%A8%E5%85%A5-jdbctemplate-%E5%AF%B9%E8%B1%A1" >&lt;strong&gt;4.0 创建 service 类，创建 dao 类，在 dao 注入 jdbcTemplate 对象&lt;/strong&gt;</a></li>
</ul>
</li>
<li><a href="#jdbctemplate-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD" >JdbcTemplate 操作数据库，添加功能</a>
<ul>
<li><a href="#10-%E5%AF%B9%E5%BA%94%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E4%BD%93%E7%B1%BB" >&lt;strong&gt;1.0 对应数据库实体类&lt;/strong&gt;</a></li>
<li><a href="#20-%E7%BC%96%E5%86%99-service-%E5%92%8C-dao" >&lt;strong&gt;2.0 编写 service 和 dao&lt;/strong&gt;</a></li>
<li><a href="#jdbctemplate-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9F%A5%E8%AF%A2" >JdbcTemplate 操作数据库，查询</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E8%A1%A8%E6%9C%89%E5%A4%9A%E5%B0%91%E6%9D%A1%E8%AE%B0%E5%BD%95" >&lt;strong&gt;查询表有多少条记录&lt;/strong&gt;</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E6%9F%90%E4%B8%AA%E5%80%BC" >&lt;strong&gt;查询返回某个值&lt;/strong&gt;</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1" >&lt;strong&gt;查询返回对象&lt;/strong&gt;</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E9%9B%86%E5%90%88" >&lt;strong&gt;查询返回集合&lt;/strong&gt;</a></li>
<li><a href="#%E6%89%B9%E9%87%8F%E5%A2%9E%E5%8A%A0%E6%93%8D%E4%BD%9C" >&lt;strong&gt;批量增加操作&lt;/strong&gt;</a></li>
<li><a href="#%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C" >&lt;strong&gt;批量修改操作&lt;/strong&gt;</a></li>
<li><a href="#%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C" >&lt;strong&gt;批量删除操作&lt;/strong&gt;</a>
<ul>
<li><a href="#ok-its-time-for-spring1" >Ok, It&amp;rsquo;s time for spring1</a></li>
<li><a href="#ok-its-time-for-spring2" >Ok, It&amp;rsquo;s time for spring2</a></li>
<li><a href="#ok-its-time-for-spring-mvc" >Ok, It&amp;rsquo;s time for spring mvc</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="spring-ioc-annotation">spring IOC annotation</h2>
<p><a id="markdown-spring-ioc-annotation" name="spring-ioc-annotation"></a></p>
<ul>
<li><em><strong>1. @Compoment</strong></em></li>
<li><em><strong>2. @Service</strong></em></li>
<li><em><strong>3. @Controller</strong></em></li>
<li><em><strong>4. @Repository</strong></em></li>
</ul>
<h3 id="dependency">dependency</h3>
<p><a id="markdown-dependency" name="dependency"></a></p>
<ul>
<li><em><strong>spring-aop</strong></em></li>
</ul>
<h3 id="start-component-scan">start component scan</h3>
<p><a id="markdown-start-component-scan" name="start-component-scan"></a></p>
<figure><img src="/images/spring25.png"
         alt="image"/><figcaption>
            <h4>annotation</h4>
        </figcaption>
</figure>

<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="o">&lt;</span><span class="n">context</span><span class="o">:</span><span class="n">component</span><span class="o">-</span><span class="n">scan</span> <span class="n">base</span><span class="o">-</span><span class="n">package</span><span class="o">=</span><span class="s">&#34;com.learn&#34;</span><span class="o">&gt;&lt;/</span><span class="n">context</span><span class="o">:</span><span class="n">component</span><span class="o">-</span><span class="n">scan</span><span class="o">&gt;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="o">&lt;</span><span class="n">context</span><span class="o">:</span><span class="n">component</span><span class="o">-</span><span class="n">scan</span> <span class="n">base</span><span class="o">-</span><span class="n">package</span><span class="o">=</span><span class="s">&#34;com.learn&#34;</span> <span class="n">use</span><span class="o">-</span><span class="k">default</span><span class="o">-</span><span class="n">filter</span><span class="o">=</span><span class="s">&#34;false&#34;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">context</span><span class="o">:</span><span class="n">include</span><span class="o">-</span><span class="n">filter</span> <span class="n">type</span><span class="o">=</span><span class="s">&#34;anotation&#34;</span> <span class="n">expreesion</span><span class="o">=</span><span class="s">&#34;org.springframework.steretype.Controller&#34;</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">context</span><span class="o">:</span><span class="n">component</span><span class="o">-</span><span class="n">scan</span><span class="o">&gt;</span>
</code></pre></div><h3 id="set-properties-annotation">set properties (annotation)</h3>
<p><a id="markdown-set-properties-annotation" name="set-properties-annotation"></a></p>
<p><strong>1.1 @AotuWired: 根据属性类型进行自动装配</strong></p>
<p><strong>1.2 @Qualifier：根据属性名称进行注入</strong></p>
<p><strong>1.3 @Resource： 可以根据类型注入，可以根据名称注入</strong></p>
<p><strong>1.4 @Value： 注入普通类型属性</strong></p>
<h3 id="steps-annotation">steps (annotation)</h3>
<p><a id="markdown-steps-annotation" name="steps-annotation"></a></p>
<p><strong>1.1 dao and service annotation</strong></p>
<ul>
<li>@Resource (UserDaoImpl)</li>
<li>@Service (UserService)</li>
</ul>
<figure><img src="/images/spring26.png"
         alt="image"/><figcaption>
            <h4>annotation</h4>
        </figcaption>
</figure>

<p><strong>Field injection is not recommended（不再推荐使用字段注入)但是国内的使用场景有时候比国外复杂很多，实际情况，就一个业务单元，国内的公司几轮需求加上来，注入的服务就会牵扯到十几个，用构造器注入，奇丑无比；用传统的分层结构，光数据库 dao 的注入，都是好几个</strong></p>
<p><strong>1.2 dao and service annotation</strong></p>
<ul>
<li>@Resource(name = &ldquo;userDaoImpl1&rdquo;)</li>
<li>@AutoWired + @Qualifier(value = &ldquo;userDaoImpl1&rdquo;)</li>
</ul>
<figure><img src="/images/spring27.png"
         alt="image"/><figcaption>
            <h4>annotation</h4>
        </figcaption>
</figure>

<h3 id="完全注解开发">完全注解开发</h3>
<p><a id="markdown-%E5%AE%8C%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91" name="%E5%AE%8C%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"></a></p>
<p><strong>2.1 comfig class</strong></p>
<figure><img src="/images/spring28.png"
         alt="image"/><figcaption>
            <h4>annotation</h4>
        </figcaption>
</figure>

<p><strong>2.2 test</strong></p>
<figure><img src="/images/spring29.png"
         alt="image"/><figcaption>
            <h4>annotation</h4>
        </figcaption>
</figure>

<h2 id="spring-aop">spring AOP</h2>
<p><a id="markdown-spring-aop" name="spring-aop"></a></p>
<h3 id="spring-aop-1">spring AOP</h3>
<p><a id="markdown-spring-aop" name="spring-aop"></a>
<strong>1.0 面向切面</strong>
<strong>1.1 登录功能</strong></p>
<h3 id="aop-底层原理底层使用动态代理">AOP 底层原理：底层使用动态代理</h3>
<p><a id="markdown-aop-%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%EF%BC%9A%E5%BA%95%E5%B1%82%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86" name="aop-%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%EF%BC%9A%E5%BA%95%E5%B1%82%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"></a></p>
<h3 id="20-有接口使用-jdk-动态代理"><strong>2.0 有接口，使用 JDK 动态代理</strong></h3>
<p><a id="markdown-**2.0-%E6%9C%89%E6%8E%A5%E5%8F%A3%EF%BC%8C%E4%BD%BF%E7%94%A8-jdk-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86**" name="**2.0-%E6%9C%89%E6%8E%A5%E5%8F%A3%EF%BC%8C%E4%BD%BF%E7%94%A8-jdk-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86**"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">UserDao</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">login</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">UserDao</span> <span class="kd">implements</span> <span class="n">UserDao</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">login</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// 登录实现过程
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><ul>
<li>
<p><em><strong>JDK 动态代理</strong></em></p>
<ul>
<li>
<ol>
<li>创建 UserDao 接口实现类代理对象</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>2.1 没有接口，使用 CGLIB 动态代理</strong></p>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span> <span class="o">{</span>
        <span class="err">。。。。</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">Person</span> <span class="kd">extends</span> <span class="n">User</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">add</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><ul>
<li>
<p><em><strong>CGLIB 动态代理</strong></em></p>
<ul>
<li>
<ol>
<li>创建当前子类代理对象</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>2.3 AOP JDK 使用 Proxy 代理对象</strong></p>
</li>
<li>
<p><strong>2.4 使用 newProxyInstance 方法代理对象</strong></p>
<ul>
<li>3 个参数</li>
<li>ClassLoader 类加载器</li>
<li>类&lt;?&gt;[] interface 增加方法所在的类，这个类实现的接口，支持多个接口</li>
<li>InvocationHandler 实现这个接口 InvocationHandler， 创建代理对象，写增加的方法</li>
</ul>
</li>
<li>
<p><strong>2.5 使用 JDK 动态代理代码</strong></p>
</li>
</ul>
<ul>
<li>创建接口， 定义方法</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Userdao</span> <span class="o">{</span>

    <span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">);</span>

    <span class="n">String</span> <span class="nf">update</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">);</span>

<span class="o">}</span>
</code></pre></div><ul>
<li>创建接口实现类, 实现方法</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoImpl</span> <span class="kd">implements</span> <span class="n">Userdao</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;add方法之前执行le&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">update</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;update方法之前执行le&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoImpl</span> <span class="kd">implements</span> <span class="n">Userdao</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">update</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><ul>
<li>使用 Proxy 类创建接口代理对象</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JDKProxy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">Class</span><span class="o">[]</span> <span class="n">interfaces</span> <span class="o">=</span> <span class="o">{</span><span class="n">UserDao</span><span class="o">.</span><span class="na">class</span><span class="o">};</span>

        <span class="n">Proxy</span><span class="o">.</span><span class="na">newProxyInstance</span><span class="o">(</span><span class="n">JDKProxy</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">(),</span> <span class="n">interfaces</span><span class="o">,</span> <span class="k">new</span> <span class="n">InvocationHandler</span><span class="o">()</span> <span class="o">{</span>
           <span class="nd">@Override</span>
           <span class="kd">public</span> <span class="n">Object</span> <span class="nf">invoke</span><span class="o">(</span><span class="n">Object</span> <span class="n">proxy</span><span class="o">,</span> <span class="n">Method</span> <span class="n">method</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
               <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
           <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>
</code></pre></div><p>or</p>
<ol>
<li>创建代理对象代理</li>
</ol>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JDKProxy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">Class</span><span class="o">[]</span> <span class="n">interfaces</span> <span class="o">=</span> <span class="o">{</span><span class="n">UserDao</span><span class="o">.</span><span class="na">class</span><span class="o">};</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">UserDaoProxy</span> <span class="kd">implements</span> <span class="n">InvocationHandler</span> <span class="o">{</span>
      <span class="c1">// 1. 把创建的是谁的代理对象，把谁传递过来
</span><span class="c1"></span>     <span class="c1">// 有参数构造传递
</span><span class="c1"></span>     <span class="kd">private</span> <span class="n">Object</span> <span class="n">obj</span><span class="o">;</span>
     <span class="kd">public</span> <span class="nf">UserDaoProxy</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span>
         <span class="k">this</span><span class="o">.</span><span class="na">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">;</span>
     <span class="o">}</span>
     <span class="c1">// 增加的逻辑
</span><span class="c1"></span>         <span class="c1">// 增加的逻辑
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">invoke</span><span class="o">(</span><span class="n">Object</span> <span class="n">proxy</span><span class="o">,</span> <span class="n">Method</span> <span class="n">method</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span> 
         <span class="c1">// 方法之前
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;方法之前执行..............&#34;</span> <span class="o">+</span> <span class="n">method</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; : 传递的参数&#34;</span> <span class="o">+</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">args</span><span class="o">));</span>
        <span class="n">Object</span> <span class="n">res</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">obj</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;方法之后执行...........&#34;</span> <span class="o">+</span> <span class="n">obj</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>   
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JDKProxy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">Class</span><span class="o">[]</span> <span class="n">interfaces</span> <span class="o">=</span> <span class="o">{</span><span class="n">UserDao</span><span class="o">.</span><span class="na">class</span><span class="o">};</span>

        <span class="n">UserDaoImpl</span> <span class="n">userDao</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserDaoImpl</span><span class="o">();</span>

        <span class="n">UserDao</span> <span class="n">dao</span> <span class="o">=</span> <span class="o">(</span><span class="n">UserDao</span><span class="o">)</span><span class="n">Proxy</span><span class="o">.</span><span class="na">newProxyInstance</span><span class="o">(</span><span class="n">JDKProxy</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">(),</span> <span class="n">interfaces</span><span class="o">,</span> <span class="k">new</span> <span class="n">UserDaoProxy</span><span class="o">(</span><span class="n">userDao</span><span class="o">));</span>

         <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">dao</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">2</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><h3 id="30-aop-操作"><strong>3.0 AOP 操作</strong></h3>
<p><a id="markdown-**3.0-aop-%E6%93%8D%E4%BD%9C**" name="**3.0-aop-%E6%93%8D%E4%BD%9C**"></a></p>
<ul>
<li>
<p>3.1 Spring 框架一般基于 AspectJ 实现 AOP 操作</p>
</li>
<li>
<p>3.2 AOP 相关依赖</p>
</li>
<li>
<p>3.3 切入点表达式</p>
</li>
</ul>
<p>execution([权限修饰符][返回类型][类全路径]<a href="[%e5%8f%82%e6%95%b0%e5%88%97%e8%a1%a8]" >方法名称</a>)</p>
<p>execution([public/private][返回类型/ 忽略][类全路径]<a href="[%e5%8f%82%e6%95%b0%e5%88%97%e8%a1%a8]" >方法名称</a>)</p>
<p><em><strong>ex1: com.learn.dao.BookDao 里面 add 进行增强</strong></em>
execution(*com.learn.dao.BookDao.add(..))</p>
<p><em><strong>ex2: com.learn.dao.BookDao 里面所有的方法进行增强</strong></em>
execution(<em>com.learn.dao.BookDao.</em>(..))</p>
<p><em><strong>ex3: 对 com.learn.dao 包里面所有类，类里面所有的方法进行增强</strong></em>
execution(<em>com.learn.dao.</em>.*(..))</p>
<h3 id="40-aop-aspectj-注解"><strong>4.0 AOP AspectJ 注解</strong></h3>
<p><a id="markdown-**4.0-aop-aspectj-%E6%B3%A8%E8%A7%A3**" name="**4.0-aop-aspectj-%E6%B3%A8%E8%A7%A3**"></a></p>
<ul>
<li>4.1 创建类， 在类里面定义方法</li>
</ul>
<p>被增强类</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;add...........&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><ul>
<li>4.2 创建增强类(编写增强逻辑)
<ul>
<li>在增强类里面，创建方法，让不同方法代表不同通知类型</li>
</ul>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// 增强类
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserProxy</span> <span class="o">{</span>

    <span class="c1">// 前置通知
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before......................&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><ul>
<li>4.3 进行通知的配置
<ul>
<li>在 spring 配置文件中，开启注解扫描</li>
<li>使用注解创建 User 和 UserProxy 对象</li>
</ul>
</li>
</ul>
<figure><img src="/images/spring30.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<figure><img src="/images/spring31.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<figure><img src="/images/spring32.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<ul>
<li>4.4 在增强类上面添加注解 @Aspect</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// 增强类
</span><span class="c1"></span><span class="nd">@Component</span>
<span class="nd">@Aspect</span> <span class="c1">// 生成代理对象
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserProxy</span> <span class="o">{</span>

    <span class="c1">// 前置通知
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before......................&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><ul>
<li>4.5 在 spring 配置文件中开启生成代理对象</li>
</ul>
<figure><img src="/images/spring33.png"
         alt="image"/><figcaption>
            <h4> Spring aop</h4>
        </figcaption>
</figure>

<ul>
<li>
<p>配置不同类型的通知</p>
<ul>
<li>在增强类的里面，在作为通知方法上面添加通知类型注解，使用切入点表达式配置</li>
</ul>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// 增强类
</span><span class="c1"></span><span class="nd">@Component</span>
<span class="nd">@Aspect</span> <span class="c1">// 生成代理对象
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserProxy</span> <span class="o">{</span>

    <span class="c1">// 前置通知
</span><span class="c1"></span>    <span class="c1">// @Before 注解表示作为配置通知
</span><span class="c1"></span>    <span class="nd">@Before</span><span class="o">(</span><span class="s">&#34;execution(*com.learn.aop.User.add(..)&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before......................&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><figure><img src="/images/spring34.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<figure><img src="/images/spring35.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<figure><img src="/images/spring36.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<ul>
<li>4.6 公共切入点抽取</li>
</ul>
<figure><img src="/images/spring37.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<ul>
<li>4.7 有多个增强类多同一个方法进行增强， 设置增强类优先
<ul>
<li>在增强类上面添加注解 @Order(数字类型值)， 小优先级越高</li>
</ul>
</li>
</ul>
<figure><img src="/images/spring38.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<figure><img src="/images/spring39.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<h3 id="50-aop-aspectj-配置文件"><strong>5.0 AOP AspectJ 配置文件</strong></h3>
<p><a id="markdown-**5.0-aop-aspectj-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6**" name="**5.0-aop-aspectj-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6**"></a></p>
<ul>
<li>
<p>5.1 两个类，增强类和被增强类， 创建方法</p>
</li>
<li>
<p>5.2 在 spring 配置文件中创建两个类对象</p>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="o">&lt;</span><span class="n">bean</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;book&#34;</span> <span class="n">class</span><span class="o">=</span><span class="s">&#34;com.learn.aopxml.Book&#34;</span><span class="o">&gt;&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>
    
    <span class="o">&lt;</span><span class="n">bean</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;bookProxy&#34;</span> <span class="n">class</span><span class="o">=</span><span class="s">&#34;com.learn.aopxml.BookProxy&#34;</span><span class="o">&gt;&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>
</code></pre></div><ul>
<li>5.3 在 spring 配置文件中配置切入点</li>
</ul>
<figure><img src="/images/spring40.png"
         alt="image"/><figcaption>
            <h4>Spring aop</h4>
        </figcaption>
</figure>

<h2 id="spring-data-access-jdbc">spring data access: JDBC</h2>
<p><a id="markdown-spring-data-access%3A-jdbc" name="spring-data-access%3A-jdbc"></a></p>
<h3 id="jdbctemplate">JdbcTemplate</h3>
<p><a id="markdown-jdbctemplate" name="jdbctemplate"></a></p>
<h3 id="10-dependency-jar"><strong>1.0 dependency jar</strong></h3>
<p><a id="markdown-**1.0-dependency-jar**" name="**1.0-dependency-jar**"></a></p>
<ul>
<li>
<p>mysql-connector-java (Java 连接 MySQL 需要驱动包，否则 JDBC 无法访问数据库)</p>
</li>
<li>
<p>druid (在 JDBC 访问数据库的时候是通过连接来完成的，但是连接的打开及关闭非常耗时，这时就是数据库连接池的作用了，他来管理这个数据库连接，不会用完立即关闭，可以缓存起来，供下次使用，为 JDBC 连接数据库提供锦上添花的作用，Druid 就是一个数据库连接池，用来管理数据库连接池的)</p>
</li>
<li>
<p>spring-jdbc (Spring JDBC 框架负责所有的低层细节，从开始打开连接，准备和执行
SQL 语句，处理异常，处理事务，到最后关闭连接)</p>
</li>
<li>
<p>spring-tx：为 JDBC、Hibernate、JDO、JPA 等提供的一致的声明式和编程式事务管理</p>
</li>
<li>
<p>spring-orm (ORM 的全称是 Object Relational Mapping，即对象关系映射。它的实现思想就是将关系数据库中表的数据映射成为对象，以对象的形式展现，这样开发人员就可以把对数据库的操作转化为对这些对象的操作。因此它的目的是为了方便开发人员以面向对象的思想来实现对数据库的操作)</p>
</li>
</ul>
<h3 id="20-在-spring-配置文件配置数据库连接池"><strong>2.0 在 spring 配置文件配置数据库连接池</strong></h3>
<p><a id="markdown-**2.0-%E5%9C%A8-spring-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0**" name="**2.0-%E5%9C%A8-spring-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0**"></a></p>
<h3 id="30-配置-jdbctemplate-对象-注入-datasource"><strong>3.0 配置 JdbcTemplate 对象， 注入 DataSource</strong></h3>
<p><a id="markdown-**3.0-%E9%85%8D%E7%BD%AE-jdbctemplate-%E5%AF%B9%E8%B1%A1%EF%BC%8C-%E6%B3%A8%E5%85%A5-datasource**" name="**3.0-%E9%85%8D%E7%BD%AE-jdbctemplate-%E5%AF%B9%E8%B1%A1%EF%BC%8C-%E6%B3%A8%E5%85%A5-datasource**"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="o">&lt;!--</span><span class="n">JdbcTemplate</span> <span class="n">对象</span><span class="o">--&gt;</span>
    <span class="o">&lt;</span><span class="n">bean</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;jdbcTemplate&#34;</span> <span class="n">class</span><span class="o">=</span><span class="s">&#34;org.springframework.jdbc.core.JdbcTemplate&#34;</span><span class="o">&gt;</span>

        <span class="o">&lt;!--</span><span class="n">set方法注入dataSource</span><span class="o">--&gt;</span>
        <span class="o">&lt;</span><span class="n">property</span> <span class="n">name</span><span class="o">=</span><span class="s">&#34;dataSource&#34;</span> <span class="n">ref</span><span class="o">=</span><span class="s">&#34;dataSource&#34;</span><span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>

</code></pre></div><h3 id="40-创建-service-类创建-dao-类在-dao-注入-jdbctemplate-对象"><strong>4.0 创建 service 类，创建 dao 类，在 dao 注入 jdbcTemplate 对象</strong></h3>
<p><a id="markdown-**4.0-%E5%88%9B%E5%BB%BA-service-%E7%B1%BB%EF%BC%8C%E5%88%9B%E5%BB%BA-dao-%E7%B1%BB%EF%BC%8C%E5%9C%A8-dao-%E6%B3%A8%E5%85%A5-jdbctemplate-%E5%AF%B9%E8%B1%A1**" name="**4.0-%E5%88%9B%E5%BB%BA-service-%E7%B1%BB%EF%BC%8C%E5%88%9B%E5%BB%BA-dao-%E7%B1%BB%EF%BC%8C%E5%9C%A8-dao-%E6%B3%A8%E5%85%A5-jdbctemplate-%E5%AF%B9%E8%B1%A1**"></a></p>
<ul>
<li>4.1 开启组件扫描</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">
<span class="o">&lt;!--</span><span class="n">4</span><span class="o">.</span><span class="na">1</span> <span class="n">开启组件扫描</span><span class="o">--&gt;</span>
    <span class="o">&lt;</span><span class="n">context</span><span class="o">:</span><span class="n">component</span><span class="o">-</span><span class="n">scan</span> <span class="n">base</span><span class="o">-</span><span class="n">package</span><span class="o">=</span><span class="s">&#34;com.learn&#34;</span><span class="o">/&gt;</span>
</code></pre></div><ul>
<li>4.2 Service 类</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookService</span> <span class="o">{</span>

    <span class="c1">// 注入dao
</span><span class="c1"></span>    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">BookDao</span> <span class="n">bookDao</span> <span class="o">;</span>
<span class="o">}</span>
</code></pre></div><ul>
<li>4.3 Dao 类</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookDaoImpl</span> <span class="kd">implements</span> <span class="n">BookDao</span><span class="o">{</span>

    <span class="c1">// 注入jdbcTemplate
</span><span class="c1"></span>    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>
<span class="o">}</span>

</code></pre></div><h2 id="jdbctemplate-操作数据库添加功能">JdbcTemplate 操作数据库，添加功能</h2>
<p><a id="markdown-jdbctemplate-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD" name="jdbctemplate-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD"></a></p>
<h3 id="10-对应数据库实体类"><strong>1.0 对应数据库实体类</strong></h3>
<p><a id="markdown-**1.0-%E5%AF%B9%E5%BA%94%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E4%BD%93%E7%B1%BB**" name="**1.0-%E5%AF%B9%E5%BA%94%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E4%BD%93%E7%B1%BB**"></a></p>
<h3 id="20-编写-service-和-dao"><strong>2.0 编写 service 和 dao</strong></h3>
<p><a id="markdown-**2.0-%E7%BC%96%E5%86%99-service-%E5%92%8C-dao**" name="**2.0-%E7%BC%96%E5%86%99-service-%E5%92%8C-dao**"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BookDaoImpl</span> <span class="kd">implements</span> <span class="n">BookDao</span><span class="o">{</span>

    <span class="c1">// 注入jdbcTemplate
</span><span class="c1"></span>    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>

    <span class="c1">// 添加的方法
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Book</span> <span class="n">book</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 1. 创建 sql 语句
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into t_book values(?, ?, ?)&#34;</span><span class="o">;</span>
        <span class="c1">// 2. 调用方法实现
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">update</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">book</span><span class="o">.</span><span class="na">getUserId</span><span class="o">(),</span> <span class="n">book</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">book</span><span class="o">.</span><span class="na">getUstatus</span><span class="o">());</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">update</span><span class="o">);</span>
    <span class="o">}</span>
       
    <span class="c1">// 删除的方法
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">del</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 1. 创建 sql 语句
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;delete from t_book where user_id=?&#34;</span><span class="o">;</span>
        <span class="c1">// 2. 调用方法实现
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">update</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">update</span><span class="o">);</span>
    <span class="o">}</span>
           <span class="c1">// 更新的方法
</span><span class="c1"></span>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="n">Book</span> <span class="n">book</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 1. 创建 sql 语句
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update t_book set username=?, ustatus=? where user_id=?&#34;</span><span class="o">;</span>
        <span class="c1">// 2. 调用方法实现
</span><span class="c1"></span>       <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="o">{</span><span class="n">book</span><span class="o">.</span><span class="na">getUserId</span><span class="o">(),</span> <span class="n">book</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">book</span><span class="o">.</span><span class="na">getUstatus</span><span class="o">()};</span>
        <span class="kt">int</span> <span class="n">update</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">update</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>


</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testAdd</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean1.xml&#34;</span><span class="o">);</span>
        <span class="n">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;bookService&#34;</span><span class="o">,</span> <span class="n">BookService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">Book</span> <span class="n">book</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Book</span><span class="o">();</span>
        <span class="n">book</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="s">&#34;2&#34;</span><span class="o">);</span>
        <span class="n">book</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&#34;bb&#34;</span><span class="o">);</span>
        <span class="n">book</span><span class="o">.</span><span class="na">setUstatus</span><span class="o">(</span><span class="s">&#34;b&#34;</span><span class="o">);</span>
        <span class="n">bookService</span><span class="o">.</span><span class="na">addBook</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div><h3 id="jdbctemplate-操作数据库查询">JdbcTemplate 操作数据库，查询</h3>
<p><a id="markdown-jdbctemplate-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E6%9F%A5%E8%AF%A2" name="jdbctemplate-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E6%9F%A5%E8%AF%A2"></a></p>
<h3 id="查询表有多少条记录"><strong>查询表有多少条记录</strong></h3>
<p><a id="markdown-**%E6%9F%A5%E8%AF%A2%E8%A1%A8%E6%9C%89%E5%A4%9A%E5%B0%91%E6%9D%A1%E8%AE%B0%E5%BD%95**" name="**%E6%9F%A5%E8%AF%A2%E8%A1%A8%E6%9C%89%E5%A4%9A%E5%B0%91%E6%9D%A1%E8%AE%B0%E5%BD%95**"></a></p>
<ul>
<li>SELECT COUNT(*) FROM t_book</li>
</ul>
<h3 id="查询返回某个值"><strong>查询返回某个值</strong></h3>
<p><a id="markdown-**%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E6%9F%90%E4%B8%AA%E5%80%BC**" name="**%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E6%9F%90%E4%B8%AA%E5%80%BC**"></a></p>
<ul>
<li><em><strong>1. 查询表有多少条记录， 返回某个值</strong></em></li>
<li><em><strong>2. 使用 JdbcTemplate 查询表有多少条记录， 返回某个值</strong></em>
<ul>
<li><em><strong>queryForObject(String sql, Class<T> requireType)</strong></em></li>
<li><em><strong>第一个参数 sql 语句</strong></em></li>
<li><em><strong>第二个参数， 返回类性 Class（Integer.class, String.class)</strong></em></li>
</ul>
</li>
<li><em><strong>3. daoImpl</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">selectCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select count(*) from t_book&#34;</span><span class="o">;</span>
        <span class="n">Integer</span> <span class="n">count</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">queryForObject</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div><h3 id="查询返回对象"><strong>查询返回对象</strong></h3>
<p><a id="markdown-**%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1**" name="**%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1**"></a></p>
<ul>
<li><em><strong>1. 场景： 查询图书详情</strong></em></li>
<li><em><strong>2. 使用 JdbcTemplate 查询返回对象</strong></em>
<ul>
<li><em><strong>queryForObject(String sql, RowMappper<T> rowMapper, Object&hellip; args)</strong></em></li>
<li><em><strong>第一个参数 sql（select * from t_book where user_id=?）语句</strong></em></li>
<li><em><strong>第二个参数: RowMapper， 是接口， 返回不同类型数据，使用这个接口里面实现类完成数据封装 new BeanPropertyRowMapper<Book>(Book.class)</strong></em></li>
<li><em><strong>第三个参数: sql 语句值（问号里面的值 id）</strong></em></li>
</ul>
</li>
<li><em><strong>3. daoImpl</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">   <span class="kd">public</span> <span class="n">Book</span> <span class="nf">findBookInfo</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from t_book where user_id=?&#34;</span><span class="o">;</span>
        <span class="n">Book</span> <span class="n">book</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">queryForObject</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="k">new</span> <span class="n">BeanPropertyRowMapper</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;(</span><span class="n">Book</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="n">id</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">book</span><span class="o">;</span>
    <span class="o">}</span>

</code></pre></div><h3 id="查询返回集合"><strong>查询返回集合</strong></h3>
<p><a id="markdown-**%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E9%9B%86%E5%90%88**" name="**%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E9%9B%86%E5%90%88**"></a></p>
<ul>
<li><em><strong>1. 场景： 查询图书列表分页</strong></em></li>
<li><em><strong>2. 使用 JdbcTemplate 查询返回集合</strong></em>
<ul>
<li><em><strong>query(String sql, RowMappper<T> rowMapper, Object&hellip; args)</strong></em></li>
<li><em><strong>第一个参数 sql 语句</strong></em></li>
<li><em><strong>第二个参数: RowMapper， 是接口， 返回不同类型数据，使用这个接口里面实现类完成数据封装 new BeanPropertyRowMapper<Book>(Book.class)</strong></em></li>
<li><em><strong>第三个参数: 可以省略</strong></em></li>
</ul>
</li>
<li><em><strong>3. daoImpl</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select * from t_book&#34;</span><span class="o">;</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;</span> <span class="n">bookList</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="k">new</span> <span class="n">BeanPropertyRowMapper</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;(</span><span class="n">Book</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
        <span class="k">return</span> <span class="n">bookList</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div><h3 id="批量增加操作"><strong>批量增加操作</strong></h3>
<p><a id="markdown-**%E6%89%B9%E9%87%8F%E5%A2%9E%E5%8A%A0%E6%93%8D%E4%BD%9C**" name="**%E6%89%B9%E9%87%8F%E5%A2%9E%E5%8A%A0%E6%93%8D%E4%BD%9C**"></a></p>
<ul>
<li><em><strong>1. 场景： 批量操作，比如操作表里面多条记录</strong></em></li>
<li><em><strong>2. 使用 JdbcTemplate 查询返回集合</strong></em>
<ul>
<li><em><strong>batchUpdate(String sql, List&lt;Object[]&gt; batchArgs)</strong></em></li>
<li><em><strong>第一个参数 sql 语句</strong></em></li>
<li><em><strong>第二个参数: List 集合</strong></em></li>
</ul>
</li>
<li><em><strong>3. daoImpl</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">  <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">batchAddBook</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into t_book values(?, ?, ?)&#34;</span><span class="o">;</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">ints</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">batchUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">batchArgs</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ints</span><span class="o">);</span>
         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ints</span><span class="o">));</span>

    <span class="o">}</span>
</code></pre></div><ul>
<li><em><strong>4. test</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test3</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean1.xml&#34;</span><span class="o">);</span>
        <span class="n">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;bookService&#34;</span><span class="o">,</span> <span class="n">BookService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o1</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;6&#34;</span><span class="o">,</span> <span class="s">&#34;hava&#34;</span><span class="o">,</span> <span class="s">&#34;w&#34;</span><span class="o">};</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o2</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;7&#34;</span><span class="o">,</span> <span class="s">&#34;gwe&#34;</span><span class="o">,</span> <span class="s">&#34;we&#34;</span><span class="o">};</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o3</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;8&#34;</span><span class="o">,</span> <span class="s">&#34;cge&#34;</span><span class="o">,</span> <span class="s">&#34;h&#34;</span><span class="o">};</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o1</span><span class="o">);</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o2</span><span class="o">);</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o3</span><span class="o">);</span>
        <span class="n">bookService</span><span class="o">.</span><span class="na">batchAdd</span><span class="o">(</span><span class="n">batchArgs</span><span class="o">);</span>
</code></pre></div><h3 id="批量修改操作"><strong>批量修改操作</strong></h3>
<p><a id="markdown-**%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C**" name="**%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C**"></a></p>
<ul>
<li><em><strong>1. 场景： 批量操作，比如操作表里面多条记录</strong></em></li>
<li><em><strong>2. 使用 JdbcTemplate 查询返回集合</strong></em>
<ul>
<li><em><strong>batchUpdate(String sql, List&lt;Object[]&gt; batchArgs)</strong></em></li>
<li><em><strong>第一个参数 sql 语句</strong></em></li>
<li><em><strong>第二个参数: List 集合</strong></em></li>
</ul>
</li>
<li><em><strong>3. daoImpl</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">batchUpdateBook</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;update t_book set user_name=?, ustatus=? where user_id=?&#34;</span><span class="o">;</span>
         <span class="kt">int</span><span class="o">[]</span> <span class="n">ints</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">batchUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">batchArgs</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ints</span><span class="o">));</span>

    <span class="o">}</span>
</code></pre></div><ul>
<li><em><strong>4. test</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test3</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean1.xml&#34;</span><span class="o">);</span>
        <span class="n">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;bookService&#34;</span><span class="o">,</span> <span class="n">BookService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="c1">// Object[] o1 = {&#34;6&#34;, &#34;hava&#34;, &#34;w&#34;};
</span><span class="c1"></span>        <span class="c1">// Object[] o2 = {&#34;7&#34;, &#34;gwe&#34;, &#34;we&#34;};
</span><span class="c1"></span>        <span class="c1">// Object[] o3 = {&#34;8&#34;, &#34;cge&#34;, &#34;h&#34;};
</span><span class="c1"></span>        <span class="c1">// update t_book set user_name=?, ustatus=? where user_id=? id放最后
</span><span class="c1"></span>        <span class="n">Object</span><span class="o">[]</span> <span class="n">o1</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&#34;hava001&#34;</span><span class="o">,</span> <span class="s">&#34;w&#34;</span><span class="o">,</span><span class="s">&#34;6&#34;</span><span class="o">,};</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o2</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&#34;hava002&#34;</span><span class="o">,</span> <span class="s">&#34;w&#34;</span><span class="o">,</span><span class="s">&#34;7&#34;</span><span class="o">,};</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o3</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&#34;hava003&#34;</span><span class="o">,</span> <span class="s">&#34;w&#34;</span><span class="o">,</span><span class="s">&#34;8&#34;</span><span class="o">,};</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o1</span><span class="o">);</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o2</span><span class="o">);</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o3</span><span class="o">);</span>
        <span class="n">bookService</span><span class="o">.</span><span class="na">batchAdd</span><span class="o">(</span><span class="n">batchArgs</span><span class="o">);</span>
</code></pre></div><h3 id="批量删除操作"><strong>批量删除操作</strong></h3>
<p><a id="markdown-**%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C**" name="**%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C**"></a></p>
<ul>
<li><em><strong>1. 场景： 批量操作，比如操作表里面多条记录</strong></em></li>
<li><em><strong>2. 使用 JdbcTemplate 查询返回集合</strong></em>
<ul>
<li><em><strong>batchUpdate(String sql, List&lt;Object[]&gt; batchArgs)</strong></em></li>
<li><em><strong>第一个参数 sql 语句</strong></em></li>
<li><em><strong>第二个参数: List 集合</strong></em></li>
</ul>
</li>
<li><em><strong>3. daoImpl</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">batchDeleteBook</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;delete from t_book  where user_id=?&#34;</span><span class="o">;</span>
        <span class="kt">int</span><span class="o">[]</span> <span class="n">ints</span> <span class="o">=</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">batchUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="n">batchArgs</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">ints</span><span class="o">));</span>
    <span class="o">}</span>
</code></pre></div><ul>
<li><em><strong>4. test</strong></em></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test3</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">ApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;bean1.xml&#34;</span><span class="o">);</span>
        <span class="n">BookService</span> <span class="n">bookService</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;bookService&#34;</span><span class="o">,</span> <span class="n">BookService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="n">batchArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o1</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&#34;6&#34;</span><span class="o">};</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o2</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&#34;7&#34;</span><span class="o">};</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o1</span><span class="o">);</span>
        <span class="n">batchArgs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">o2</span><span class="o">);</span>
        <span class="n">bookService</span><span class="o">.</span><span class="na">batchDelate</span><span class="o">(</span><span class="n">batchArgs</span><span class="o">);</span>
</code></pre></div><hr>
<h4 id="ok-its-time-for-spring1-hahahugoshortcode-s16-hbhb">Ok, It&rsquo;s time for <a href="https://rileyshen.github.io/post/spring1/" >spring1 </a></h4>
<p><a id="markdown-ok%2C-it's-time-for-spring1" name="ok%2C-it's-time-for-spring1"></a></p>
<h4 id="ok-its-time-for-spring2-hahahugoshortcode-s17-hbhb">Ok, It&rsquo;s time for <a href="https://rileyshen.github.io/post/spring2/" >spring2 </a></h4>
<p><a id="markdown-ok%2C-it's-time-for-spring2" name="ok%2C-it's-time-for-spring2"></a></p>
<h4 id="ok-its-time-for-spring-mvchahahugoshortcode-s18-hbhb">Ok, It&rsquo;s time for <a href="https://rileyshen.github.io/post/springmvc/" >spring mvc</a></h4>
<p><a id="markdown-ok%2C-it's-time-for-spring-mvc" name="ok%2C-it's-time-for-spring-mvc"></a></p></div>
    <div class="post-footer">
        <div class="info">
            
            <span class="separator"><a class="tag" href="/tags/crud/">CRUD</a><a class="tag" href="/tags/ioc/">IOC</a><a class="tag" href="/tags/aop/">AOP</a><a class="tag" href="/tags/spring5/">Spring5</a></span>
        </div>
    </div>

    
</div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script>
<script async defer src="//latest.js"></script>
<noscript><img src="//noscript.gif" alt=""/></noscript>

</body>

</html>
