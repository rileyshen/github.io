<!DOCTYPE html>
<html  dir="ltr" lang="en" data-theme=""><head>
    <title> Riley Shen | java web project--learning through building 5 </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description"
        content="a full-stack web application for users to understand java web system">
    <meta name="google-site-verification" content="Nac1UrFTdr1E1F48JLe7XQhIbKn2_WtF4VnJI8KOtew" />
    

    
    
    
    <link rel="stylesheet" href="/css/main.min.a7c9793b97840076bef76d2743ee1c90b13bd21c18674076a0cccd5dd54c723b.css" integrity="sha256-p8l5O5eEAHa&#43;920nQ&#43;4ckLE70hwYZ0B2oMzNXdVMcjs="
        crossorigin="anonymous" type="text/css">
    
    
    <link rel="stylesheet" href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4=" crossorigin="anonymous" type="text/css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />

    
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">

    <link rel="canonical" href="/post/javaweb5/">

    <link rel="preconnect" href="https://fonts.gstatic.com">



    
    
    
    
    <script type="text/javascript" src="/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js"
        integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin="anonymous"></script>


    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rileyshen.github.io/images/site-feature-image.png"/>

<meta name="twitter:title" content="java web project--learning through building 5"/>
<meta name="twitter:description" content="a full-stack web application for users to understand java web system"/>


    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,500;1,600;1,700&display=swap"
        rel="stylesheet">

</head><body><div class="sidebar animated fadeInDown ">
    <div class="logo-title">
        <div class="title">
            <img src="/images/profileS.jpg" alt="profile picture">
            <h3 title=""><a href="/">I&#39;m Riley Shen</a></h3>
            <div class="description">
                <p><br>Riley likes to push her limits <br>and always keep learning new things. <br>She shares her weekly learnings <br>because "if you can't explain it simply,<br>it means you didn't understand it well enough".<br></p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="mailto:ripple.shen31@gmail.com" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/rileyshen" rel="me" aria-label="GitHub">
                    <i class="fab fa-github fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy;  Riley Shen 2022 </div>
    </div>
</div>
<div class="main">
    <div class="page-top  animated fadeInDown ">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/post/"
                        
                   title="">Posts</a></li>
        
            
            <li><a 
                   href="/about/"
                        
                   title="">About Me</a></li>
        
            
            <li><a 
                   href="/contact/"
                        
                   title="">Contact</a></li>
        
        
        
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
<div class="post  animated fadeInDown ">
    <div class="post-content">
        
        <div class="post-title">
            <h2>java web project--learning through building 5</h2>
            
            <div class="info">
                <em class="fas fa-calendar-day"></em>
                <span class="date">
                    Tue, Jan 12, 2021
                    </span>
                <em class="fas fa-stopwatch"></em>
                <span class="reading-time">8-minute read</span>
            </div>
            
        </div>

        <p>a full-stack web application for users to understand java web system</p>
<!-- TOC -->
<ul>
<li><a href="#qqzone-%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82" >QQZone 业务需求</a>
<ul>
<li><a href="#%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82" >业务需求</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1" >数据库设计</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%8C%83%E5%BC%8F" >数据库的范式</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9A%84%E8%8C%83%E5%BC%8F%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E5%BE%88%E5%A4%9A%E6%97%B6%E5%80%99%E6%98%AF%E7%9B%B8%E6%82%96%E7%9A%84%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E6%A0%B9%E6%8D%AE%E5%AE%9E%E9%99%85%E7%9A%84%E4%B8%9A%E5%8A%A1%E6%83%85%E5%86%B5%E5%81%9A%E4%B8%80%E4%B8%AA%E9%80%89%E6%8B%A9" >数据库设计的范式和数据库的查询性能很多时候是相悖的，我们需要根据实际的业务情况做一个选择</a></li>
</ul>
</li>
<li><a href="#step1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1" >step1. 数据库设计</a></li>
<li><a href="#step2-pojo" >step2. pojo</a></li>
<li><a href="#step3-myssm" >step3. myssm</a></li>
<li><a href="#step4-dao" >step4. DAO</a>
<ul>
<li><a href="#applicationxml-after-dao" >application.xml after DAO</a></li>
</ul>
</li>
<li><a href="#step5-service" >step5. SERVICE</a>
<ul>
<li><a href="#applicationxml-after-service" >application.xml after service</a></li>
</ul>
</li>
<li><a href="#step6-controller" >step6. CONTROLLER</a>
<ul>
<li><a href="#applicationxml-after-controller" >application.xml after controller</a></li>
<li><a href="#artifact-qqwar-exploded-error-during-artifact-deployment-see-server-log-for-details" >Artifact qq:war exploded: Error during artifact deployment. See server log for details</a></li>
<li><a href="#nosuchfiledexception-fid" >NoSuchFiledException-fid</a></li>
<li><a href="#can-not-set-comlearnqqzonepojouserbasic-field-comlearnqqzonepojotopicauthor-to-javalanginteger" >Can not set com.learn.qqzone.pojo.UserBasic field com.learn.qqzone.pojo.Topic.author to java.lang.Integer</a></li>
<li><a href="#%E6%B1%87%E6%80%BB" >汇总</a></li>
</ul>
</li>
<li><a href="#%E6%B1%87%E6%80%BB" >汇总</a>
<ul>
<li><a href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B9%8B%E9%97%B4%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96" >日期和字符串之间的格式化</a></li>
<li><a href="#thymeleaf-%E4%B8%AD%E4%BD%BF%E7%94%A8dates-%E8%BF%99%E4%B8%AA%E5%85%AC%E5%85%B1%E7%9A%84%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1" >thymeleaf 中使用#dates 这个公共的内置对象</a></li>
<li><a href="#%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%97%B6%E6%88%91%E4%BB%AC%E8%AE%BF%E9%97%AE%E7%9A%84%E9%A1%B5%E9%9D%A2%E6%98%AF-httplocalhost8080pro23pagedooperatepagepagelogin" >系统启动时，我们访问的页面是： http://localhost:8080/pro23/page.do?operate=page&amp;amp;page=login</a></li>
<li><a href="#httplocalhost8080pro23pagedooperatepagepagelogin-%E8%AE%BF%E9%97%AE%E8%BF%99%E4%B8%AA-url%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84" >http://localhost:8080/pro23/page.do?operate=page&amp;amp;page=login 访问这个 URL，执行的过程是什么样的</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h3 id="qqzone-业务需求">QQZone 业务需求</h3>
<p><a id="markdown-qqzone-%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82" name="qqzone-%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82"></a></p>
<h4 id="业务需求">业务需求</h4>
<p><a id="markdown-%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82" name="%E4%B8%9A%E5%8A%A1%E9%9C%80%E6%B1%82"></a></p>
<ul>
<li>
<ol>
<li>用户登录</li>
</ol>
</li>
<li>
<ol start="2">
<li>登录成功，显示主界面。左侧显示好友列表；上端显示欢迎词。如果不是自己的空间，显示超链接：返回自己的空间；下端显示日志列表</li>
</ol>
</li>
<li>
<ol start="3">
<li>查看日志详情：
<ul>
<li>日志本身的信息（作者头像、昵称、日志标题、日志内容、日志的日期）</li>
<li>回复列表（回复者的头像、昵称、回复内容、回复日期）</li>
<li>主人回复信息</li>
</ul>
</li>
</ol>
</li>
<li>
<ol start="4">
<li>删除日志</li>
</ol>
</li>
<li>
<ol start="5">
<li>删除特定回复</li>
</ol>
</li>
<li>
<ol start="6">
<li>删除特定主人回复</li>
</ol>
</li>
<li>
<ol start="7">
<li>添加日志、添加回复、添加主人回复</li>
</ol>
</li>
<li>
<ol start="8">
<li>点击左侧好友链接，进入好友的空间</li>
</ol>
</li>
</ul>
<h4 id="数据库设计">数据库设计</h4>
<p><a id="markdown-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1" name="%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"></a></p>
<ul>
<li>
<ol>
<li>抽取实体 : 用户登录信息、用户详情信息 、 日志 、 回贴  、 主人回复</li>
</ol>
</li>
<li>
<ol start="2">
<li>分析其中的属性：</li>
</ol>
<ul>
<li>用户登录信息：账号、密码、头像、昵称</li>
<li>用户详情信息：真实姓名、星座、血型、邮箱、手机号</li>
<li>日志：标题、内容、日期、作者</li>
<li>回复：内容、日期、作者、日志</li>
<li>主人回复：内容、日期、作者、回复</li>
</ul>
</li>
</ul>
<figure><img src="/images/jwb14.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<ul>
<li>
<ol start="3">
<li>分析实体之间的关系</li>
</ol>
<ul>
<li>用户登录信息 ： 用户详情信息      1：1 PK</li>
<li>用户 ： 日志                   1：N</li>
<li>日志 ： 回复                   1：N</li>
<li>回复 ： 主人回复                1：1 UK</li>
<li>用户 ： 好友                   M ： N</li>
</ul>
</li>
</ul>
<h4 id="数据库的范式">数据库的范式</h4>
<p><a id="markdown-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%8C%83%E5%BC%8F" name="%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%8C%83%E5%BC%8F"></a></p>
<ul>
<li>
<ol>
<li>第一范式：列不可再分 (地址就不能是，因为可分)</li>
</ol>
</li>
<li>
<ol start="2">
<li>第二范式：一张表只表达一层含义（只描述一件事情）</li>
</ol>
</li>
<li>
<ol start="3">
<li>第三范式：表中的每一列和主键都是直接依赖关系，而不是间接依赖</li>
</ol>
</li>
</ul>
<h4 id="数据库设计的范式和数据库的查询性能很多时候是相悖的我们需要根据实际的业务情况做一个选择">数据库设计的范式和数据库的查询性能很多时候是相悖的，我们需要根据实际的业务情况做一个选择</h4>
<p><a id="markdown-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9A%84%E8%8C%83%E5%BC%8F%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E5%BE%88%E5%A4%9A%E6%97%B6%E5%80%99%E6%98%AF%E7%9B%B8%E6%82%96%E7%9A%84%EF%BC%8C%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E6%A0%B9%E6%8D%AE%E5%AE%9E%E9%99%85%E7%9A%84%E4%B8%9A%E5%8A%A1%E6%83%85%E5%86%B5%E5%81%9A%E4%B8%80%E4%B8%AA%E9%80%89%E6%8B%A9" name="%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9A%84%E8%8C%83%E5%BC%8F%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E5%BE%88%E5%A4%9A%E6%97%B6%E5%80%99%E6%98%AF%E7%9B%B8%E6%82%96%E7%9A%84%EF%BC%8C%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E6%A0%B9%E6%8D%AE%E5%AE%9E%E9%99%85%E7%9A%84%E4%B8%9A%E5%8A%A1%E6%83%85%E5%86%B5%E5%81%9A%E4%B8%80%E4%B8%AA%E9%80%89%E6%8B%A9"></a></p>
<ul>
<li>查询频次不高的情况下，我们更倾向于提高数据库的设计范式，从而提高存储效率</li>
<li>查询频次较高的情形，我们更倾向于牺牲数据库的规范度，降低数据库设计的范式，允许特定的冗余，从而提高查询的性能</li>
</ul>
<h3 id="step1-数据库设计">step1. 数据库设计</h3>
<p><a id="markdown-step1.-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1" name="step1.-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"></a></p>
<ul>
<li>
<p>数据库主键最好不要跟业务有关，比如主键设计为学生学号，但是将来学校合并等，主键就比较麻烦</p>
</li>
<li>
<p><strong>多对多关联会产生中间的第三张表</strong></p>
</li>
</ul>
<p>一号用户好友是二号，1 号用户好友是 3 号</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">id</span><span class="w">  </span><span class="n">uid</span><span class="w"> </span><span class="n">fid</span><span class="w">
</span><span class="w"></span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">
</span><span class="w"></span><span class="mi">2</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="o">`</span><span class="n">qqzonedb2</span><span class="o">`</span><span class="w"> </span><span class="nb">CHAR</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">USE</span><span class="w"> </span><span class="n">qqzonedb2</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">t_friend</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">uid</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">fid</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">FK_friend_basic_uid</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">uid</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">FK_friend_basic_fid</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">fid</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_friend_basic_fid</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">fid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_friend_basic_uid</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">uid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">11</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Data for the table `t_friend` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w">  </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">t_friend</span><span class="o">`</span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">uid</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">fid</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Table structure for table `t_host_reply` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">t_host_reply</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">content</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">hostReplyDate</span><span class="o">`</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">reply</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">FK_host_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">FK_host_reply</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">reply</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_host_basic</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_host_reply</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">reply</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_reply</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Data for the table `t_host_reply` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Table structure for table `t_reply` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">t_reply</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">content</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">replyDate</span><span class="o">`</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">topic</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">FK_reply_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">FK_reply_topic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">topic</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_reply_basic</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_reply_topic</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">topic</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_topic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">6</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Data for the table `t_reply` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w">  </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">t_reply</span><span class="o">`</span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">content</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">replyDate</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">topic</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;回复&#39;</span><span class="p">,</span><span class="s1">&#39;2021-07-14 16:16:54&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;回复2222&#39;</span><span class="p">,</span><span class="s1">&#39;2021-07-14 16:17:11&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;这里是第三个回复&#39;</span><span class="p">,</span><span class="s1">&#39;2021-07-14 16:30:49&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Table structure for table `t_topic` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">t_topic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">title</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">content</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">topicDate</span><span class="o">`</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">FK_topic_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_topic_basic</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">9</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Data for the table `t_topic` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w">  </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">t_topic</span><span class="o">`</span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">title</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">content</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">topicDate</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">author</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;我的空间开通了，先做自我介绍！&#39;</span><span class="p">,</span><span class="s1">&#39;大家好，我是铁锤妹妹！&#39;</span><span class="p">,</span><span class="s1">&#39;2021-06-18 11:25:30&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;我的空间&#39;</span><span class="p">,</span><span class="s1">&#39;我的空间&#39;</span><span class="p">,</span><span class="s1">&#39;2021-07-14 16:16:40&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Table structure for table `t_user_basic` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">loginId</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">nickName</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">pwd</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">headImg</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">loginId</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">loginId</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">6</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Data for the table `t_user_basic` */
</span><span class="c1"></span><span class="w">
</span><span class="w"> </span><span class="k">INSERT</span><span class="w">  </span><span class="k">INTO</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">loginId</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">nickName</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">pwd</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">headImg</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;u001&#39;</span><span class="p">,</span><span class="s1">&#39;jim&#39;</span><span class="p">,</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span><span class="s1">&#39;h1.jpeg&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;u002&#39;</span><span class="p">,</span><span class="s1">&#39;tom&#39;</span><span class="p">,</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span><span class="s1">&#39;h2.jpeg&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;u003&#39;</span><span class="p">,</span><span class="s1">&#39;kate&#39;</span><span class="p">,</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span><span class="s1">&#39;h3.jpeg&#39;</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;u004&#39;</span><span class="p">,</span><span class="s1">&#39;lucy&#39;</span><span class="p">,</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span><span class="s1">&#39;h4.jpeg&#39;</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;u005&#39;</span><span class="p">,</span><span class="s1">&#39;张三丰&#39;</span><span class="p">,</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span><span class="s1">&#39;h5.jpeg&#39;</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Table structure for table `t_user_detail` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_detail</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">realName</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">tel</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">email</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">birth</span><span class="o">`</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="o">`</span><span class="n">star</span><span class="o">`</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span><span class="w">
</span><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">FK_detail_basic</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">t_user_basic</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">INNODB</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- /*Data for the table `t_user_detail` */
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="c1">-- /*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
</span><span class="c1">-- /*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
</span><span class="c1">-- /*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
</span><span class="c1"></span><span class="w">
</span></code></pre></div><h3 id="step2-pojo">step2. pojo</h3>
<p><a id="markdown-step2.-pojo" name="step2.-pojo"></a></p>
<p><strong>根据数据库的 5 张表创建 5 个实体</strong></p>
<p><strong>先写完表格对应的参数后，思考彼此之间的关系</strong></p>
<ul>
<li>UserBasic</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">loginId</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">nickName</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">pwd</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">headImg</span> <span class="o">;</span>

<span class="c1">// 写完基本情况后思考彼此关系：
</span><span class="c1">// UserBasic需要有UserDetail，查询用户详情
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">UserDetail</span> <span class="n">userDetail</span><span class="o">;</span> <span class="c1">// 1对1
</span><span class="c1">// 1个用户会拥有多个日志
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Topic</span><span class="o">&gt;</span> <span class="n">topicList</span><span class="o">;</span> <span class="c1">// 1对多
</span><span class="c1">// 1个用户会拥有多个好友
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="n">friendList</span><span class="o">;</span> <span class="c1">// 多对多
</span></code></pre></div><ul>
<li>UserDetail
(Data 这里 
父类： java.util.Date 年月日时分秒毫秒)
子类：java.sql.Date 年月日
子类：java.sql.Time 时分秒）</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">realName</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">tel</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">birth</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">star</span> <span class="o">;</span>
</code></pre></div><ul>
<li>Reply</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">     <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">content</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">replyDate</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">UserBasic</span> <span class="n">author</span> <span class="o">;</span>  <span class="c1">//M:1
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">Topic</span> <span class="n">topic</span> <span class="o">;</span>       <span class="c1">//M:1
</span><span class="c1"></span>
    <span class="kd">private</span> <span class="n">HostReply</span> <span class="n">hostReply</span><span class="o">;</span> <span class="c1">// 1 : 1
</span><span class="c1"></span>   
</code></pre></div><ul>
<li>Topic</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Topic</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">content</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">topicDate</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">UserBasic</span> <span class="n">author</span> <span class="o">;</span> <span class="c1">// 多对1
</span><span class="c1">// 写完基本情况后思考彼此关系：
</span><span class="c1">// 一个日志中会有多个reply
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Reply</span><span class="o">&gt;</span> <span class="n">replyList</span><span class="o">;</span> <span class="c1">// 1对多
</span></code></pre></div><ul>
<li>HostReply</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"> <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">content</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">hostReplyDate</span> <span class="o">;</span>
    <span class="kd">private</span> <span class="n">UserBasic</span> <span class="n">author</span> <span class="o">;</span> <span class="c1">//M:1
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">Reply</span> <span class="n">reply</span> <span class="o">;</span>   <span class="c1">//1:1
</span><span class="c1"></span>
<span class="o">}</span>
</code></pre></div><h3 id="step3-myssm">step3. myssm</h3>
<p><a id="markdown-step3.-myssm" name="step3.-myssm"></a></p>
<p><strong>包含 util， baseDAO 等文件</strong></p>
<p>目前我们进行 javaweb 项目开发的“套路”是这样的：</p>
<ol>
<li>
<p>拷贝 myssm 包</p>
</li>
<li>
<p>新建配置文件 applicationContext.xml 或者可以不叫这个名字，在 web.xml 中指定文件名</p>
</li>
<li>
<p>在 web.xml 文件中配置：</p>
<ol>
<li>配置前缀和后缀，这样 thymeleaf 引擎就可以根据我们返回的字符串进行拼接，再跳转</li>
</ol>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml">  <span class="nt">&lt;context-param&gt;</span>
                              <span class="nt">&lt;param-name&gt;</span>view-prefix<span class="nt">&lt;/param-name&gt;</span>
                              <span class="nt">&lt;param-value&gt;</span>/<span class="nt">&lt;/param-value&gt;</span>
  <span class="nt">&lt;/context-param&gt;</span>
  <span class="nt">&lt;context-param&gt;</span>
      <span class="nt">&lt;param-name&gt;</span>view-suffix<span class="nt">&lt;/param-name&gt;</span>
      <span class="nt">&lt;param-value&gt;</span>.html<span class="nt">&lt;/param-value&gt;</span>
  <span class="nt">&lt;/context-param&gt;</span>
</code></pre></div><ol start="2">
<li>配置监听器要读取的参数，目的是加载 IOC 容器的配置文件（也就是 applicationContext.xml）</li>
</ol>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml">  <span class="nt">&lt;context-param&gt;</span>
      <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
      <span class="nt">&lt;param-value&gt;</span>applicationContext.xml<span class="nt">&lt;/param-value&gt;</span>
  <span class="nt">&lt;/context-param&gt;</span>
</code></pre></div></li>
</ol>
<hr>
<p>😼😼😼😼😼😼😼😼</p>
<p><strong>开发具体的业务模块</strong></p>
<ol>
<li>
<p>一个具体的业务模块纵向上由几个部分组成：</p>
<ul>
<li>html 页面</li>
<li>POJO 类</li>
<li>DAO 接口和实现类</li>
<li>Service 接口和实现类</li>
<li>Controller 控制器组件</li>
</ul>
</li>
</ol>
<p>😼😼😼😼😼😼😼😼</p>
<hr>
<h3 id="step4-dao">step4. DAO</h3>
<p><a id="markdown-step4.-dao" name="step4.-dao"></a></p>
<hr>
<p>😼😼😼😼😼😼😼😼</p>
<p><strong>业务需求</strong></p>
<ul>
<li>
<ol>
<li>用户登录</li>
</ol>
</li>
<li>
<ol start="2">
<li>登录成功，显示主界面。左侧显示好友列表；上端显示欢迎词。如果不是自己的空间，显示超链接：返回自己的空间；下端显示日志列表</li>
</ol>
</li>
<li>
<ol start="3">
<li>查看日志详情：
<ul>
<li>日志本身的信息（作者头像、昵称、日志标题、日志内容、日志的日期）</li>
<li>回复列表（回复者的头像、昵称、回复内容、回复日期）</li>
<li>主人回复信息</li>
</ul>
</li>
</ol>
</li>
<li>
<ol start="4">
<li>删除日志</li>
</ol>
</li>
<li>
<ol start="5">
<li>删除特定回复</li>
</ol>
</li>
<li>
<ol start="6">
<li>删除特定主人回复</li>
</ol>
</li>
<li>
<ol start="7">
<li>添加日志、添加回复、添加主人回复</li>
</ol>
</li>
<li>
<ol start="8">
<li>点击左侧好友链接，进入好友的空间</li>
</ol>
</li>
</ul>
<p>😼😼😼😼😼😼😼😼</p>
<hr>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserBasicDAO</span><span class="o">{</span>
    <span class="c1">// 用户登录:跟据账户和密码获取特定用户信息
</span><span class="c1"></span>    <span class="n">UserBasic</span> <span class="nf">getUserBasic</span><span class="o">(</span><span class="n">String</span> <span class="n">loginId</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">);</span>
    
    <span class="c1">// 左侧显示好友列表:获取指定用户的所有好友列表
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="nf">getUserBasicList</span><span class="o">(</span><span class="n">UserBasic</span><span class="o">,</span> <span class="n">userBasic</span><span class="o">);</span>

    <span class="c1">// 下端显示日志列表:  根据id查询UserBasic的信息
</span><span class="c1"></span>

<span class="o">}</span>

</code></pre></div><p><strong>新人困惑为什么这个需求不写到上面， 因为， 上面是操作的是 UserBasic 实体阿</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TopicDAO</span><span class="o">{</span>
    <span class="c1">// 下端显示日志列表:  根据UserBasic查询日志
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">Topic</span><span class="o">&gt;</span> <span class="nf">getTopicList</span><span class="o">(</span><span class="n">UserBasic</span><span class="o">,</span> <span class="n">userBasic</span><span class="o">);</span>
    
    <span class="c1">// 获取特定日志信息
</span><span class="c1"></span>    <span class="n">Topic</span> <span class="nf">getTopic</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
    
    <span class="c1">// 增加日志
</span><span class="c1"></span>    <span class="kt">void</span> <span class="nf">addTopic</span><span class="o">(</span><span class="n">Topic</span> <span class="n">topic</span><span class="o">);</span>

    <span class="c1">// 删除日志
</span><span class="c1"></span>    <span class="kt">void</span> <span class="nf">delTopic</span><span class="o">(</span><span class="n">Topic</span> <span class="n">topic</span><span class="o">);</span>

<span class="o">}</span>

</code></pre></div><p><strong>回复需求</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ReplyDAO</span><span class="o">{</span>
    <span class="c1">// 获取指定日志的回复列表
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">Reply</span><span class="o">&gt;</span> <span class="nf">getReplyList</span><span class="o">(</span><span class="n">Topic</span> <span class="n">topic</span><span class="o">);</span>
    
    <span class="c1">// 增加日志
</span><span class="c1"></span>    <span class="kt">void</span> <span class="nf">addReply</span><span class="o">(</span> <span class="n">Reply</span>  <span class="n">reply</span><span class="o">);</span>

    <span class="c1">// 删除日志
</span><span class="c1"></span>    <span class="kt">void</span> <span class="nf">delReply</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>

<span class="o">}</span>

</code></pre></div><p><strong>主人回复需求</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">HostReplyDAO</span><span class="o">{</span>
    <span class="c1">// 获取指定日志的回复列表
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">HostReply</span><span class="o">&gt;</span> <span class="nf">getReplyList</span><span class="o">(</span><span class="n">Topic</span> <span class="n">topic</span><span class="o">);</span>
    
    <span class="c1">// 增加日志
</span><span class="c1"></span>    <span class="kt">void</span> <span class="n">add</span> <span class="nf">HostReply</span><span class="o">(</span> <span class="n">Reply</span>  <span class="n">reply</span><span class="o">);</span>

    <span class="c1">// 删除日志
</span><span class="c1"></span>    <span class="kt">void</span> <span class="n">del</span> <span class="nf">HostReply</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>

<span class="o">}</span>

</code></pre></div><p><strong>impl 实现</strong></p>
<p><strong>左侧显示好友列表:获取指定用户的所有好友列表</strong></p>
<blockquote>
<p>List<UserBasic> getUserBasicList(UserBasic, userBasic)</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">t_user_basic</span><span class="w"> </span><span class="n">t1</span><span class="w">
</span><span class="w">    </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">t_friend</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">uid</span><span class="w">
</span><span class="w">    </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">t_user_basic</span><span class="w"> </span><span class="n">t3</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">t2</span><span class="p">.</span><span class="n">fid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t3</span><span class="p">.</span><span class="n">id</span><span class="w">
</span><span class="w">
</span></code></pre></div><p>也可拆开,  String sql = &ldquo;select fid from t_friend where uid= ?&quot;;</p>
<p>返回的只有 id 值</p>
<p><strong>这行到了后端会报错，在数据库上查询没事</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">select</span><span class="w"> </span><span class="n">fid</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">t_friend</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">uid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></code></pre></div><figure><img src="/images/jwb15.png"
         alt="image"/><figcaption>
            <h4>DAO impl</h4>
        </figcaption>
</figure>

<figure><img src="/images/jwb16.png"
         alt="image"/><figcaption>
            <h4>DAO impl</h4>
        </figcaption>
</figure>

<h4 id="applicationxml-after-dao">application.xml after DAO</h4>
<p><a id="markdown-application.xml-after-dao" name="application.xml-after-dao"></a></p>
<p><strong>跟 mybatis 的 xml 配置区分，这里写的是 DAO 和 server 实现方法对象， 后者写的是方法</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;beans&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;userBasicDAO&#34;</span> <span class="na">class =</span> <span class="s">com.learn.qqzone.DAO.impl.UserBasicDAOImpl/</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;topicDAO&#34;</span> <span class="na">class =</span> <span class="s">com.learn.qqzone.DAO.impl.TopicDAOImpl/</span><span class="nt">&gt;</span>
   
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div><h3 id="step5-service">step5. SERVICE</h3>
<p><a id="markdown-step5.-service" name="step5.-service"></a></p>
<p><strong>面向业务</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserBasicService</span> <span class="o">{</span>
        <span class="c1">// 跟据账户和密码获取特定用户信息
</span><span class="c1"></span>    <span class="n">UserBasic</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">loginId</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">);</span>

    <span class="c1">// 获取指定用户的所有好友列表
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="nf">getFriendList</span><span class="o">(</span><span class="n">UserBasic</span> <span class="n">userBasic</span><span class="o">);</span>

<span class="o">}</span>
</code></pre></div><p>impl</p>
<p><strong>String sql = &ldquo;select fid from t_friend where uid= ?&quot;; 所以返回的只有 id 值</strong></p>
<p><strong>根据 id 再查用户列表</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserBasicServiceImpl</span> <span class="kd">implements</span> <span class="n">UserBasicService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">UserBasicDAO</span> <span class="n">userBasicDAO</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">UserBasic</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">loginId</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">UserBasic</span> <span class="n">userBasic</span> <span class="o">=</span> <span class="n">userBasicDAO</span><span class="o">.</span><span class="na">getUserBasic</span><span class="o">(</span><span class="n">loginId</span><span class="o">,</span> <span class="n">pwd</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">userBasic</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="nf">getFriendList</span><span class="o">(</span><span class="n">UserBasic</span> <span class="n">userBasic</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="n">userBasicList</span> <span class="o">=</span> <span class="n">userBasicDAO</span><span class="o">.</span><span class="na">getUserBasicList</span><span class="o">(</span><span class="n">userBasic</span><span class="o">);</span>

        <span class="c1">//  String sql = &#34;select fid from t_friend where uid= ?&#34;; 所以返回的只有id值
</span><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="n">friendList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">userBasicList</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="c1">// 根据 id 再查用户列表
</span><span class="c1"></span>        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">userBasicList</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">UserBasic</span> <span class="n">friend</span><span class="o">=</span> <span class="n">userBasicList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">friend</span> <span class="o">=</span> <span class="n">userBasicDAO</span><span class="o">.</span><span class="na">getUserBasicById</span><span class="o">(</span><span class="n">friend</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
            <span class="n">friendList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">friend</span><span class="o">);</span>

        <span class="o">}</span>
        <span class="k">return</span> <span class="n">friendList</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><p><strong>TopicService &amp;&amp; impl</strong></p>
<p><strong>参考 TopicDAO</strong></p>
<h4 id="applicationxml-after-service">application.xml after service</h4>
<p><a id="markdown-application.xml-after-service" name="application.xml-after-service"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;beans&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;userSerive&#34;</span> <span class="na">class =</span> <span class="s">com.learn.qqzone.service.impl.UserBasicSeriveImpl</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name =</span> <span class="s">&#34;userBasicDAO&#34;</span> <span class="na">ref =</span> <span class="s">&#34;userBasicDAO&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
    
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;topicSerive&#34;</span> <span class="na">class =</span> <span class="s">com.learn.qqzone.service.impl.TopicSeriveImpl</span><span class="nt">&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name =</span> <span class="s">&#34;topicDAO&#34;</span> <span class="na">ref =</span> <span class="s">&#34;topicDAO&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div><h3 id="step6-controller">step6. CONTROLLER</h3>
<p><a id="markdown-step6.-controller" name="step6.-controller"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">UserBasicService</span> <span class="n">userBasicService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">loginId</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">UserBasic</span> <span class="n">userBasic</span> <span class="o">=</span> <span class="n">userBasicService</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="n">loginId</span><span class="o">,</span> <span class="n">pwd</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">userBasic</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&#34;index&#34;</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p><strong>这样还不够，因为 index 上还需要好友列表，所以还要查询好友列表和日记列表</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">UserBasicService</span> <span class="n">userBasicService</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">TopicService</span> <span class="n">topicService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">loginId</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">,</span> <span class="n">HttpSession</span> <span class="n">session</span><span class="o">)</span> <span class="o">{</span>
       
        <span class="k">if</span> <span class="o">(</span><span class="n">userBasic</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
             <span class="n">UserBasic</span> <span class="n">userBasic</span> <span class="o">=</span> <span class="n">userBasicService</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="n">loginId</span><span class="o">,</span> <span class="n">pwd</span><span class="o">);</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="n">friendList</span> <span class="o">=</span> <span class="n">userBasicService</span><span class="o">.</span><span class="na">getFriendList</span><span class="o">(</span><span class="n">userBasic</span><span class="o">);</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">Topic</span><span class="o">&gt;</span> <span class="n">topicList</span> <span class="o">=</span> <span class="n">TopicService</span><span class="o">.</span><span class="na">getTopicList</span><span class="o">(</span><span class="n">userBasic</span><span class="o">);</span>
            <span class="n">userBasic</span><span class="o">.</span><span class="na">setFriendList</span><span class="o">(</span><span class="n">friendList</span><span class="o">);</span>
            <span class="n">userBasic</span><span class="o">.</span><span class="na">setTopicList</span><span class="o">(</span><span class="n">topicList</span><span class="o">);</span>


<span class="c1">// 补一个session保存信息
</span><span class="c1"></span>        <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">&#34;userBasic&#34;</span><span class="o">,</span> <span class="n">userBasic</span><span class="o">);</span>
            <span class="k">return</span> <span class="s">&#34;index&#34;</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&#34;login&#34;</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><h4 id="applicationxml-after-controller">application.xml after controller</h4>
<p><a id="markdown-application.xml-after-controller" name="application.xml-after-controller"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;user&#34;</span> <span class="na">class=</span><span class="s">&#34;com.learn.qqzone.controller.UserController&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;userBasicService&#34;</span> <span class="na">ref=</span><span class="s">&#34;userBasicService&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;topicService&#34;</span> <span class="na">ref=</span><span class="s">&#34;topicService&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div><p><strong>加下以下可以避免一些拼写上错误</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;!DOCTYPE beans [
</span><span class="cp">    &lt;!ELEMENT beans (bean*)&gt;</span>
    <span class="cp">&lt;!ELEMENT bean (property*)&gt;</span>
    <span class="cp">&lt;!ELEMENT property (#PCDATA)&gt;</span>

    <span class="cp">&lt;!ATTLIST bean id ID #REQUIRED&gt;</span>
    <span class="cp">&lt;!ATTLIST bean class CDATA #IMPLIED&gt;</span>
    <span class="cp">&lt;!ATTLIST property name CDATA #IMPLIED&gt;</span>
    <span class="cp">&lt;!ATTLIST property ref IDREF #IMPLIED&gt;</span>
]&gt;

</code></pre></div><h4 id="artifact-qqwar-exploded-error-during-artifact-deployment-see-server-log-for-details">Artifact qq:war exploded: Error during artifact deployment. See server log for details</h4>
<p><a id="markdown-artifact-qq%3Awar-exploded%3A-error-during-artifact-deployment.-see-server-log-for-details" name="artifact-qq%3Awar-exploded%3A-error-during-artifact-deployment.-see-server-log-for-details"></a></p>
<p><strong>tomcat log</strong></p>
<p><strong>java.lang.IllegalArgumentException: InputStream cannot be null</strong></p>
<p>超级想骂人，这个错误弄了很久，看 server.log 说 context.xml 不存在之类的，在这里就卡了半天。试了所有的教程，完全不行， 具体看这里<a href="https://rileyshen.github.io/post/error1/" >error1</a></p>
<h4 id="nosuchfiledexception-fid">NoSuchFiledException-fid</h4>
<p><a id="markdown-nosuchfiledexception-fid" name="nosuchfiledexception-fid"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="nf">getUserBasicList</span><span class="o">(</span><span class="n">UserBasic</span> <span class="n">userBasic</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select fid from t_friend where uid = ?&#34;</span>
    <span class="k">return</span> <span class="o">...</span>
<span class="o">}</span>
</code></pre></div><p><strong>返回的是 UserBasic， 而它并没有 fid，所以会报错</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">UserBasic</span><span class="o">&gt;</span> <span class="nf">getUserBasicList</span><span class="o">(</span><span class="n">UserBasic</span> <span class="n">userBasic</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;select fid as `id` from t_friend where uid = ?&#34;</span>
    <span class="k">return</span> <span class="o">...</span>
<span class="o">}</span>
</code></pre></div><p>rsmd.getColumnName() 和 rsmd.getColumnLabel()</p>
<p>getColumnLabel() 返回 <code>id</code></p>
<p>getColumnName() 返回 <code>fid</code></p>
<h4 id="can-not-set-comlearnqqzonepojouserbasic-field-comlearnqqzonepojotopicauthor-to-javalanginteger">Can not set com.learn.qqzone.pojo.UserBasic field com.learn.qqzone.pojo.Topic.author to java.lang.Integer</h4>
<p><a id="markdown-can-not-set-com.learn.qqzone.pojo.userbasic-field-com.learn.qqzone.pojo.topic.author-to-java.lang.integer" name="can-not-set-com.learn.qqzone.pojo.userbasic-field-com.learn.qqzone.pojo.topic.author-to-java.lang.integer"></a></p>
<p><strong>不能把 UserBasic 设置到 topic 里面的 author 上去， 因为结果获取的是 Integer</strong></p>
<p><strong>应该把数字封装成一个 UserBasic 再设置到 author 里面去</strong></p>
<blockquote>
<p>java.lang.NoSuchFieldException: userBasicDAO
at java.lang.Class.getDeclaredField(Class.java:2070)
at com.learn.myssm.ioc.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:76)
at com.learn.myssm.listeners.ContextLoaderListener.contextInitialized&gt;(ContextLoaderListener.java:22)</p>
</blockquote>
<p>java.lang.NoSuchFieldException: userBasicDAO</p>
<blockquote>
<p>//获取当前字段的类型名称
String typeName = field.getType().getName();
//判断如果是自定义类型，则需要调用这个自定义类的带一个参数的构造方法，创建出这个自定义的实例对象，然后将实例对象赋值给这个属性</p>
</blockquote>
<h4 id="汇总">汇总</h4>
<p><a id="markdown-%E6%B1%87%E6%80%BB" name="%E6%B1%87%E6%80%BB"></a></p>
<ol>
<li>
<p>top.html 页面显示登录者昵称、判断是否是自己的空间</p>
<p>1)显示登录者昵称： ${session.userBasic.nickName}</p>
<p>2)判断是否是自己的空间 : ${session.userBasic.id!=session.friend.id}</p>
<p>如果不是期望的效果，首先考虑将两者的 id 都显示出来</p>
</li>
<li>
<p>点击左侧的好友链接，进入好友空间</p>
<ol>
<li>
<p>根据 id 获取指定 userBasic 信息，查询这个 userBasic 的 topicList，然后覆盖 friend 对应的 value</p>
</li>
<li>
<p>main 页面应该展示 friend 中的 topicList，而不是 userBasic 中的 topicList</p>
</li>
<li>
<p>跳转后，在左侧（left）中显示整个 index 页面</p>
<ul>
<li>
<p>问题：在 left 页面显示整个 index 布局</p>
</li>
<li>
<p>解决：给超链接添加 target 属性：   target=&quot;_top&rdquo; 保证在顶层窗口显示整个 index 页面</p>
</li>
</ul>
</li>
<li>
<p>top.html 页面需要修改： &ldquo;欢迎进入${session.friend}&rdquo;</p>
<p>top.html 页面的返回自己空间的超链接需要修改：
<a th:href="@{|/user.do?operate=friend&id=${session.userBasic.id}|}" target="_top"></p>
</li>
</ol>
</li>
<li>
<p>日志详情页面实现</p>
<ol>
<li>
<p>已知 topic 的 id，需要根据 topic 的 id 获取特定 topic</p>
</li>
<li>
<p>获取这个 topic 关联的所有的回复</p>
</li>
<li>
<p>如果某个回复有主人回复，需要查询出来</p>
</li>
</ol>
<ul>
<li>
<p>在 TopicController 中获取指定的 topic</p>
</li>
<li>
<p>具体这个 topic 中关联多少个 Reply，由 ReplyService 内部实现</p>
</li>
</ul>
<ol start="4">
<li>
<p>获取到的 topic 中的 author 只有 id，那么需要在 topicService 的 getTopic 方法中封装，在查询 topic 本身信息时，同时调用 userBasicService 中的获取 userBasic 方法，给 author 属性赋值</p>
</li>
<li>
<p>同理，在 reply 类中也有 author，而且这个 author 也是只有 id，那么我们也需要根据 id 查询得到 author，最后设置关联</p>
</li>
</ol>
</li>
<li>
<p>添加回复</p>
</li>
<li>
<p>删除回复</p>
<ol>
<li>如果回复有关联的主人回复，需要先删除主人回复</li>
<li>删除回复
Cannot delete or update a parent row: a foreign key constraint fails
(<code>qqzonedb</code>.<code>t_host_reply</code>, CONSTRAINT <code>FK_host_reply</code> FOREIGN KEY (<code>reply</code>) REFERENCES <code>t_reply</code> (<code>id</code>))
我们在删除回复表记录时，发现删除失败，原因是：在主人回复表中仍然有记录引用待删除的回复这条记录
如果需要删除主表数据，需要首先删除子表数据</li>
</ol>
</li>
<li>
<p>删除日志</p>
<ol>
<li>删除日志，首先需要考虑是否有关联的回复</li>
<li>删除回复，首先需要考虑是否有关联的主人回复</li>
<li>另外，如果不是自己的空间，则不能删除日志</li>
</ol>
</li>
</ol>
<h3 id="汇总-1">汇总</h3>
<p><a id="markdown-%E6%B1%87%E6%80%BB" name="%E6%B1%87%E6%80%BB"></a></p>
<h4 id="1-日期和字符串之间的格式化">1. 日期和字符串之间的格式化</h4>
<p><a id="markdown-%E6%97%A5%E6%9C%9F%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B9%8B%E9%97%B4%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96" name="%E6%97%A5%E6%9C%9F%E5%92%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B9%8B%E9%97%B4%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%8C%96"></a></p>
<p><strong>String -&gt; java.util.Date</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">dateStr1</span> <span class="o">=</span> <span class="s">&#34;2021-12-30 12:59:59&#34;</span><span class="o">;</span>
<span class="n">SimpleDateFormat</span> <span class="n">sdf</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="o">(</span><span class="s">&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span class="o">);</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">Date</span> <span class="n">date1</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">dateStr1</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><p><strong>Date -&gt; String</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="n">Date</span> <span class="n">date2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="o">();</span>
<span class="n">String</span> <span class="n">dateStr2</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">date2</span><span class="o">);</span>
</code></pre></div><h4 id="2-thymeleaf-中使用dates-这个公共的内置对象">2. thymeleaf 中使用#dates 这个公共的内置对象</h4>
<p><a id="markdown-thymeleaf-%E4%B8%AD%E4%BD%BF%E7%94%A8%23dates-%E8%BF%99%E4%B8%AA%E5%85%AC%E5%85%B1%E7%9A%84%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1" name="thymeleaf-%E4%B8%AD%E4%BD%BF%E7%94%A8%23dates-%E8%BF%99%E4%B8%AA%E5%85%AC%E5%85%B1%E7%9A%84%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1"></a></p>
<blockquote>
<p>${#dates.format(topic.topicDate ,&lsquo;yyyy-MM-dd HH:mm:ss&rsquo;)}</p>
</blockquote>
<h4 id="3-系统启动时我们访问的页面是-httplocalhost8080pro23pagedooperatepagepagelogin">3. 系统启动时，我们访问的页面是： http://localhost:8080/pro23/page.do?operate=page&amp;page=login</h4>
<p><a id="markdown-%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%97%B6%EF%BC%8C%E6%88%91%E4%BB%AC%E8%AE%BF%E9%97%AE%E7%9A%84%E9%A1%B5%E9%9D%A2%E6%98%AF%EF%BC%9A-http%3A%2F%2Flocalhost%3A8080%2Fpro23%2Fpage.do%3Foperate%3Dpage%26page%3Dlogin" name="%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%97%B6%EF%BC%8C%E6%88%91%E4%BB%AC%E8%AE%BF%E9%97%AE%E7%9A%84%E9%A1%B5%E9%9D%A2%E6%98%AF%EF%BC%9A-http%3A%2F%2Flocalhost%3A8080%2Fpro23%2Fpage.do%3Foperate%3Dpage%26page%3Dlogin"></a></p>
<p>为什么不是： http://localhost:8080/pro23/login.html  ?</p>
<p>如果是后者，那么属于直接访问静态页面。那么页面上的 thymeleaf 表达式（标签）浏览器是不能识别的</p>
<p>我们访问前者的目的其实就是要执行 ViewBaseServlet 中的 processTemplete()</p>
<h4 id="4-httplocalhost8080pro23pagedooperatepagepagelogin-访问这个-url执行的过程是什么样的">4. http://localhost:8080/pro23/page.do?operate=page&amp;page=login 访问这个 URL，执行的过程是什么样的</h4>
<p><a id="markdown-http%3A%2F%2Flocalhost%3A8080%2Fpro23%2Fpage.do%3Foperate%3Dpage%26page%3Dlogin-%E8%AE%BF%E9%97%AE%E8%BF%99%E4%B8%AA-url%EF%BC%8C%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84" name="http%3A%2F%2Flocalhost%3A8080%2Fpro23%2Fpage.do%3Foperate%3Dpage%26page%3Dlogin-%E8%AE%BF%E9%97%AE%E8%BF%99%E4%B8%AA-url%EF%BC%8C%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84"></a></p>
<blockquote>
<p>http://  localhost   :8080   /pro23          /page.do                        ?operate=page&amp;page=login
协议       ServerIP   port    context root    request.getServletPath()         query</p>
</blockquote>
<p><strong>string</strong></p>
<ol>
<li>
<p>DispatcherServlet -&gt; urlPattern :  *.do  拦截/page.do</p>
</li>
<li>
<p>request.getServletPath() -&gt;  /page.do</p>
</li>
<li>
<p>解析处理字符串，将/page.do -&gt; page</p>
</li>
<li>
<p>拿到 page 这个字符串，然后去 IOC 容器（BeanFactory）中寻找 id=page 的那个 bean 对象   -&gt; PageController.java</p>
</li>
<li>
<p>获取 operate 的值 -&gt; page    因此得知，应该执行 PageController 中的 page()方法</p>
</li>
<li>
<p>PageController 中的 page 方法定义如下：</p>
</li>
</ol>
<blockquote>
<p>public String page(String page){
return page ;
}</p>
</blockquote>
<ol start="7">
<li>
<p>在 queryString:   ?operate=page&amp;page=login 中 获取请求参数，参数名是 page，参数值是 login<br>
因此 page 方法的参数 page 值会被赋上&quot;login&rdquo;
然后 return &ldquo;login&rdquo; , return 给 谁？？</p>
</li>
<li>
<p>因为 PageController 的 page 方法是 DispatcherServlet 通过反射调用的 method.invoke(..), 因此，字符串&quot;login&quot;返回 DispatcherServlet</p>
</li>
<li>
<p>DispatcherServlet 接收到返回值，然后处理视图. 目前处理视图的方式有两种： 1.带前缀 redirect:    2.不带前缀
当前，返回&quot;login&quot;，不带前缀
那么执行  super.processTemplete(&ldquo;login&rdquo;,request,response);</p>
</li>
<li>
<p>此时 ViewBaseServlet 中的 processTemplete 方法会执行，效果是：</p>
</li>
</ol>
<p>在&quot;login&quot;这个字符串前面拼接 &ldquo;/&rdquo;  (其实就是配置文件中 view-prefixe 配置的值)</p>
<p>在&quot;login&quot;这个字符串后面拼接 &ldquo;.html&rdquo; (其实就是配置文件中 view-suffix 配置的值)
最后进行服务器转发</p>
<h3 id="javaweb-项目开发的-套路">javaweb 项目开发的 套路</h3>
<ul>
<li>
<ol>
<li>拷贝 myssm 包</li>
</ol>
</li>
<li>
<ol start="2">
<li>新建配置文件 applicationContext.xml 或者可以不叫这个名字，在 web.xml 中指定文件名</li>
</ol>
</li>
<li>
<ol start="3">
<li>在 web.xml 文件中配置</li>
</ol>
</li>
<li>
<p>配置前缀和后缀，这样 thymeleaf 引擎就可以根据我们返回的字符串进行拼接，再跳转</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;context-param&gt;</span>
                                <span class="nt">&lt;param-name&gt;</span>view-prefix<span class="nt">&lt;/param-name&gt;</span>
                                <span class="nt">&lt;param-value&gt;</span>/<span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/context-param&gt;</span>
    <span class="nt">&lt;context-param&gt;</span>
        <span class="nt">&lt;param-name&gt;</span>view-suffix<span class="nt">&lt;/param-name&gt;</span>
        <span class="nt">&lt;param-value&gt;</span>.html<span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/context-param&gt;</span>
</code></pre></div></li>
<li>
<p>配置监听器要读取的参数，目的是加载 IOC 容器的配置文件（也就是 applicationContext.xml）</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml">    <span class="nt">&lt;context-param&gt;</span>
        <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
        <span class="nt">&lt;param-value&gt;</span>applicationContext.xml<span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/context-param&gt;</span>
</code></pre></div></li>
<li>
<ol start="4">
<li>开发具体的业务模块：
<ul>
<li>
<p>一个具体的业务模块纵向上由几个部分组成：</p>
<ul>
<li>html 页面</li>
<li>POJO 类</li>
<li>DAO 接口和实现类</li>
<li>Service 接口和实现类</li>
<li>Controller 控制器组件</li>
</ul>
</li>
<li>
<p>如果 html 页面有 thymeleaf 表达式，一定不能够直接访问，必须要经过 PageController</p>
</li>
<li>
<p>在 applicationContext.xml 中配置 DAO、Service、Controller，以及三者之间的依赖关系</p>
</li>
<li>
<p>DAO 实现类中 ， 继承 BaseDAO，然后实现具体的接口, 需要注意，BaseDAO 后面的泛型不能写错。
例如：</p>
<blockquote>
<p>public class UserDAOImpl extends BaseDAO<User> implements UserDAO{}</p>
</blockquote>
</li>
</ul>
</li>
</ol>
</li>
<li>
<ol start="5">
<li>
<p>Service 是业务控制类，这一层我们只需要记住一点</p>
<ul>
<li>业务逻辑我们都封装在 service 这一层，不要分散在 Controller 层。也不要出现在 DAO 层（我们需要保证 DAO 方法的单精度特性）</li>
<li>当某一个业务功能需要使用其他模块的业务功能时，尽量的调用别人的 service，而不是深入到其他模块的 DAO 细节</li>
</ul>
</li>
</ol>
</li>
<li>
<ol start="6">
<li>
<p>Controller 类的编写规则</p>
<ul>
<li>在 applicationContext.xml 中配置 Controller</li>
</ul>
<blockquote>
<p>&lt;bean id=&ldquo;user&rdquo; class=&ldquo;com.atguigu.qqzone.controllers.UserController&gt;</p>
</blockquote>
<p>那么，用户在前端发请求时，对应的 servletpath 就是  <code>/user.do</code>  , 其中的 <code>user</code> 就是对应此处的<code>bean</code>的<code>id</code>值</p>
<ul>
<li>在 <code>Controller</code> 中设计的方法名需要和 <code>operate</code> 的值一致</li>
</ul>
<blockquote>
<p>public String login(String loginId , String pwd , HttpSession session){
return &ldquo;index&rdquo;;
}</p>
</blockquote>
<p>因此，我们的登录验证的表单如下</p>
<blockquote>
<form th:action="@{/user.do}" method="post">
</blockquote>
<pre><code>   &lt;inut type=&quot;hidden&quot; name=&quot;operate&quot; value=&quot;login&quot;/&gt;
</code></pre>
<blockquote>
 </form>
</blockquote>
<ul>
<li>在表单中，组件的 name 属性和 Controller 中方法的参数名一致</li>
</ul>
<blockquote>
<p><input type="text" name="loginId" />
public String login(String loginId , String pwd , HttpSession session){</p>
</blockquote>
<ul>
<li>另外，需要注意的是： Controller 中的方法中的参数不一定都是通过请求参数获取的</li>
</ul>
<blockquote>
<p>if(&ldquo;request&rdquo;.equals&hellip;) else if(&ldquo;response&rdquo;.equals..) else if(&ldquo;session&rdquo;.equals..){<br>
直接赋值 <br>
}else{<br>
此处才是从 request 的请求参数中获取<br>
request.getParameter(&ldquo;loginId&rdquo;)
}</p>
</blockquote>
</li>
</ol>
</li>
<li>
<ol start="7">
<li>DispatcherServlet 中步骤大致分为
<ul>
<li>
<ol start="0">
<li>从 application 作用域获取 IOC 容器</li>
</ol>
</li>
<li>
<ol>
<li>解析 servletPath ， 在 IOC 容器中寻找对应的 Controller 组件</li>
</ol>
</li>
<li>
<ol start="2">
<li>准备 operate 指定的方法所要求的参数</li>
</ol>
</li>
<li>
<ol start="3">
<li>调用 operate 指定的方法</li>
</ol>
</li>
<li>
<ol start="4">
<li>接收到执行 operate 指定的方法的返回值，对返回值进行处理 - 视图处理</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
<li>
<ol start="8">
<li>
<p>为什么 DispatcherServlet 能够从 application 作用域获取到 IOC 容器</p>
<pre><code>ContextLoaderListener 在容器启动时会执行初始化任务，而它的操作就是：
</code></pre>
<ul>
<li>解析 IOC 的配置文件，创建一个一个的组件，并完成组件之间依赖关系的注入</li>
<li>将 IOC 容器保存到 application 作用域</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="代码导出">代码导出</h3>
<ul>
<li>
<ol>
<li>修改 BaseDAO，让其支持 properties 文件以及 druid 数据源连接池 
讲解了两种方式：</li>
</ol>
<ul>
<li>
<ol>
<li>直接自己配置 properties，然后读取，然后加载驱动</li>
</ol>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">DRIVER</span><span class="o">;</span>
<span class="o">...</span>

<span class="kd">static</span> <span class="o">{</span>
    <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="n">ConnUtil</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">().</span><span class="na">getResourcesAsStream</span><span class="o">(</span><span class="s">&#34;jdbc.properties&#34;</span><span class="o">);</span>
    <span class="n">Properties</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Properties</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">properties</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>

        <span class="n">DRIVER</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">&#34;jdbc.driver&#34;</span><span class="o">);</span>
        <span class="o">...</span>
    <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><ul>
<li>
<ol start="2">
<li>或使用 druid 连接池技术，那么 properties 中的 key 是有要求的</li>
</ol>
</li>
</ul>
<p><strong>不用数据链接池的时候</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"> <span class="kd">private</span> <span class="kd">static</span> <span class="n">Connection</span> <span class="nf">createConn</span><span class="o">()</span> <span class="o">{</span>
     <span class="k">try</span> <span class="o">{</span>
         <span class="c1">// 1. 加载驱动
</span><span class="c1"></span>        <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">DRIVER</span><span class="o">);</span>
         <span class="c1">// 2. 通过驱动管理器获取连接对象
</span><span class="c1"></span>         <span class="k">return</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">URL</span><span class="o">,</span> <span class="n">USER</span><span class="o">,</span> <span class="n">PWD</span><span class="o">);</span>
     <span class="o">}</span>
 <span class="o">}</span>

</code></pre></div><p>用<strong>druid 后</strong>， 常用代码还是要熟练</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"> <span class="kd">private</span> <span class="kd">static</span> <span class="n">Connection</span> <span class="nf">createConn</span><span class="o">()</span> <span class="o">{</span>

     <span class="k">try</span> <span class="o">{</span>
        <span class="n">DruidDataSource</span> <span class="n">druidDataSource</span> <span class="o">=</span> <span class="k">new</span>  <span class="n">DruidDataSourc</span><span class="o">();</span>
        <span class="n">druidDataSource</span><span class="o">.</span><span class="na">setDriverClassName</span><span class="o">(</span><span class="n">DRIVER</span><span class="o">);</span>
        <span class="n">druidDataSource</span><span class="o">.</span><span class="na">setDriverClassName</span><span class="o">(</span><span class="n">URL</span><span class="o">);</span>
        <span class="n">druidDataSource</span><span class="o">.</span><span class="na">setDriverClassName</span><span class="o">(</span><span class="n">USER</span><span class="o">);</span>
        <span class="n">druidDataSource</span><span class="o">.</span><span class="na">setDriverClassName</span><span class="o">(</span><span class="n">PWD</span><span class="o">);</span>
        <span class="o">...</span>

         <span class="k">return</span> <span class="n">druidDataSource</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
     <span class="o">}</span>
 <span class="o">}</span>

</code></pre></div></li>
</ul>
<p><strong>工厂模式</strong></p>
<pre><code>```java
static Properties properties = new Properties();

 static {
    InputStream is = ConnUtil.class.getClassLoader().getResourcesAsStream(&quot;jdbc.properties&quot;);
    
    try {
        properties.load(is);

      
    } catch(IOException e) {
        ...
    }
}

 private static Connection createConn() {

     try {
        DataSource druidDataSource = DruidDataSourceFactory. createDataSource(properties);
        
        ...
        
         return druidDataSource.getConnection();
     }
 }

```
</code></pre>
<hr>
<p><a href="https://rileyshen.github.io/post/javaweb2/" >javaweb2</a></p>
<p><a href="https://rileyshen.github.io/post/javaweb3/" >javaweb3</a></p>
<p><a href="https://rileyshen.github.io/post/javaweb4/" >javaweb4</a></p>
<p><a href="https://rileyshen.github.io/post/javaweb5/" >javaweb5</a></p>
<p><a href="https://rileyshen.github.io/tags/spring/" >spring</a></p>
<p><a href="https://rileyshen.github.io/post/springmvc/" >springmvc</a></p></div>
    <div class="post-footer">
        <div class="info">
            
            <span class="separator"><a class="tag" href="/tags/javaee-project/">javaEE project</a><a class="tag" href="/tags/javaee-web/">javaEE web</a><a class="tag" href="/tags/three-tier-system/">Three-tier system</a><a class="tag" href="/tags/thymeleaf/">Thymeleaf</a><a class="tag" href="/tags/templateengine%2eprocess/">TemplateEngine.process</a></span>
        </div>
    </div>

    
</div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script>
<script async defer src="//latest.js"></script>
<noscript><img src="//noscript.gif" alt=""/></noscript>

</body>

</html>
