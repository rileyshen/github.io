<!DOCTYPE html>
<html  dir="ltr" lang="en" data-theme=""><head>
    <title> Riley Shen | quick review of Linux </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description"
        content="Linux">
    <meta name="google-site-verification" content="Nac1UrFTdr1E1F48JLe7XQhIbKn2_WtF4VnJI8KOtew" />
    

    
    
    
    <link rel="stylesheet" href="/css/main.min.a7c9793b97840076bef76d2743ee1c90b13bd21c18674076a0cccd5dd54c723b.css" integrity="sha256-p8l5O5eEAHa&#43;920nQ&#43;4ckLE70hwYZ0B2oMzNXdVMcjs="
        crossorigin="anonymous" type="text/css">
    
    
    <link rel="stylesheet" href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4=" crossorigin="anonymous" type="text/css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />

    
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">

    <link rel="canonical" href="/post/linux/">

    <link rel="preconnect" href="https://fonts.gstatic.com">



    
    
    
    
    <script type="text/javascript" src="/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js"
        integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin="anonymous"></script>


    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rileyshen.github.io/images/site-feature-image.png"/>

<meta name="twitter:title" content="quick review of Linux"/>
<meta name="twitter:description" content="Linux"/>


    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,500;1,600;1,700&display=swap"
        rel="stylesheet">

</head><body><div class="sidebar animated fadeInDown ">
    <div class="logo-title">
        <div class="title">
            <img src="/images/profileS.jpg" alt="profile picture">
            <h3 title=""><a href="/">I&#39;m Riley Shen</a></h3>
            <div class="description">
                <p><br>Riley likes to push her limits <br>and always keep learning new things. <br>She shares her weekly learnings <br>because "if you can't explain it simply,<br>it means you didn't understand it well enough".<br></p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="mailto:ripple.shen31@gmail.com" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/rileyshen" rel="me" aria-label="GitHub">
                    <i class="fab fa-github fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy;  Riley Shen 2023 </div>
    </div>
</div>
<div class="main">
    <div class="page-top  animated fadeInDown ">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/post/"
                        
                   title="">Posts</a></li>
        
            
            <li><a 
                   href="/about/"
                        
                   title="">About Me</a></li>
        
            
            <li><a 
                   href="/contact/"
                        
                   title="">Contact</a></li>
        
        
        
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
<div class="post  animated fadeInDown ">
    <div class="post-content">
        
        <div class="post-title">
            <h2>quick review of Linux</h2>
            
            <div class="info">
                <em class="fas fa-calendar-day"></em>
                <span class="date">
                    Tue, Feb 1, 2022
                    </span>
                <em class="fas fa-stopwatch"></em>
                <span class="reading-time">12-minute read</span>
            </div>
            
        </div>

        <p>quick review of Linux</p>
<!-- TOC -->
<ul>
<li><a href="#version-ubuntu-redhat-centos" >version: Ubuntu, RedHat, CentOS</a></li>
<li><a href="#environment-setup" >Environment Setup</a></li>
<li><a href="#the-root-directory" >The root directory</a></li>
<li><a href="#vim" >vim</a></li>
<li><a href="#ip-address-and-gateway" >ip address and gateway</a>
<ul>
<li><a href="#setting-up-static-ip-address-for-virtual-machine" >setting up static IP address for virtual machine</a></li>
<li><a href="#change-hostname" >change hostname</a></li>
<li><a href="#hosts" >hosts</a></li>
<li><a href="#use-ssh-to-connect-to-a-remote-server-in-linux" >use SSH to Connect to a Remote Server in Linux</a></li>
</ul>
</li>
<li><a href="#systemctl" >systemctl</a></li>
<li><a href="#commands" >commands</a>
<ul>
<li><a href="#touch" >touch</a></li>
<li><a href="#cp-cp-r" >cp cp-r</a></li>
<li><a href="#rm" >rm</a></li>
<li><a href="#mv" >mv</a></li>
<li><a href="#cat" >cat</a></li>
<li><a href="#more" >more</a></li>
<li><a href="#less" >less</a></li>
<li><a href="#echo" >echo</a></li>
<li><a href="#-" >&amp;gt; &amp;raquo;</a></li>
<li><a href="#head" >head</a></li>
<li><a href="#tail" >tail</a></li>
<li><a href="#ln" >ln</a></li>
</ul>
</li>
<li><a href="#usercommand" >UserCommand</a>
<ul>
<li><a href="#useradd" >useradd</a></li>
<li><a href="#passwd" >passwd</a></li>
<li><a href="#sudo-%E4%B8%B4%E6%97%B6%E7%BB%99%E7%94%A8%E6%88%B7%E5%8A%A0%E5%85%A5%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90" >sudo 临时给用户加入管理员权限</a></li>
<li><a href="#usermod-%E4%BF%AE%E6%94%B9%E4%BD%BF%E7%94%A8%E8%80%85%E7%9A%84%E5%8F%82%E6%95%B0%E5%92%8C%E8%B5%84%E6%96%99" >usermod 修改使用者的参数和资料</a></li>
</ul>
</li>
<li><a href="#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90" >文件权限</a>
<ul>
<li><a href="#chmod" >chmod</a></li>
<li><a href="#find" >find</a></li>
<li><a href="#location" >location</a></li>
<li><a href="#grep" >grep</a></li>
<li><a href="#gzip-and-gunzip" >gzip and gunzip</a></li>
<li><a href="#tar" >tar</a></li>
</ul>
</li>
<li><a href="#disk" >disk</a>
<ul>
<li><a href="#tree" >tree</a></li>
<li><a href="#du" >du</a></li>
</ul>
</li>
<li><a href="#shell" >shell</a>
<ul>
<li><a href="#%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC" >运行脚本</a>
<ul>
<li><a href="#sh-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84" >sh&#43; 脚本的相对路径</a></li>
<li><a href="#sh-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84" >sh&#43; 脚本的绝对路径</a></li>
<li><a href="#bash-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84" >bash&#43; 脚本的相对路径</a></li>
<li><a href="#bash-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84" >bash&#43; 脚本的相对路径</a></li>
<li><a href="#%E7%9B%B4%E6%8E%A5%E8%BE%93%E5%85%A5%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E6%88%96%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84" >直接输入脚本的相对或绝对路径</a></li>
<li><a href="#source-%E6%9B%B4%E5%A5%BD%E7%9A%84%E6%96%B9%E5%BC%8F" >source 更好的方式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8F%98%E9%87%8F" >变量</a>
<ul>
<li><a href="#%E8%BF%90%E7%AE%97%E7%AC%A6" >运算符</a></li>
<li><a href="#%E8%AE%A1%E7%AE%97" >计算</a></li>
<li><a href="#%E8%84%9A%E6%9C%AC%E8%AE%A1%E7%AE%97" >脚本计算</a></li>
<li><a href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD" >条件判断</a></li>
<li><a href="#%E7%94%A8-test-%E6%B5%8B%E5%87%BA%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E6%9C%89%E7%9B%B8%E5%BA%94%E6%9D%83%E9%99%90" >用 test 测出某个文件是否有相应权限</a></li>
<li><a href="#%E7%94%A8-test-%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8" >用 test 判断是否存在</a></li>
<li><a href="#%E6%9D%A1%E4%BB%B6" >条件</a></li>
</ul>
</li>
<li><a href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6" >流程控制</a>
<ul>
<li><a href="#if-%E5%8D%95%E5%88%86%E6%94%AF" >if 单分支</a></li>
<li><a href="#if-%E5%A4%9A%E5%88%86%E6%94%AF" >if 多分支</a></li>
<li><a href="#elif-%E5%A4%9A%E5%88%86%E6%94%AF" >elif 多分支</a></li>
<li><a href="#case-%E5%88%86%E6%94%AF" >case 分支</a></li>
<li><a href="#for-%E5%BE%AA%E7%8E%AF" >for 循环</a>
<ul>
<li><a href="#%E4%BB%8E-1-%E5%8A%A0%E5%88%B0-100" >从 1 加到 100</a></li>
<li><a href="#%E6%9B%B4%E5%B8%B8%E8%A7%81%E7%9A%84-for" >更常见的 for</a></li>
</ul>
</li>
<li><a href="#-and-" >$* and $@</a></li>
<li><a href="#while" >while</a></li>
</ul>
</li>
<li><a href="#read" >read</a></li>
<li><a href="#%E6%8F%90%E7%A4%BA-7-%E7%A7%92%E5%86%85-%E8%AF%BB%E5%8F%96%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%85%A5%E7%9A%84%E5%90%8D%E7%A7%B0" >提示 7 秒内， 读取控制台输入的名称</a></li>
<li><a href="#%E5%87%BD%E6%95%B0" >函数</a>
<ul>
<li><a href="#%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0" >系统函数</a>
<ul>
<li><a href="#basename" >basename</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0" >自定义函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6%E5%BA%94%E7%94%A8" >归档文件应用</a>
<ul>
<li><a href="#%E5%8A%A0%E5%85%A5%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1" >加入定时任务</a></li>
</ul>
</li>
<li><a href="#%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF" >发送消息</a></li>
</ul>
<!-- /TOC -->
<h2 id="version-ubuntu-redhat-centos">version: Ubuntu, RedHat, CentOS</h2>
<p><a id="markdown-version%3A-ubuntu%2C-redhat%2C-centos" name="version%3A-ubuntu%2C-redhat%2C-centos"></a></p>
<h2 id="environment-setup">Environment Setup</h2>
<p><a id="markdown-environment-setup" name="environment-setup"></a></p>
<ol>
<li>
<p>virtual machine (vmware, Oracle VM VirtualBox)</p>
<ul>
<li>vmware: BIOS (F2, F10) -&gt; enable Virtualization Technology</li>
<li>internet
<ul>
<li>NAT allows multiple hosts on a private network to access the internet using a single public IP address.
<ul>
<li>192.168.14.130 (windows)</li>
<li>new address: 192.168.20.33 (windows)</li>
<li>centos: 192.168.20.xxx</li>
<li>cons: prevents IP address conflicts</li>
<li>pros: cannot talk to each other</li>
</ul>
</li>
<li>Bridge mode is the configuration that disables the NAT feature on the modem and allows a router to function as a DHCP server without an IP Address conflict
<ul>
<li>192.168.14.100 (windows)</li>
<li>centos: 192.168.14.xxx</li>
<li>cons: devices connected to both routers can talk to each other</li>
<li>pros: 192.168.14.0 ~ 192.168.14.255 only [256 - 3], limited ip address, may cause conflict</li>
</ul>
</li>
<li>Host only</li>
</ul>
</li>
</ul>
</li>
<li>
<p>centos system(Ubuntu)</p>
<ul>
<li><strong>root password (search generate complex password) (16 chars)</strong></li>
<li>custom layouts</li>
<li>
<ol>
<li>sda</li>
</ol>
</li>
<li>
<ol start="2">
<li>standard partition layout</li>
</ol>
</li>
<li>
<ol start="3">
<li>/boot 200MB</li>
</ol>
</li>
<li>
<ol start="4">
<li>swap 2048</li>
</ol>
</li>
<li>
<ol start="5">
<li>/</li>
</ol>
</li>
</ul>
<figure><img src="/images/linux1.png"
         alt="image"/><figcaption>
            <h4>linux layout</h4>
        </figcaption>
</figure>

<p><a href="https://www.youtube.com/watch?v=fhWanMo-8zg&amp;list=PLmOn9nNkQxJFYoQN9mBcr18fU1UAuWps0&amp;index=6&amp;ab_channel=%E5%B0%9A%E7%A1%85%E8%B0%B7IT%E5%9F%B9%E8%AE%AD%E5%AD%A6%E6%A0%A1"  target="_blank" >centos setup</a></p>
</li>
</ol>
<h2 id="the-root-directory">The root directory</h2>
<p><a id="markdown-the-root-directory" name="the-root-directory"></a></p>
<figure><img src="/images/linux2.png"
         alt="image"/><figcaption>
            <h4>directory structure</h4>
        </figcaption>
</figure>

<p>open terminal</p>
<blockquote>
<p>[root@xxx ~] #</p>
</blockquote>
<blockquote>
<p>[root@xxx ~] # cd /</p>
</blockquote>
<blockquote>
<p>[root@xxx /] # ls</p>
</blockquote>
<blockquote>
<p>bins boot dev etc home ..</p>
</blockquote>
<h2 id="vim">vim</h2>
<p><a id="markdown-vim" name="vim"></a></p>
<blockquote>
<p>[root@xxx ~] # cd aa/</p>
</blockquote>
<blockquote>
<p>[root@xxx aa] # vim bb.cfg</p>
</blockquote>
<ul>
<li>i edit</li>
<li>yy copy the current row</li>
<li>nums yy (3 yy copy 3 rows)</li>
<li>y copy Paragraph (y 8 y)</li>
<li>y$ copy from current position to the end of line in vi</li>
<li>p past</li>
<li>nums p (5 p past 5 five times)</li>
<li>u undo the last change</li>
<li>dd delete the current row</li>
<li>d delete n row (d$)</li>
<li>x del</li>
<li>X backspace</li>
<li>yw copy one word</li>
<li>dw delete one word</li>
<li>shift + 6 move to  row header</li>
<li>:w save</li>
<li>:q quit</li>
<li>:wq save and quit</li>
<li>:q! quit without save</li>
<li>/ n search next, N search above</li>
<li>:s/old/new replace the first old to new</li>
<li>:s/old/new/g replace all old to new</li>
<li>:q! quit without save</li>
</ul>
<h2 id="ip-address-and-gateway">ip address and gateway</h2>
<p><a id="markdown-ip-address-and-gateway" name="ip-address-and-gateway"></a></p>
<blockquote>
<p>[root@xxx ~] # ping <a href="http://www.google.com">www.google.com</a></p>
</blockquote>
<p>host ip address</p>
<p>IPv4</p>
<p><strong>virtual mathine to host ip address</strong></p>
<blockquote>
<p>[root@xxx ~] # ping 192.168.2.102</p>
</blockquote>
<p><strong>host ip address to virtual mathine</strong></p>
<blockquote>
<p>[root@xxx ~] # ifconfig</p>
</blockquote>
<p>ens33: inet 192.168.111.129</p>
<p>window system:
cmd</p>
<blockquote>
<p>C:Users\riley&gt; ping 192.168.111.129</p>
</blockquote>
<h3 id="setting-up-static-ip-address-for-virtual-machine">setting up static IP address for virtual machine</h3>
<p><a id="markdown-setting-up-static-ip-address-for-virtual-machine" name="setting-up-static-ip-address-for-virtual-machine"></a></p>
<ol>
<li>
<p>图形化界面 -》 系统工具 -》 设置 -》 网络 -》有线 -》 IPv4 -》手动</p>
</li>
<li>
<p>root@xxx ~</p>
</li>
</ol>
<blockquote>
<p>[root@xxx ~] # vim /etc/sysconfig/network-scripts/ifcfg-ens33</p>
</blockquote>
<p><strong>hit <code>Tab</code> while typing a command, option, or file name and the shell environment will automatically complete what you&rsquo;re typing or suggest options to you</strong></p>
<blockquote>
<p>BOOTPROTO=&ldquo;dhcp&rdquo; // 动态 ip</p>
</blockquote>
<blockquote>
<p>BOOTPROTO=&ldquo;static&rdquo;</p>
</blockquote>
<p><strong>快速移动光标到第四行， 4 shift + G</strong></p>
<p><strong>快速移动光标到单词 w</strong></p>
<p><strong>删除 dhcp， dw</strong></p>
<p><strong>i， 进入插入模式</strong></p>
<blockquote>
<p>IP address</p>
</blockquote>
<blockquote>
<p>IPADDR=192.168.202.100</p>
</blockquote>
<blockquote>
<p>GATEWAY=192.168.202.2</p>
</blockquote>
<blockquote>
<p>DNS1=192.168.202.2</p>
</blockquote>
<h3 id="change-hostname">change hostname</h3>
<p><a id="markdown-change-hostname" name="change-hostname"></a></p>
<blockquote>
<p>[root@xxx ~] # hostnamectl set- hostname yyy</p>
</blockquote>
<blockquote>
<p>[root@xxx ~] # hostname</p>
</blockquote>
<p>会显示</p>
<blockquote>
<p>yyy</p>
</blockquote>
<h3 id="hosts">hosts</h3>
<p><a id="markdown-hosts" name="hosts"></a></p>
<blockquote>
<p>[root@xxx ~] # vim /etc/host</p>
</blockquote>
<blockquote>
<p>[root@xxx ~] # vim /etc/hosts</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1 localhost
::1

192.168.202.100 xxx
192.168.202.101 xx1
192.168.202.102 xx2
192.168.202.103 xx3
192.168.202.104 xx4
</code></pre></div><p>windows -&gt; system32 -&gt; drivers -&gt; hosts</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">192.168.202.100 xxx
192.168.202.101 xx1
192.168.202.102 xx2
192.168.202.103 xx3
192.168.202.104 xx4
</code></pre></div><h3 id="use-ssh-to-connect-to-a-remote-server-in-linux">use SSH to Connect to a Remote Server in Linux</h3>
<p><a id="markdown-use-ssh-to-connect-to-a-remote-server-in-linux" name="use-ssh-to-connect-to-a-remote-server-in-linux"></a></p>
<blockquote>
<p>C:Users\riley&gt;ssh root@xxx</p>
</blockquote>
<h2 id="systemctl">systemctl</h2>
<p><a id="markdown-systemctl" name="systemctl"></a></p>
<p><strong>systemctl start | stop | restart | status 服务名</strong></p>
<blockquote>
<p>[root@xxx ~] # ls /usr/sbin/ |grep service</p>
</blockquote>
<p>service</p>
<blockquote>
<p>[root@xxx ~] # ls /usr/lib/systemd</p>
</blockquote>
<p><strong>centos 7 默认网络服务是 Networkmanager</strong></p>
<p>所以网路如果不同，检查防火墙，虚拟机能 ping 通物理机， 但是虚拟机 ping 不通外网，都是 DNS</p>
<p>虚拟机 ping <a href="http://www.baidu.com">www.baidu.com</a> 显示域名未知，检查 GATEWAY， DNS</p>
<p>最后关闭 network，启动 wetworkManager</p>
<p>擦看下他们的状态</p>
<blockquote>
<p>[root@xxx ~] # systemctl status network</p>
</blockquote>
<blockquote>
<p>[root@xxx ~] # systemctl status NetworkManager</p>
</blockquote>
<p>发现他们状态都是 active， 最好关掉上一个，避免冲突</p>
<blockquote>
<p>[root@xxx ~] # systemctl stop network</p>
</blockquote>
<blockquote>
<p>[root@xxx ~] # systemctl restart network</p>
</blockquote>
<h2 id="commands">commands</h2>
<p><a id="markdown-commands" name="commands"></a></p>
<ul>
<li>pwd, (print working directory)shows current dir absolute path</li>
<li>ls</li>
<li>cd</li>
</ul>
<blockquote>
<p>[root@xxx ~] # cd /ect/sysconfig/</p>
</blockquote>
<blockquote>
<p>[root@xxx sysconfig] # cd /root/destop/</p>
</blockquote>
<p><strong>当 video 和 destop 在同一级上，就用相对路径</strong></p>
<blockquote>
<p>[root@xxx sysconfig] # cd ../video/</p>
</blockquote>
<p>../ 是以当前目前的上一级的意思， 如果是绝对路径一定是 / 开头</p>
<ul>
<li>cd -</li>
</ul>
<p>两个位置跳</p>
<blockquote>
<p>[root@xxx ~] # cd /ect/sysconfig/</p>
</blockquote>
<blockquote>
<p>[root@xxx sysconfig] # cd -</p>
</blockquote>
<p>/root</p>
<blockquote>
<p>[root@xxx sysconfig] # cd -</p>
</blockquote>
<p>/ect/sysconfig</p>
<ul>
<li>
<p>su 切换用户</p>
</li>
<li>
<p>ls -a/-l</p>
</li>
<li>
<p>mkdir dirname (make directory)</p>
</li>
<li>
<p>mkdir -p g/h/i (根目录下创建 g， g 下面)</p>
</li>
<li>
<p>rmdir (remove directory)</p>
</li>
<li>
<p>rmdir -p g/h/i/ (删除根目录下 g， g 下面)</p>
</li>
</ul>
<h3 id="touch">touch</h3>
<p><a id="markdown-touch" name="touch"></a></p>
<h3 id="cp-cp-r">cp cp-r</h3>
<p><a id="markdown-cp-cp-r" name="cp-cp-r"></a></p>
<h3 id="rm">rm</h3>
<p><a id="markdown-rm" name="rm"></a></p>
<p>删除文件夹</p>
<blockquote>
<p>rm -rf a/</p>
</blockquote>
<blockquote>
<p>[root@xxx xxx] ls</p>
</blockquote>
<blockquote>
<p>aa bb cc</p>
</blockquote>
<p>如果保留 xxx， 把里面的 3 文件全删除？</p>
<blockquote>
<p>[root@xxx xxx] rm -f ./*</p>
</blockquote>
<p>./表示当前目录</p>
<h3 id="mv">mv</h3>
<p><a id="markdown-mv" name="mv"></a></p>
<ul>
<li>mv oldName newName</li>
<li>mv /temp/movefile /targetfolder</li>
</ul>
<h3 id="cat">cat</h3>
<p><a id="markdown-cat" name="cat"></a></p>
<p>查看文件小行数短的文件</p>
<h3 id="more">more</h3>
<p><a id="markdown-more" name="more"></a>
查看可以翻页的， space 翻到下一页，enter 下一行</p>
<h3 id="less">less</h3>
<p><a id="markdown-less" name="less"></a>
动态加载显示需要加载的文件，文件很大的时候</p>
<h3 id="echo">echo</h3>
<p><a id="markdown-echo" name="echo"></a></p>
<p>echo [选项][输出内容]</p>
<blockquote>
<p>[root@xxx xxx] echo hello, world</p>
</blockquote>
<blockquote>
<p>hello, world</p>
</blockquote>
<h3 id="-">&gt; &raquo;</h3>
<p><a id="markdown-%3E-%3E%3E" name="%3E-%3E%3E"></a></p>
<p>· &gt; 输出重定向
. &raquo;追加</p>
<ul>
<li>ls -l &gt; file ：列表的内容写入文件 a.txt 覆盖写</li>
</ul>
<blockquote>
<p>[root@xxx xxx] ls -l &gt; aaa.text</p>
</blockquote>
<ul>
<li>ls -l &raquo; file ：列表的内容追加到文件 a.txt 末尾</li>
</ul>
<blockquote>
<p>[root@xxx xxx] ls -l &raquo; aaa.text</p>
</blockquote>
<ul>
<li>
<p>cat file 1 &gt; file 2 ：文件 1 内容覆盖到 文件 2</p>
</li>
<li>
<p>echo 内容 &raquo; file  ：内容追加到文件</p>
</li>
</ul>
<h3 id="head">head</h3>
<p><a id="markdown-head" name="head"></a></p>
<ul>
<li>head 文件： 查看文件前 10 行</li>
<li>head -n n 行</li>
</ul>
<h3 id="tail">tail</h3>
<p><a id="markdown-tail" name="tail"></a></p>
<ul>
<li>tail 文件： 查看文件后 10 行</li>
<li>tail -n n 行</li>
<li><strong>tail -f</strong> ： 追踪文章的所有更新</li>
</ul>
<blockquote>
<p>[root@xxx xxx] tail -f info</p>
</blockquote>
<p>事实监控, 文件修改的话会显示出来</p>
<h3 id="ln">ln</h3>
<p><a id="markdown-ln" name="ln"></a></p>
<ul>
<li>
<p>ln -s[old file or dir][软连接名]</p>
</li>
<li>
<p><strong>rm -rf 软连接名, 而不是 rm -rf 软连接名/，  rm -rf 软连接名/ 会删除下面的内容</strong></p>
</li>
</ul>
<blockquote>
<p>[root@xxx ]# ls
aa.cfg bb cc</p>
</blockquote>
<p>建立和 bb 的连接</p>
<blockquote>
<p>[root@xxx ]# cd /home/folds/</p>
</blockquote>
<blockquote>
<p>[root@xxx folds]# ln -s /root/bb myInfo</p>
</blockquote>
<blockquote>
<p>[root@xxx folds]# ls</p>
</blockquote>
<blockquote>
<p>myinfo</p>
</blockquote>
<p>点开 myinfo 和 bb 文件内容是一样的</p>
<ul>
<li>ln -s[old file or dir][软连接名]</li>
</ul>
<p><strong>连接文件或者文件夹</strong></p>
<h2 id="usercommand">UserCommand</h2>
<p><a id="markdown-usercommand" name="usercommand"></a></p>
<h3 id="useradd">useradd</h3>
<p><a id="markdown-useradd" name="useradd"></a></p>
<ul>
<li>useradd 用户名</li>
<li>useradd -g 组名 用户名</li>
</ul>
<blockquote>
<p>[root@xxx ~]# cd /home</p>
</blockquote>
<blockquote>
<p>[root@xxx home]# ls</p>
</blockquote>
<p>aaa</p>
<blockquote>
<p>[root@xxx home]# useradd bb</p>
</blockquote>
<blockquote>
<p>[root@xxx home]# useradd -d /home/folder cc</p>
</blockquote>
<h3 id="passwd">passwd</h3>
<p><a id="markdown-passwd" name="passwd"></a></p>
<ul>
<li>passwd 用户名</li>
</ul>
<h3 id="sudo-临时给用户加入管理员权限">sudo 临时给用户加入管理员权限</h3>
<p><a id="markdown-sudo-%E4%B8%B4%E6%97%B6%E7%BB%99%E7%94%A8%E6%88%B7%E5%8A%A0%E5%85%A5%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90" name="sudo-%E4%B8%B4%E6%97%B6%E7%BB%99%E7%94%A8%E6%88%B7%E5%8A%A0%E5%85%A5%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90"></a></p>
<p>在 root 权限下面复制，把 root 改为 用户
<figure><img src="/images/linux3.png"
         alt="image"/><figcaption>
            <h4>sudo</h4>
        </figcaption>
</figure>
</p>
<figure><img src="/images/linux4.png"
         alt="image"/><figcaption>
            <h4>sudo</h4>
        </figcaption>
</figure>

<h3 id="usermod-修改使用者的参数和资料">usermod 修改使用者的参数和资料</h3>
<p><a id="markdown-usermod-%E4%BF%AE%E6%94%B9%E4%BD%BF%E7%94%A8%E8%80%85%E7%9A%84%E5%8F%82%E6%95%B0%E5%92%8C%E8%B5%84%E6%96%99" name="usermod-%E4%BF%AE%E6%94%B9%E4%BD%BF%E7%94%A8%E8%80%85%E7%9A%84%E5%8F%82%E6%95%B0%E5%92%8C%E8%B5%84%E6%96%99"></a></p>
<blockquote>
<p>[aa@xxx root]$ id aa</p>
</blockquote>
<blockquote>
<p>uid=1000(aa) gid=1000(aa) group=1000(aa), 10(wheel)</p>
</blockquote>
<p>10(wheel)是管理组，在里面的可以进行任何操作</p>
<blockquote>
<p>[aa@xxx root]$ id root</p>
</blockquote>
<blockquote>
<p>uid=0(root) gid=0(root) group=0(root)</p>
</blockquote>
<blockquote>
<p>[aa@xxx root]$ id bb</p>
</blockquote>
<blockquote>
<p>uid=1001(bb) gid=1001(bb) group=1001(bb)</p>
</blockquote>
<blockquote>
<p>[aa@xxx root]$ id cc</p>
</blockquote>
<blockquote>
<p>uid=1002(cc) gid=1002(cc) group=1002(cc)</p>
</blockquote>
<p>查看组</p>
<blockquote>
<p>[aa@xxx root]$ sudo cat /etc/group</p>
</blockquote>
<p>添加组</p>
<blockquote>
<p>[root@xxx ]# groupadd zu</p>
</blockquote>
<p>修改用户所在组</p>
<blockquote>
<p>[root@xxx ]# usermod -g zu bb</p>
</blockquote>
<blockquote>
<p>[root@xxx ]# usermod -g zu cc</p>
</blockquote>
<p>查看</p>
<blockquote>
<p>[aa@xxx root]$ id bb</p>
</blockquote>
<blockquote>
<p>uid=1001(bb) gid=1003(zu) group=1003(zu)</p>
</blockquote>
<blockquote>
<p>[aa@xxx root]$ id cc</p>
</blockquote>
<blockquote>
<p>uid=1002(cc) gid=1003(zu) group=1003(zu)</p>
</blockquote>
<p>修改组信息</p>
<blockquote>
<p>[root@xxx ]# groupmod -n zuNewName zu</p>
</blockquote>
<blockquote>
<p>[aa@xxx root]$ id bb</p>
</blockquote>
<blockquote>
<p>uid=1001(bb) gid=1003(zuNewName) group=1003(zuNewName)</p>
</blockquote>
<p>删除组</p>
<blockquote>
<p>[root@xxx ]# groupdel bb</p>
</blockquote>
<blockquote>
<p>[root@xxx ]# groupdel cc</p>
</blockquote>
<h2 id="文件权限">文件权限</h2>
<p><a id="markdown-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90" name="%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"></a></p>
<h3 id="chmod">chmod</h3>
<p><a id="markdown-chmod" name="chmod"></a></p>
<ul>
<li>chmod [{ugoa}{+-=}{rwx}] 文件或目录</li>
</ul>
<p><strong>案例</strong></p>
<blockquote>
<p>[root@xxx ]# useradd -g bigdata xiaoming</p>
</blockquote>
<blockquote>
<p>[root@xxx ]# useradd -g bigdata xiaoliang</p>
</blockquote>
<blockquote>
<p>[root@xxx ]# useradd -g testing xiaohong</p>
</blockquote>
<blockquote>
<p>[root@xxx ]# useradd -g testing xiaolan</p>
</blockquote>
<blockquote>
<p>[root@xxx ]# cd /home</p>
</blockquote>
<blockquote>
<p>[root@xxx home]# ls</p>
</blockquote>
<blockquote>
<p>xiaoming xiaoliang xiaohong xiaolan</p>
</blockquote>
<p><strong>切换到小明</strong></p>
<blockquote>
<p>[root@xxx home]# su xiaoming</p>
</blockquote>
<p><strong>切换主目录</strong></p>
<blockquote>
<p>[xiaoming@xxx home]$ cd -</p>
</blockquote>
<blockquote>
<p>[xiaoming@xxx ~]$ ls</p>
</blockquote>
<p><strong>创建一个文件</strong></p>
<blockquote>
<p>[xiaoming@xxx ~]$ vim filea</p>
</blockquote>
<p><strong>查看权限</strong></p>
<blockquote>
<p>[xiaoming@xxx ~]$ ll</p>
</blockquote>
<p>-rw-r&ndash;r&ndash;</p>
<p>退出，切换</p>
<blockquote>
<p>[xiaoming@xxx ~]$ exit</p>
</blockquote>
<p><strong>切换到小亮</strong></p>
<blockquote>
<p>[root@xxx home]# su xiaoliang</p>
</blockquote>
<blockquote>
<p>[xiaoliang@xxx home]$ cd -</p>
</blockquote>
<p><strong>想进入小明目录</strong></p>
<blockquote>
<p>[xiaoliang@xxx home]$ cd ../xiaoming/</p>
</blockquote>
<p>bash: &hellip;权限不够</p>
<p><strong>修改权限</strong></p>
<blockquote>
<p>[xiaoliang@xxx ~]$ exit</p>
</blockquote>
<blockquote>
<p>[root@xxx home]# ll</p>
</blockquote>
<p>drwx&mdash;&mdash; 5 bigdata .. xiaoming</p>
<blockquote>
<p>[root@xxx home]# chmod g+x xiaoming/</p>
</blockquote>
<p><strong>切换到小亮</strong></p>
<blockquote>
<p>[root@xxx home]# su xiaoliang</p>
</blockquote>
<blockquote>
<p>[xiaoliang@xxx home]$ cd xiaoming/</p>
</blockquote>
<blockquote>
<p>[xiaoliang@xxx xiaoming]$ ll</p>
</blockquote>
<p><strong>ls：无法打开：权限不够， 因为 x 是进入，但是没有 r</strong></p>
<blockquote>
<p>[root@xxx home]# chmod g+r xiaoming/</p>
</blockquote>
<p><strong>查看</strong></p>
<blockquote>
<p>[xiaoliang@xxx xiaoming]$ cat filea</p>
</blockquote>
<p>如果要修改，去小明用户那修改文件权限</p>
<h3 id="find">find</h3>
<p><a id="markdown-find" name="find"></a></p>
<ul>
<li>find -name</li>
<li>find -user</li>
<li>find -size</li>
</ul>
<h3 id="location">location</h3>
<p><a id="markdown-location" name="location"></a></p>
<h3 id="grep">grep</h3>
<p><a id="markdown-grep" name="grep"></a></p>
<p>&ldquo;|&rdquo; 将前一个命令的处理结果输出传递给后面的命令处理</p>
<p><strong>-n 显示匹配行和行号</strong></p>
<blockquote>
<p>[root@xxx ~]# ls | grep -n test</p>
</blockquote>
<p><strong>关键词中的文件</strong></p>
<blockquote>
<p>[root@xxx ~]# grep -n aaa filea.cfg</p>
</blockquote>
<blockquote>
<p>[root@xxx ~]# ls | grep .cfg</p>
</blockquote>
<h3 id="gzip-and-gunzip">gzip and gunzip</h3>
<p><a id="markdown-gzip-and-gunzip" name="gzip-and-gunzip"></a></p>
<p>递归压缩</p>
<blockquote>
<p>[root@xxx ~]# zip -r newfolder.zip /root</p>
</blockquote>
<h3 id="tar">tar</h3>
<p><a id="markdown-tar" name="tar"></a></p>
<p>tar -z 打包并压缩</p>
<blockquote>
<p>[root@xxx ~]# tar -zcvf tar.gz filea fileb dir/</p>
</blockquote>
<ul>
<li>-c 产生.tar 打包文件</li>
<li>-v 显示详细信息</li>
<li>-f 指定压缩后的文件名</li>
</ul>
<blockquote>
<p>[root@xxx ~]# tar -zcvf temp.tar.gz -C /tmp</p>
</blockquote>
<ul>
<li>-x 解包 .tar 文件</li>
<li>-C 解包到指定目录</li>
</ul>
<h2 id="disk">disk</h2>
<p><a id="markdown-disk" name="disk"></a></p>
<h3 id="tree">tree</h3>
<p><a id="markdown-tree" name="tree"></a></p>
<blockquote>
<p>[root@xxx ~]# yum install tree</p>
</blockquote>
<blockquote>
<p>[root@xxx ~]# tree ./</p>
</blockquote>
<p>以 tree 查看层级结构</p>
<h3 id="du">du</h3>
<p><a id="markdown-du" name="du"></a></p>
<p>du: disk usage</p>
<p>-s 只显示总和， -a 目录还有文件</p>
<blockquote>
<p>[root@xxx ~]# du -sh</p>
</blockquote>
<p>-s 只显示总和</p>
<p>子目录深度</p>
<blockquote>
<p>[root@xxx ~]# du &ndash;max-depth=1 -ah</p>
</blockquote>
<h2 id="shell">shell</h2>
<p><a id="markdown-shell" name="shell"></a></p>
<blockquote>
<p>[root@xxx script]# vim a.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="nb">echo</span> <span class="s2">&#34;hello, world&#34;</span>
</code></pre></div><h3 id="运行脚本">运行脚本</h3>
<p><a id="markdown-%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC" name="%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC"></a></p>
<h4 id="sh-脚本的相对路径">sh+ 脚本的相对路径</h4>
<p><a id="markdown-sh%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84" name="sh%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84"></a></p>
<blockquote>
<p>[aa@xxx script]$ sh ./hellowworld.sh</p>
</blockquote>
<h4 id="sh-脚本的绝对路径">sh+ 脚本的绝对路径</h4>
<p><a id="markdown-sh%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84" name="sh%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"></a></p>
<blockquote>
<p>[aa@xxx script]$ sh /home/aa/shells/hellowworld.sh</p>
</blockquote>
<h4 id="bash-脚本的相对路径">bash+ 脚本的相对路径</h4>
<p><a id="markdown-bash%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84" name="bash%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84"></a></p>
<blockquote>
<p>[aa@xxx script]$ bash ./hellowworld.sh</p>
</blockquote>
<h4 id="bash-脚本的相对路径-1">bash+ 脚本的相对路径</h4>
<p><a id="markdown-bash%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84" name="bash%2B-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84"></a></p>
<blockquote>
<p>[aa@xxx script]$ bash /home/aa/shells/hellowworld.sh</p>
</blockquote>
<h4 id="直接输入脚本的相对或绝对路径">直接输入脚本的相对或绝对路径</h4>
<p><a id="markdown-%E7%9B%B4%E6%8E%A5%E8%BE%93%E5%85%A5%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E6%88%96%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84" name="%E7%9B%B4%E6%8E%A5%E8%BE%93%E5%85%A5%E8%84%9A%E6%9C%AC%E7%9A%84%E7%9B%B8%E5%AF%B9%E6%88%96%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"></a></p>
<blockquote>
<p>[aa@xxx script]$  ./hellowworld.sh</p>
</blockquote>
<p>权限不够的话，加入 x 的权限</p>
<blockquote>
<p>[root@xxx ~]$  chmod +x script/hellowworld.sh</p>
</blockquote>
<blockquote>
<p>[aa@xxx script]$ ./hellowworld.sh</p>
</blockquote>
<h4 id="source-更好的方式">source 更好的方式</h4>
<p><a id="markdown-source-%E6%9B%B4%E5%A5%BD%E7%9A%84%E6%96%B9%E5%BC%8F" name="source-%E6%9B%B4%E5%A5%BD%E7%9A%84%E6%96%B9%E5%BC%8F"></a></p>
<blockquote>
<p>[root@xxx script]# source /root/script/hellowworld.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# source hellowworld.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# . hellowworld.sh</p>
</blockquote>
<h2 id="变量">变量</h2>
<p><a id="markdown-%E5%8F%98%E9%87%8F" name="%E5%8F%98%E9%87%8F"></a></p>
<blockquote>
<p>[root@xxx script]# a=2</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# echo $2</p>
</blockquote>
<p>2</p>
<blockquote>
<p>[root@xxx script]# echo $my_var</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# echo $my_var=hello</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# echo $my_var</p>
</blockquote>
<p>hello</p>
<h3 id="运算符">运算符</h3>
<p><a id="markdown-%E8%BF%90%E7%AE%97%E7%AC%A6" name="%E8%BF%90%E7%AE%97%E7%AC%A6"></a></p>
<blockquote>
<p>[root@xxx script]# a=1+5</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# echo $a</p>
</blockquote>
<p>1+5</p>
<p><strong>运算</strong></p>
<blockquote>
<p>[root@xxx script]# a=$((1+5))</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# a=$[1+5]</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# echo $a</p>
</blockquote>
<p>5</p>
<h3 id="计算">计算</h3>
<p><a id="markdown-%E8%AE%A1%E7%AE%97" name="%E8%AE%A1%E7%AE%97"></a></p>
<blockquote>
<p>[root@xxx script]# expr 1 + 5</p>
</blockquote>
<h3 id="脚本计算">脚本计算</h3>
<p><a id="markdown-%E8%84%9A%E6%9C%AC%E8%AE%A1%E7%AE%97" name="%E8%84%9A%E6%9C%AC%E8%AE%A1%E7%AE%97"></a></p>
<blockquote>
<p>[root@xxx ~]# cd script/</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# vim add.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="nv">sum</span><span class="o">=</span>$<span class="o">[</span><span class="nv">$1</span> + <span class="nv">$2</span><span class="o">]</span>
<span class="nb">echo</span> sum
</code></pre></div><p><strong>修改权限</strong></p>
<blockquote>
<p>[root@xxx script]# chmod +x add.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# ./add.sh 25 89</p>
</blockquote>
<p>sum=114</p>
<h3 id="条件判断">条件判断</h3>
<p><a id="markdown-%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD" name="%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"></a></p>
<blockquote>
<p>[root@xxx script]# a=hello</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# test $a = hello</p>
</blockquote>
<p><strong>要返回值</strong></p>
<blockquote>
<p>[root@xxx script]# echo $?</p>
</blockquote>
<p>0 // 0 是对</p>
<p><strong>不用写 test， 直接用[], 注意空格</strong></p>
<blockquote>
<p>[root@xxx script]# a=hello</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# [ $a = hello ]</p>
</blockquote>
<h3 id="用-test-测出某个文件是否有相应权限">用 test 测出某个文件是否有相应权限</h3>
<p><a id="markdown-%E7%94%A8-test-%E6%B5%8B%E5%87%BA%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E6%9C%89%E7%9B%B8%E5%BA%94%E6%9D%83%E9%99%90" name="%E7%94%A8-test-%E6%B5%8B%E5%87%BA%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E6%9C%89%E7%9B%B8%E5%BA%94%E6%9D%83%E9%99%90"></a></p>
<blockquote>
<p>[root@xxx script]# [ -r heelo.sh ]</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# [ -r test ]</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# echo $?</p>
</blockquote>
<p>0 代表 有， 1 没有</p>
<h3 id="用-test-判断是否存在">用 test 判断是否存在</h3>
<p><a id="markdown-%E7%94%A8-test-%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8" name="%E7%94%A8-test-%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"></a></p>
<blockquote>
<p>[root@xxx script]# [ -e /home/aa/info ]</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# echo $?</p>
</blockquote>
<ul>
<li>-e 是否存在</li>
<li>-f 是不是文件</li>
<li>-d 是不是目录</li>
</ul>
<h3 id="条件">条件</h3>
<p><a id="markdown-%E6%9D%A1%E4%BB%B6" name="%E6%9D%A1%E4%BB%B6"></a></p>
<blockquote>
<p>[root@xxx script]# a=15</p>
</blockquote>
<blockquote>
<p>[root@xxx script]# [ $a - lt 20 ] &amp;&amp; echo &ldquo;$a &lt; 20&rdquo; || echo &ldquo;$a &gt;= 20&rdquo;</p>
</blockquote>
<blockquote>
<p>[root@xxx script]#</p>
</blockquote>
<p>上面类似 ？ ：</p>
<h2 id="流程控制">流程控制</h2>
<p><a id="markdown-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6" name="%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"></a></p>
<h3 id="if-单分支">if 单分支</h3>
<p><a id="markdown-if-%E5%8D%95%E5%88%86%E6%94%AF" name="if-%E5%8D%95%E5%88%86%E6%94%AF"></a></p>
<ul>
<li><strong>if; then</strong></li>
</ul>
<blockquote>
<p>[root@xxx ~]# cd /home/aa/info/; ls -l</p>
</blockquote>
<blockquote>
<p>rw-r&ndash;r&ndash;, l root..</p>
</blockquote>
<blockquote>
<p>[root@xxx info]# cd ~</p>
</blockquote>
<blockquote>
<p>[root@xxx ~]# a=25</p>
</blockquote>
<blockquote>
<p>[root@xxx ~]# if [ $a -gt 18 ]; then echo OK; fi</p>
</blockquote>
<p><strong>用脚本控制</strong></p>
<blockquote>
<p>[root@xxx ~]# cd aa/</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# vim if_test.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="k">if</span> $<span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span><span class="nv">x</span> <span class="o">=</span> <span class="s2">&#34;aa&#34;</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;welcome, aa&#34;</span>
<span class="k">fi</span>
</code></pre></div><blockquote>
<p>[root@xxx aa]# chmod +x if_test.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# ./if_test.sh aa</p>
</blockquote>
<p>&ldquo;welcome, aa&rdquo;</p>
<blockquote>
<p>[root@xxx aa]# ./if_test.sh bb // 无效</p>
</blockquote>
<p><strong>判断出现在[] -a 代表[] &amp;&amp; []</strong></p>
<blockquote>
<p>[root@xxx ~]# if [ $a -gt 18 -a $a -lt 38 ]; then echo OK; fi</p>
</blockquote>
<h3 id="if-多分支">if 多分支</h3>
<p><a id="markdown-if-%E5%A4%9A%E5%88%86%E6%94%AF" name="if-%E5%A4%9A%E5%88%86%E6%94%AF"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span><span class="nv">x</span> <span class="o">=</span> <span class="s2">&#34;aa&#34;</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;welcome, aa&#34;</span>
<span class="k">fi</span>

<span class="c1"># 输入第二个参数， 代表年龄，判断属于哪个年龄段</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$2</span> -lt <span class="m">18</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;未成年人&#34;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;成年人&#34;</span>
<span class="k">fi</span>
</code></pre></div><blockquote>
<p>[root@xxx aa]# ./if_test.sh aa 15</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# ./if_test.sh aa 35</p>
</blockquote>
<h3 id="elif-多分支">elif 多分支</h3>
<p><a id="markdown-elif-%E5%A4%9A%E5%88%86%E6%94%AF" name="elif-%E5%A4%9A%E5%88%86%E6%94%AF"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span><span class="nv">x</span> <span class="o">=</span> <span class="s2">&#34;aa&#34;</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;welcome, aa&#34;</span>
<span class="k">fi</span>

<span class="c1"># 输入第二个参数， 代表年龄，判断属于哪个年龄段</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$2</span> -lt <span class="m">18</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;未成年人&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nv">$2</span> -lt <span class="m">35</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;青年人&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="nv">$2</span> -lt <span class="m">60</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;中年人&#34;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;老年人&#34;</span>
<span class="k">fi</span>
</code></pre></div><p><strong>计算</strong></p>
<blockquote>
<p>[root@xxx aa]# a=3</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# if (($a &gt; 2)); then echo OK; else echo notOK; fi</p>
</blockquote>
<h3 id="case-分支">case 分支</h3>
<p><a id="markdown-case-%E5%88%86%E6%94%AF" name="case-%E5%88%86%E6%94%AF"></a></p>
<blockquote>
<p>[root@xxx aa]# vim case.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>

<span class="k">case</span> <span class="nv">$1</span> in
1<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&#34;one&#34;</span>
<span class="c1"># ;; = break;</span>
<span class="p">;;</span>
2<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&#34;two&#34;</span>
<span class="p">;;</span>
3<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&#34;three&#34;</span>
<span class="p">;;</span>
<span class="c1"># *) = default;</span>
*<span class="o">)</span>
    <span class="nb">echo</span> <span class="s2">&#34;number 4&#34;</span>
<span class="p">;;</span>
<span class="k">esac</span>
</code></pre></div><blockquote>
<p>[root@xxx aa]# chmod +x case.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# ./case.sh 2</p>
</blockquote>
<blockquote>
<p>two</p>
</blockquote>
<h3 id="for-循环">for 循环</h3>
<p><a id="markdown-for-%E5%BE%AA%E7%8E%AF" name="for-%E5%BE%AA%E7%8E%AF"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span> <span class="o">((</span>初始值<span class="p">;</span> 循环控制条件<span class="p">;</span>变量变化<span class="o">))</span>
<span class="k">do</span>
    程序
<span class="k">done</span>
</code></pre></div><h4 id="从-1-加到-100">从 1 加到 100</h4>
<p><a id="markdown-%E4%BB%8E-1-%E5%8A%A0%E5%88%B0-100" name="%E4%BB%8E-1-%E5%8A%A0%E5%88%B0-100"></a></p>
<blockquote>
<p>[root@xxx aa]# vim sum.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>

<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span>1<span class="p">;</span> i &lt;<span class="o">=</span> <span class="nv">$1</span><span class="p">;</span> i++<span class="o">))</span>
<span class="k">do</span>
    <span class="nv">sum</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$sum</span> + <span class="nv">$i</span> <span class="o">]</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum</span>
</code></pre></div><blockquote>
<p>[root@xxx aa]# chmod +x case.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# ./case.sh 100</p>
</blockquote>
<blockquote>
<p>5050</p>
</blockquote>
<h4 id="更常见的-for">更常见的 for</h4>
<p><a id="markdown-%E6%9B%B4%E5%B8%B8%E8%A7%81%E7%9A%84-for" name="%E6%9B%B4%E5%B8%B8%E8%A7%81%E7%9A%84-for"></a></p>
<blockquote>
<p>[root@xxx aa]# for os in linux windows macos; do echo $os; done</p>
</blockquote>
<blockquote>
<p>linux</p>
</blockquote>
<blockquote>
<p>windows</p>
</blockquote>
<blockquote>
<p>macos</p>
</blockquote>
<p><strong>从 1 加到 100</strong></p>
<blockquote>
<p>[root@xxx aa]# for 1 in {1..100}; do sum=$[$sum+$i]; done; echo $sum</p>
</blockquote>
<p>5050</p>
<h3 id="-and-">$* and $@</h3>
<p><a id="markdown-%24*-and-%24%40" name="%24*-and-%24%40"></a></p>
<blockquote>
<p>[root@xxx aa]# vim parameter.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nb">echo</span> <span class="s1">&#39;===================$*=================&#39;</span>
<span class="k">for</span> para in <span class="nv">$*</span>
<span class="k">do</span> 
   <span class="nb">echo</span> <span class="nv">$para</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s1">&#39;===================$@=================&#39;</span>
<span class="k">for</span> para in <span class="nv">$@</span>
<span class="k">do</span> 
   <span class="nb">echo</span> <span class="nv">$para</span>
<span class="k">done</span>

</code></pre></div><blockquote>
<p>[root@xxx aa]# chmod +x parameter.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# ./parameter.sh a b c d e</p>
</blockquote>
<blockquote>
<p>===================$*================='
br
a
br
b
..
e</p>
</blockquote>
<blockquote>
<p>===================$@================='
br
a
br
b
..
e</p>
</blockquote>
<p><strong>加入引号后</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nb">echo</span> <span class="s1">&#39;===================$*=================&#39;</span>
<span class="k">for</span> para in <span class="s2">&#34;</span><span class="nv">$*</span><span class="s2">&#34;</span>
<span class="k">do</span> 
   <span class="nb">echo</span> <span class="nv">$para</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s1">&#39;===================$@=================&#39;</span>
<span class="k">for</span> para in <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
<span class="k">do</span> 
   <span class="nb">echo</span> <span class="nv">$para</span>
<span class="k">done</span>
</code></pre></div><blockquote>
<p>[root@xxx aa]# ./parameter.sh a b c d e</p>
</blockquote>
<blockquote>
<p>===================$*================='
br
a b c d e
br
===================$@================='
br
a
br
b
..
e</p>
</blockquote>
<p><strong>&quot;$*&quot; 会把参数当作一个整体， 而$@ 则是当初独立个体</strong></p>
<h3 id="while">while</h3>
<p><a id="markdown-while" name="while"></a></p>
<blockquote>
<p>[root@xxx aa]# vim sum.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nv">a</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span> <span class="o">[</span> <span class="nv">$a</span> -le <span class="nv">$1</span><span class="o">]</span>
<span class="k">do</span>
    <span class="nv">sum2</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$sum2</span> + <span class="nv">$a</span> <span class="o">]</span>
    <span class="nv">a</span><span class="o">=</span>$<span class="o">[</span><span class="nv">$a</span> + 1<span class="o">]</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum2</span>
</code></pre></div><blockquote>
<p>[root@xxx aa]# ./sum.sh 100</p>
</blockquote>
<blockquote>
<p>5050</p>
</blockquote>
<p><strong>更简便的写法 let</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nv">a</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span> <span class="o">[</span> <span class="nv">$a</span> -le <span class="nv">$1</span><span class="o">]</span>
<span class="k">do</span>
<span class="c1">#   sum2=$[ $sum2 + $a ]</span>
<span class="c1">#   a=$[$a + 1]</span>
    <span class="nb">let</span> <span class="nv">sum2</span><span class="o">+=</span>a
    <span class="nb">let</span> a++
<span class="k">done</span>
<span class="nb">echo</span> <span class="nv">$sum2</span>
</code></pre></div><h2 id="read">read</h2>
<p><a id="markdown-read" name="read"></a></p>
<p>read (选项) (参数)</p>
<ul>
<li>
<ol>
<li>选项：</li>
</ol>
<ul>
<li>-p: 指定读取值得提示符</li>
<li>-t：指定读取值时等待的时间(秒) 如果-t 不加表示一直等待</li>
</ul>
</li>
<li>
<ol start="2">
<li>参数：</li>
</ol>
<ul>
<li>变量</li>
</ul>
</li>
</ul>
<h2 id="提示-7-秒内-读取控制台输入的名称">提示 7 秒内， 读取控制台输入的名称</h2>
<p><a id="markdown-%E6%8F%90%E7%A4%BA-7-%E7%A7%92%E5%86%85%EF%BC%8C-%E8%AF%BB%E5%8F%96%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%85%A5%E7%9A%84%E5%90%8D%E7%A7%B0" name="%E6%8F%90%E7%A4%BA-7-%E7%A7%92%E5%86%85%EF%BC%8C-%E8%AF%BB%E5%8F%96%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%85%A5%E7%9A%84%E5%90%8D%E7%A7%B0"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nb">read</span> -t <span class="m">7</span> -p <span class="s2">&#34;Enter your name in 7 s :&#34;</span> name
<span class="nb">echo</span> <span class="s2">&#34;welcome, </span><span class="nv">$name</span><span class="s2">&#34;</span>
</code></pre></div><blockquote>
<p>[root@xxx aa]# ./read.sh</p>
</blockquote>
<blockquote>
<p>Enter your name in 7 s: AA</p>
</blockquote>
<blockquote>
<p>welcome, AA</p>
</blockquote>
<h2 id="函数">函数</h2>
<p><a id="markdown-%E5%87%BD%E6%95%B0" name="%E5%87%BD%E6%95%B0"></a></p>
<h3 id="系统函数">系统函数</h3>
<p><a id="markdown-%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0" name="%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0"></a></p>
<h4 id="basename">basename</h4>
<p><a id="markdown-basename" name="basename"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nv">filename</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span>_log_<span class="k">$(</span>date + %s<span class="k">)</span>

<span class="nb">echo</span> <span class="nv">$filename</span>
</code></pre></div><p><strong>非常有用的时间戳的文件名</strong></p>
<blockquote>
<p>[root@xxx aa]# basename ./cmd_test.sh YY</p>
</blockquote>
<blockquote>
<p>YY_log_156374785848</p>
</blockquote>
<h4 id="自定义函数">自定义函数</h4>
<p><a id="markdown-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0" name="%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="k">function</span> add<span class="o">()</span> <span class="o">{</span>
    <span class="nv">s</span><span class="o">=</span>$<span class="o">[</span><span class="nv">$1</span> + <span class="nv">$2</span><span class="o">]</span>
    <span class="nb">echo</span> <span class="s2">&#34;和： &#34;</span><span class="nv">$s</span>
<span class="o">}</span>
<span class="nb">read</span> -p <span class="s2">&#34;请输入第一个整数&#34;</span> a
<span class="nb">read</span> -p <span class="s2">&#34;请输入第二个整数&#34;</span>b

add <span class="nv">$a</span> <span class="nv">$b</span>
</code></pre></div><p>return 返回，如果不加，将最后一条命令结果，返回值 n(0 - 255)</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="k">function</span> add<span class="o">()</span> <span class="o">{</span>
    <span class="nv">s</span><span class="o">=</span>$<span class="o">[</span><span class="nv">$1</span> + <span class="nv">$2</span><span class="o">]</span>
    <span class="nb">echo</span> <span class="s2">&#34;和： &#34;</span><span class="nv">$s</span>
<span class="o">}</span>
<span class="nb">read</span> -p <span class="s2">&#34;请输入第一个整数&#34;</span> a
<span class="nb">read</span> -p <span class="s2">&#34;请输入第二个整数&#34;</span>b

<span class="nv">sum</span><span class="o">=</span><span class="k">$(</span>add <span class="nv">$a</span> <span class="nv">$b</span><span class="k">)</span>
<span class="nb">echo</span> <span class="s2">&#34;和： &#34;</span> <span class="nv">$sum</span>
<span class="nb">echo</span> <span class="s2">&#34;和平方： &#34;</span> $<span class="o">[</span><span class="nv">$sum</span> * <span class="nv">$sum</span><span class="o">]</span>
</code></pre></div><h2 id="归档文件应用">归档文件应用</h2>
<p><a id="markdown-%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6%E5%BA%94%E7%94%A8" name="%E5%BD%92%E6%A1%A3%E6%96%87%E4%BB%B6%E5%BA%94%E7%94%A8"></a></p>
<p><a href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=82&amp;spm_id_from=pageDriver"  target="_blank" >教程</a></p>
<p>需求： 实现一个每天指定目录归档备份的脚本，输入一个目录名称， 将目录下所有文件按天归档保存，并将归档日期附加在归档文件名上，放在 /root/archive 下。</p>
<blockquote>
<p>[root@xxx aa]# vim daily_archive.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1"># 首先判断输入参数个数是否为1</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ne <span class="m">1</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;参数个数错误！ 应该输入一个参数， 作为归档目录名&#34;</span>
    <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1"># 从参数中获取目录名称</span>
<span class="k">if</span> <span class="o">[</span> -d <span class="nv">$1</span> <span class="o">]</span> <span class="o">{</span>
<span class="k">then</span> 
    <span class="nb">echo</span> 
<span class="k">else</span> 
    <span class="nb">echo</span> // 相当于空一行
    <span class="nb">echo</span> <span class="s2">&#34;目录不存在&#34;</span>
    <span class="nb">echo</span>
    <span class="nb">exit</span>
<span class="k">fi</span>

// 获取绝对路径
<span class="nv">DIR_NAME</span><span class="o">=</span><span class="k">$(</span>basename <span class="nv">$1</span><span class="k">)</span>
<span class="nv">DIR_PATH</span><span class="o">=</span><span class="k">$(</span><span class="nb">cd</span> <span class="k">$(</span>dirname <span class="nv">$1</span><span class="k">)</span><span class="p">;</span> <span class="nb">pwd</span><span class="k">)</span>

<span class="c1"># 从获取当期日期</span>
<span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date + %y%m%d<span class="k">)</span>

<span class="c1"># 定义生成的归档文件名称</span>
<span class="nv">FILE</span><span class="o">=</span>archive_<span class="si">${</span><span class="nv">DIR_NAME</span><span class="si">}</span>_<span class="nv">$DATE</span>.tar.gz
<span class="nv">DEST</span><span class="o">=</span>/root/archive/<span class="nv">$FILE</span>

<span class="c1"># 开始归档目录文件</span>
<span class="nb">echo</span> <span class="s2">&#34;开始归档...&#34;</span>
<span class="nb">echo</span>

tar -czf <span class="nv">$DEST</span> <span class="nv">$DIR_PATH</span>/<span class="nv">$DIR_NAME</span>

<span class="c1"># 判断是否成功</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">0</span> <span class="o">]</span> 
<span class="k">then</span>
    <span class="nb">echo</span>
    <span class="nb">echo</span> <span class="s2">&#34;归档成功&#34;</span>
    <span class="nb">echo</span> <span class="s2">&#34;归档文件为： </span><span class="nv">$DEST</span><span class="s2">&#34;</span>
    <span class="nb">echo</span>
<span class="k">else</span> 
    <span class="nb">echo</span> <span class="s2">&#34;归档出现问题&#34;</span>
    <span class="nb">echo</span>
<span class="k">fi</span>

<span class="nb">exit</span>

</code></pre></div><blockquote>
<p>[root@xxx aa]# chomod u+x daily_archive.sh</p>
</blockquote>
<blockquote>
<p>[root@xxx aa]# ll</p>
</blockquote>
<p>用 bash， 所以不是 aa/</p>
<blockquote>
<p>[root@xxx aa]# ./daily_archive.sh ../aa</p>
</blockquote>
<p>// FILE=archive_${DIR_NAME}_$DATE.tar.gz</p>
<h3 id="加入定时任务">加入定时任务</h3>
<p><a id="markdown-%E5%8A%A0%E5%85%A5%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1" name="%E5%8A%A0%E5%85%A5%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"></a></p>
<blockquote>
<p>[root@xxx aa]# crontab -e</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 每天凌晨2点钟执行脚本, /root/aa是一个参数</span>
<span class="m">0</span> <span class="m">2</span> * * * /root/aa/daily_archive.sh /root/scripts

</code></pre></div><h2 id="发送消息">发送消息</h2>
<p><a id="markdown-%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF" name="%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF"></a></p>
<p>利用自带的 mesg 和 write 工具，向其他用户发送消息</p>
<p>**需求：**实现一个向某个用户快递发送消息的脚本，输入用户名作为第一个参数，后面直接跟要发送的消息。
脚本需要检测用户是否登录在系统中，是否打开消息功能，以及当前发送消息是否为空。</p>
<blockquote>
<p>[root@xxx scripts]# who
root &hellip;
aa &hellip;</p>
</blockquote>
<p>aa 在线的时候可以发送</p>
<blockquote>
<p>[root@xxx scripts]# mesg</p>
</blockquote>
<p>is y</p>
<blockquote>
<p>[root@xxx scripts]# who -T</p>
</blockquote>
<p>root + pts/0</p>
<p>aa + pts/1</p>
<ul>
<li>表示开启了消息</li>
</ul>
<p><strong>关闭消息</strong></p>
<blockquote>
<p>[root@xxx scripts]# mesg n</p>
</blockquote>
<blockquote>
<p>[root@xxx scripts]# who -T</p>
</blockquote>
<p>root - pts/0</p>
<p>aa + pts/1</p>
<p><strong>开启消息</strong></p>
<blockquote>
<p>[root@xxx scripts]# mesg y</p>
</blockquote>
<blockquote>
<p>[root@xxx scripts]# write aa pts/1</p>
</blockquote>
<p>hello, aa</p>
<p><strong>通过脚本</strong></p>
<blockquote>
<p>[root@xxx scripts]# vim send_msg.sh</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1">#查看用户是否登录</span>
<span class="c1"># -i，忽略大小写, -m最大数是第一个，有多个只选第一个</span>
<span class="c1">#awk -F&#39;:&#39; &#39; {print $1}&#39;表示以“：”分割字符串，打印第一个awk就是把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行各种分析处</span>
<span class="nv">login_user</span><span class="o">=</span><span class="k">$(</span>who <span class="p">|</span> grep -i -m <span class="m">1</span> <span class="nv">$1</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>

<span class="c1"># -z是否为空 zero</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="nv">$login_user</span> <span class="o">]</span>
<span class="k">then</span> 
    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> 不在线&#34;</span>
    <span class="nb">echo</span> <span class="s2">&#34;脚本退出&#34;</span>
    <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1"># 是否开启了消息</span>
<span class="nv">is_allowed</span><span class="o">=</span><span class="k">$(</span>who -T <span class="p">|</span> grep -i -m <span class="m">1</span> <span class="nv">$1</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$is_allowed</span> !<span class="o">=</span> <span class="s2">&#34;+&#34;</span> <span class="o">]</span>
<span class="k">then</span> 
    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> 没有开启消息功能&#34;</span>
    <span class="nb">echo</span> <span class="s2">&#34;脚本退出&#34;</span>
    <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1"># 确认是否有消息发送</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="nv">$2</span> <span class="o">]</span>
<span class="k">then</span> 
    <span class="nb">echo</span> <span class="s2">&#34;没有消息发送&#34;</span>
    <span class="nb">echo</span> <span class="s2">&#34;脚本退出&#34;</span>
    <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1"># 从参数中获取要发送的消息</span>
<span class="c1">#截取以空格为分隔符， 第二列到后面 -d &#34; &#34; -f 2-</span>
<span class="nv">whole_msg</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$*</span> <span class="p">|</span> cut -d <span class="s2">&#34; &#34;</span> -f 2-<span class="k">)</span>


<span class="c1"># 获取用户登录的终端</span>
<span class="nv">user_terminal</span><span class="o">=</span><span class="k">$(</span>who <span class="p">|</span> grep -i -m <span class="m">1</span> <span class="nv">$1</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>

<span class="c1"># 写入要发送的消息</span>
<span class="nb">echo</span> <span class="nv">$whole_msg</span> <span class="p">|</span> write <span class="nv">$login_user</span> <span class="nv">$user_terminal</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> !<span class="o">=</span> <span class="m">0</span> <span class="o">]</span> 
<span class="k">then</span> 
    <span class="nb">echo</span> <span class="s2">&#34;发送失败&#34;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;发送成功&#34;</span>
<span class="k">fi</span>

<span class="nb">exit</span>

</code></pre></div></div>
    <div class="post-footer">
        <div class="info">
            
            <span class="separator"><a class="tag" href="/tags/linux/">Linux</a></span>
        </div>
    </div>

    
</div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script>
<script async defer src="//latest.js"></script>
<noscript><img src="//noscript.gif" alt=""/></noscript>

</body>

</html>
