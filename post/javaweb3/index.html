<!DOCTYPE html>
<html  dir="ltr" lang="en" data-theme=""><head>
    <title> Riley Shen | java web project--learning through building 3 </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.83.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description"
        content="a full-stack web application for users to understand java web system">
    <meta name="google-site-verification" content="Nac1UrFTdr1E1F48JLe7XQhIbKn2_WtF4VnJI8KOtew" />
    

    
    
    
    <link rel="stylesheet" href="/css/main.min.a7c9793b97840076bef76d2743ee1c90b13bd21c18674076a0cccd5dd54c723b.css" integrity="sha256-p8l5O5eEAHa&#43;920nQ&#43;4ckLE70hwYZ0B2oMzNXdVMcjs="
        crossorigin="anonymous" type="text/css">
    
    
    <link rel="stylesheet" href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4=" crossorigin="anonymous" type="text/css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
        integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA=="
        crossorigin="anonymous" />

    
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">

    <link rel="canonical" href="/post/javaweb3/">

    <link rel="preconnect" href="https://fonts.gstatic.com">



    
    
    
    
    <script type="text/javascript" src="/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js"
        integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin="anonymous"></script>


    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://rileyshen.github.io/images/site-feature-image.png"/>

<meta name="twitter:title" content="java web project--learning through building 3"/>
<meta name="twitter:description" content="a full-stack web application for users to understand java web system"/>


    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,500;1,600;1,700&display=swap"
        rel="stylesheet">

</head><body><div class="sidebar animated fadeInDown ">
    <div class="logo-title">
        <div class="title">
            <img src="/images/profileS.jpg" alt="profile picture">
            <h3 title=""><a href="/">I&#39;m Riley Shen</a></h3>
            <div class="description">
                <p><br>Riley likes to push her limits <br>and always keep learning new things. <br>She shares her weekly learnings <br>because "if you can't explain it simply,<br>it means you didn't understand it well enough".<br></p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="mailto:ripple.shen31@gmail.com" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/rileyshen" rel="me" aria-label="GitHub">
                    <i class="fab fa-github fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy;  Riley Shen 2022 </div>
    </div>
</div>
<div class="main">
    <div class="page-top  animated fadeInDown ">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/post/"
                        
                   title="">Posts</a></li>
        
            
            <li><a 
                   href="/about/"
                        
                   title="">About Me</a></li>
        
            
            <li><a 
                   href="/contact/"
                        
                   title="">Contact</a></li>
        
        
        
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
<div class="post  animated fadeInDown ">
    <div class="post-content">
        
        <div class="post-title">
            <h2>java web project--learning through building 3</h2>
            
            <div class="info">
                <em class="fas fa-calendar-day"></em>
                <span class="date">
                    Tue, Jan 12, 2021
                    </span>
                <em class="fas fa-stopwatch"></em>
                <span class="reading-time">3-minute read</span>
            </div>
            
        </div>

        <p>a full-stack web application for users to understand java web system</p>
<!-- TOC -->
<ul>
<li><a href="#dispatcherservlet-%E5%BC%95%E5%85%A5" >dispatcherServlet 引入</a>
<ul>
<li><a href="#%E6%A0%B8%E5%BF%83%E6%8E%A7%E5%88%B6%E5%99%A8%E7%BB%9F%E4%B8%80%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0" >核心控制器统一获取参数</a></li>
</ul>
</li>
<li><a href="#mvc-service-%E5%92%8C-dao-%E8%AF%A6%E7%BB%86%E5%8C%BA%E5%88%86" >mvc service 和 dao 详细区分</a></li>
<li><a href="#mvc-ioc-%E8%80%A6%E5%90%88%E9%97%AE%E9%A2%98" >mvc ioc 耦合问题</a>
<ul>
<li><a href="#-%E8%80%A6%E5%90%88%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5" >&#43; 耦合/依赖注入</a></li>
<li><a href="#2-%E9%85%8D%E7%BD%AE-bean-%E5%B7%A5%E5%8E%82%E5%AE%9E%E7%8E%B0%E6%A0%B9%E6%8D%AE-id-%E8%8E%B7%E5%BE%97%E4%B8%80%E4%B8%AA%E7%B1%BB%E7%9A%84%E5%8A%9F%E8%83%BD" >&lt;strong&gt;2. 配置 bean 工厂，实现根据 id 获得一个类的功能&lt;/strong&gt;</a></li>
<li><a href="#3-%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0-bean-%E5%B7%A5%E5%8E%82" >&lt;strong&gt;3. 配置方法实现 bean 工厂&lt;/strong&gt;</a></li>
</ul>
</li>
<li><a href="#ioc---%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC--di---%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5" >IOC - 控制反转 / DI - 依赖注入</a>
<ul>
<li><a href="#%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC" >&lt;strong&gt;控制反转&lt;/strong&gt;</a></li>
<li><a href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5" >&lt;strong&gt;依赖注入&lt;/strong&gt;</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h3 id="dispatcherservlet-引入">dispatcherServlet 引入</h3>
<p><a id="markdown-dispatcherservlet-%E5%BC%95%E5%85%A5" name="dispatcherservlet-%E5%BC%95%E5%85%A5"></a></p>
<figure><img src="/images/jwb5.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<p>用 dispatcherServelet 控制 controller， 把反射放到父类</p>
<h4 id="核心控制器统一获取参数">核心控制器统一获取参数</h4>
<p><a id="markdown-%E6%A0%B8%E5%BF%83%E6%8E%A7%E5%88%B6%E5%99%A8%E7%BB%9F%E4%B8%80%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0" name="%E6%A0%B8%E5%BF%83%E6%8E%A7%E5%88%B6%E5%99%A8%E7%BB%9F%E4%B8%80%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0"></a></p>
<p><a href="https://rileyshen.github.io/post/springmvc/" >springmvc</a></p>
<figure><img src="/images/jwb6.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<h3 id="mvc-service-和-dao-详细区分">mvc service 和 dao 详细区分</h3>
<p><a id="markdown-mvc-service-%E5%92%8C-dao-%E8%AF%A6%E7%BB%86%E5%8C%BA%E5%88%86" name="mvc-service-%E5%92%8C-dao-%E8%AF%A6%E7%BB%86%E5%8C%BA%E5%88%86"></a></p>
<figure><img src="/images/jwb7.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<figure><img src="/images/jwb8.png"
         alt="image"/><figcaption>
            <h4>servlets</h4>
        </figcaption>
</figure>

<h3 id="mvc-ioc-耦合问题">mvc ioc 耦合问题</h3>
<p><a id="markdown-mvc-ioc-%E8%80%A6%E5%90%88%E9%97%AE%E9%A2%98" name="mvc-ioc-%E8%80%A6%E5%90%88%E9%97%AE%E9%A2%98"></a></p>
<h4 id="-耦合依赖注入">+ 耦合/依赖注入</h4>
<p><a id="markdown-%2B-%E8%80%A6%E5%90%88%2F%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5" name="%2B-%E8%80%A6%E5%90%88%2F%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"></a></p>
<p>在软件系统中，层与层之间是存在依赖的。我们也称之为耦合。</p>
<p>我们系统架构或者是设计的一个原则是： 高内聚低耦合。</p>
<p>层内部的组成应该是高度聚合的，而层与层之间的关系应该是低耦合的，最理想的情况 0 耦合（就是没有耦合）</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FruitController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">FruitService</span> <span class="n">fruitService</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FruitServiceImpl</span><span class="o">()</span> <span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="nf">update</span><span class="o">(</span><span class="n">Integer</span> <span class="n">fid</span> <span class="o">,</span> <span class="n">String</span> <span class="n">fname</span> <span class="o">,</span> <span class="n">Integer</span> <span class="n">price</span> <span class="o">,</span> <span class="n">Integer</span> <span class="n">fcount</span> <span class="o">,</span> <span class="n">String</span> <span class="n">remark</span> <span class="o">){</span>
    <span class="o">}</span>
</code></pre></div><ul>
<li>step 1：</li>
</ul>
<blockquote>
<p>private FruitService fruitService = null ;</p>
</blockquote>
<ul>
<li>解决空指针问题：</li>
</ul>
<p><strong>1. 配置 3 个 bean，对应 3 个组件</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;beans&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;fruitDAO&#34;</span> <span class="na">class=</span><span class="s">&#34;com.atguigu.fruit.dao.impl.FruitDAOImpl&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;fruitService&#34;</span> <span class="na">class=</span><span class="s">&#34;com.atguigu.fruit.service.impl.FruitServiceImpl&#34;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- property标签用来表示属性；name表示属性名；ref表示引用其他bean的id值--&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;fruitDAO&#34;</span> <span class="na">ref=</span><span class="s">&#34;fruitDAO&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;fruit&#34;</span> <span class="na">class=</span><span class="s">&#34;com.atguigu.fruit.controllers.FruitController&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;fruitService&#34;</span> <span class="na">ref=</span><span class="s">&#34;fruitService&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div><h4 id="2-配置-bean-工厂实现根据-id-获得一个类的功能"><strong>2. 配置 bean 工厂，实现根据 id 获得一个类的功能</strong></h4>
<p><a id="markdown-**2.-%E9%85%8D%E7%BD%AE-bean-%E5%B7%A5%E5%8E%82%EF%BC%8C%E5%AE%9E%E7%8E%B0%E6%A0%B9%E6%8D%AE-id-%E8%8E%B7%E5%BE%97%E4%B8%80%E4%B8%AA%E7%B1%BB%E7%9A%84%E5%8A%9F%E8%83%BD**" name="**2.-%E9%85%8D%E7%BD%AE-bean-%E5%B7%A5%E5%8E%82%EF%BC%8C%E5%AE%9E%E7%8E%B0%E6%A0%B9%E6%8D%AE-id-%E8%8E%B7%E5%BE%97%E4%B8%80%E4%B8%AA%E7%B1%BB%E7%9A%84%E5%8A%9F%E8%83%BD**"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BeanFactory</span> <span class="o">{</span>
    <span class="n">Object</span> <span class="nf">getBean</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><h4 id="3-配置方法实现-bean-工厂"><strong>3. 配置方法实现 bean 工厂</strong></h4>
<p><a id="markdown-**3.-%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0-bean-%E5%B7%A5%E5%8E%82**" name="**3.-%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0-bean-%E5%B7%A5%E5%8E%82**"></a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClassPathXmlApplicationContext</span> <span class="kd">implements</span> <span class="n">BeanFactory</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">beanMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">ClassPathXmlApplicationContext</span><span class="o">(){</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">getClass</span><span class="o">().</span><span class="na">getClassLoader</span><span class="o">().</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">&#34;applicationContext.xml&#34;</span><span class="o">);</span>
            <span class="c1">//1.创建DocumentBuilderFactory
</span><span class="c1"></span>            <span class="n">DocumentBuilderFactory</span> <span class="n">documentBuilderFactory</span> <span class="o">=</span> <span class="n">DocumentBuilderFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
            <span class="c1">//2.创建DocumentBuilder对象
</span><span class="c1"></span>            <span class="n">DocumentBuilder</span> <span class="n">documentBuilder</span> <span class="o">=</span> <span class="n">documentBuilderFactory</span><span class="o">.</span><span class="na">newDocumentBuilder</span><span class="o">()</span> <span class="o">;</span>
            <span class="c1">//3.创建Document对象
</span><span class="c1"></span>            <span class="n">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">documentBuilder</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>

            <span class="c1">//4.获取所有的bean节点
</span><span class="c1"></span>            <span class="n">NodeList</span> <span class="n">beanNodeList</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">getElementsByTagName</span><span class="o">(</span><span class="s">&#34;bean&#34;</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span> <span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">beanNodeList</span><span class="o">.</span><span class="na">getLength</span><span class="o">()</span> <span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
                <span class="n">Node</span> <span class="n">beanNode</span> <span class="o">=</span> <span class="n">beanNodeList</span><span class="o">.</span><span class="na">item</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="k">if</span><span class="o">(</span><span class="n">beanNode</span><span class="o">.</span><span class="na">getNodeType</span><span class="o">()</span> <span class="o">==</span> <span class="n">Node</span><span class="o">.</span><span class="na">ELEMENT_NODE</span><span class="o">){</span>
                    <span class="n">Element</span> <span class="n">beanElement</span> <span class="o">=</span> <span class="o">(</span><span class="n">Element</span><span class="o">)</span><span class="n">beanNode</span> <span class="o">;</span>
                    <span class="n">String</span> <span class="n">beanId</span> <span class="o">=</span>  <span class="n">beanElement</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">);</span>
                    <span class="n">String</span> <span class="n">className</span> <span class="o">=</span> <span class="n">beanElement</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;class&#34;</span><span class="o">);</span>
                    <span class="n">Class</span> <span class="n">beanClass</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">className</span><span class="o">);</span>
                    <span class="c1">//创建bean实例
</span><span class="c1"></span>                    <span class="n">Object</span> <span class="n">beanObj</span> <span class="o">=</span> <span class="n">beanClass</span><span class="o">.</span><span class="na">newInstance</span><span class="o">()</span> <span class="o">;</span>
                    <span class="c1">//将bean实例对象保存到map容器中
</span><span class="c1"></span>                    <span class="n">beanMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">beanId</span> <span class="o">,</span> <span class="n">beanObj</span><span class="o">)</span> <span class="o">;</span>
                    <span class="c1">//到目前为止，此处需要注意的是，bean和bean之间的依赖关系还没有设置
</span><span class="c1"></span>                <span class="o">}</span>
            <span class="o">}</span>
            <span class="c1">//5.组装bean之间的依赖关系
</span><span class="c1"></span>            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span> <span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">beanNodeList</span><span class="o">.</span><span class="na">getLength</span><span class="o">()</span> <span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
                <span class="n">Node</span> <span class="n">beanNode</span> <span class="o">=</span> <span class="n">beanNodeList</span><span class="o">.</span><span class="na">item</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="k">if</span><span class="o">(</span><span class="n">beanNode</span><span class="o">.</span><span class="na">getNodeType</span><span class="o">()</span> <span class="o">==</span> <span class="n">Node</span><span class="o">.</span><span class="na">ELEMENT_NODE</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">Element</span> <span class="n">beanElement</span> <span class="o">=</span> <span class="o">(</span><span class="n">Element</span><span class="o">)</span> <span class="n">beanNode</span><span class="o">;</span>
                    <span class="n">String</span> <span class="n">beanId</span> <span class="o">=</span> <span class="n">beanElement</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">);</span>
                    <span class="n">NodeList</span> <span class="n">beanChildNodeList</span> <span class="o">=</span> <span class="n">beanElement</span><span class="o">.</span><span class="na">getChildNodes</span><span class="o">();</span>
                    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">beanChildNodeList</span><span class="o">.</span><span class="na">getLength</span><span class="o">()</span> <span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                        <span class="n">Node</span> <span class="n">beanChildNode</span> <span class="o">=</span> <span class="n">beanChildNodeList</span><span class="o">.</span><span class="na">item</span><span class="o">(</span><span class="n">j</span><span class="o">);</span>
                        <span class="k">if</span><span class="o">(</span><span class="n">beanChildNode</span><span class="o">.</span><span class="na">getNodeType</span><span class="o">()==</span><span class="n">Node</span><span class="o">.</span><span class="na">ELEMENT_NODE</span> <span class="o">&amp;&amp;</span> <span class="s">&#34;property&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">beanChildNode</span><span class="o">.</span><span class="na">getNodeName</span><span class="o">())){</span>
                            <span class="n">Element</span> <span class="n">propertyElement</span> <span class="o">=</span> <span class="o">(</span><span class="n">Element</span><span class="o">)</span> <span class="n">beanChildNode</span><span class="o">;</span>
                            <span class="n">String</span> <span class="n">propertyName</span> <span class="o">=</span> <span class="n">propertyElement</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">);</span>
                            <span class="n">String</span> <span class="n">propertyRef</span> <span class="o">=</span> <span class="n">propertyElement</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">&#34;ref&#34;</span><span class="o">);</span>
                            <span class="c1">//1) 找到propertyRef对应的实例
</span><span class="c1"></span>                            <span class="n">Object</span> <span class="n">refObj</span> <span class="o">=</span> <span class="n">beanMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">propertyRef</span><span class="o">);</span>
                            <span class="c1">//2) 将refObj设置到当前bean对应的实例的property属性上去
</span><span class="c1"></span>                            <span class="n">Object</span> <span class="n">beanObj</span> <span class="o">=</span> <span class="n">beanMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">beanId</span><span class="o">);</span>
                            <span class="n">Class</span> <span class="n">beanClazz</span> <span class="o">=</span> <span class="n">beanObj</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
                            <span class="n">Field</span> <span class="n">propertyField</span> <span class="o">=</span> <span class="n">beanClazz</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="n">propertyName</span><span class="o">);</span>
                            <span class="n">propertyField</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
                            <span class="n">propertyField</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">beanObj</span><span class="o">,</span><span class="n">refObj</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParserConfigurationException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">SAXException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InstantiationException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchFieldException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getBean</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">beanMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><h3 id="ioc---控制反转--di---依赖注入">IOC - 控制反转 / DI - 依赖注入</h3>
<p><a id="markdown-ioc---%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC-%2F-di---%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5" name="ioc---%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC-%2F-di---%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"></a></p>
<h4 id="控制反转"><strong>控制反转</strong></h4>
<p><a id="markdown-**%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC**" name="**%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC**"></a></p>
<ul>
<li>之前在 Servlet 中，我们创建 service 对象 ， FruitService fruitService = new FruitServiceImpl(); 这句话如果出现在 servlet 中的某个方法内部，那么这个 fruitService 的作用域（生命周期）应该就是这个方法级别；<strong>(需要大量的创建销毁过程)</strong></li>
</ul>
<p>如果这句话出现在 servlet 的类中，也就是说 fruitService 是一个成员变量，那么这个 fruitService 的作用域（生命周期）应该就是这个 servlet 实例级别 <strong>(不需要大量的创建销毁过程，但生命周期扩大，有线程不安全问题)</strong></p>
<ul>
<li>之后我们在 applicationContext.xml 中定义了这个 fruitService。然后通过解析 XML，产生 fruitService 实例，存放在 beanMap 中，这个 beanMap 在一个 BeanFactory 中因此，我们转移（改变）了之前的 service 实例、dao 实例等等他们的生命周期。控制权从程序员转移到 BeanFactory。这个现象我们称之为控制反转</li>
</ul>
<h4 id="依赖注入"><strong>依赖注入</strong></h4>
<p><a id="markdown-**%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5**" name="**%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5**"></a></p>
<ul>
<li>
<p>之前我们在控制层出现代码：FruitService fruitService = new FruitServiceImpl()；那么，控制层和 service 层存在耦合。</p>
</li>
<li>
<p>之后，我们将代码修改成 FruitService fruitService = null ;
然后，在配置文件中配置:</p>
</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java">       <span class="o">&lt;</span><span class="n">bean</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;fruit&#34;</span> <span class="n">class</span><span class="o">=</span><span class="s">&#34;FruitController&#34;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">property</span> <span class="n">name</span><span class="o">=</span><span class="s">&#34;fruitService&#34;</span> <span class="n">ref</span><span class="o">=</span><span class="s">&#34;fruitService&#34;</span><span class="o">/&gt;</span>
       <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>

</code></pre></div><hr>
<p><a href="https://rileyshen.github.io/post/javaweb2/" >javaweb1</a></p>
<p><a href="https://rileyshen.github.io/post/javaweb2/" >javaweb2</a></p>
<p><a href="https://rileyshen.github.io/post/javaweb4/" >javaweb4</a></p>
<p><a href="https://rileyshen.github.io/post/javaweb5/" >javaweb5</a></p>
<p><a href="https://rileyshen.github.io/tags/spring/" >spring</a></p>
<p><a href="https://rileyshen.github.io/post/springmvc/" >springmvc</a></p></div>
    <div class="post-footer">
        <div class="info">
            
            <span class="separator"><a class="tag" href="/tags/javaee-project/">javaEE project</a><a class="tag" href="/tags/javaee-web/">javaEE web</a><a class="tag" href="/tags/three-tier-system/">Three-tier system</a><a class="tag" href="/tags/thymeleaf/">Thymeleaf</a><a class="tag" href="/tags/templateengine%2eprocess/">TemplateEngine.process</a></span>
        </div>
    </div>

    
</div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script>
<script async defer src="//latest.js"></script>
<noscript><img src="//noscript.gif" alt=""/></noscript>

</body>

</html>
